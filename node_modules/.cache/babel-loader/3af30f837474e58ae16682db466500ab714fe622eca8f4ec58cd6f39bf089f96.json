{"ast":null,"code":"import stream from 'stream';\nimport zlib from 'zlib';\nimport CryptoJS from 'crypto-js';\nimport fs from 'fs';\nimport fontkit from 'fontkit';\nimport { EventEmitter } from 'events';\nimport LineBreaker from 'linebreak';\nimport exif from 'jpeg-exif';\nimport PNG from 'png-js';\n\n/*\r\nPDFAbstractReference - abstract class for PDF reference\r\n*/\n\nclass PDFAbstractReference {\n  toString() {\n    throw new Error('Must be implemented by subclasses');\n  }\n}\n\n/*\r\nPDFTree - abstract base class for name and number tree objects\r\n*/\nclass PDFTree {\n  constructor() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    this._items = {};\n    // disable /Limits output for this tree\n    this.limits = typeof options.limits === 'boolean' ? options.limits : true;\n  }\n  add(key, val) {\n    return this._items[key] = val;\n  }\n  get(key) {\n    return this._items[key];\n  }\n  toString() {\n    // Needs to be sorted by key\n    const sortedKeys = Object.keys(this._items).sort((a, b) => this._compareKeys(a, b));\n    const out = ['<<'];\n    if (this.limits && sortedKeys.length > 1) {\n      const first = sortedKeys[0],\n        last = sortedKeys[sortedKeys.length - 1];\n      out.push(`  /Limits ${PDFObject.convert([this._dataForKey(first), this._dataForKey(last)])}`);\n    }\n    out.push(`  /${this._keysName()} [`);\n    for (let key of sortedKeys) {\n      out.push(`    ${PDFObject.convert(this._dataForKey(key))} ${PDFObject.convert(this._items[key])}`);\n    }\n    out.push(']');\n    out.push('>>');\n    return out.join('\\n');\n  }\n  _compareKeys(/*a, b*/\n  ) {\n    throw new Error('Must be implemented by subclasses');\n  }\n  _keysName() {\n    throw new Error('Must be implemented by subclasses');\n  }\n  _dataForKey(/*k*/\n  ) {\n    throw new Error('Must be implemented by subclasses');\n  }\n}\n\n/*\r\nPDFObject - converts JavaScript types into their corresponding PDF types.\r\nBy Devon Govett\r\n*/\nconst pad = (str, length) => (Array(length + 1).join('0') + str).slice(-length);\nconst escapableRe = /[\\n\\r\\t\\b\\f()\\\\]/g;\nconst escapable = {\n  '\\n': '\\\\n',\n  '\\r': '\\\\r',\n  '\\t': '\\\\t',\n  '\\b': '\\\\b',\n  '\\f': '\\\\f',\n  '\\\\': '\\\\\\\\',\n  '(': '\\\\(',\n  ')': '\\\\)'\n};\n\n// Convert little endian UTF-16 to big endian\nconst swapBytes = function (buff) {\n  const l = buff.length;\n  if (l & 0x01) {\n    throw new Error('Buffer length must be even');\n  } else {\n    for (let i = 0, end = l - 1; i < end; i += 2) {\n      const a = buff[i];\n      buff[i] = buff[i + 1];\n      buff[i + 1] = a;\n    }\n  }\n  return buff;\n};\nclass PDFObject {\n  static convert(object) {\n    let encryptFn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    // String literals are converted to the PDF name type\n    if (typeof object === 'string') {\n      return `/${object}`;\n\n      // String objects are converted to PDF strings (UTF-16)\n    } else if (object instanceof String) {\n      let string = object;\n      // Detect if this is a unicode string\n      let isUnicode = false;\n      for (let i = 0, end = string.length; i < end; i++) {\n        if (string.charCodeAt(i) > 0x7f) {\n          isUnicode = true;\n          break;\n        }\n      }\n\n      // If so, encode it as big endian UTF-16\n      let stringBuffer;\n      if (isUnicode) {\n        stringBuffer = swapBytes(Buffer.from(`\\ufeff${string}`, 'utf16le'));\n      } else {\n        stringBuffer = Buffer.from(string.valueOf(), 'ascii');\n      }\n\n      // Encrypt the string when necessary\n      if (encryptFn) {\n        string = encryptFn(stringBuffer).toString('binary');\n      } else {\n        string = stringBuffer.toString('binary');\n      }\n\n      // Escape characters as required by the spec\n      string = string.replace(escapableRe, c => escapable[c]);\n      return `(${string})`;\n\n      // Buffers are converted to PDF hex strings\n    } else if (Buffer.isBuffer(object)) {\n      return `<${object.toString('hex')}>`;\n    } else if (object instanceof PDFAbstractReference || object instanceof PDFTree) {\n      return object.toString();\n    } else if (object instanceof Date) {\n      let string = `D:${pad(object.getUTCFullYear(), 4)}` + pad(object.getUTCMonth() + 1, 2) + pad(object.getUTCDate(), 2) + pad(object.getUTCHours(), 2) + pad(object.getUTCMinutes(), 2) + pad(object.getUTCSeconds(), 2) + 'Z';\n\n      // Encrypt the string when necessary\n      if (encryptFn) {\n        string = encryptFn(Buffer.from(string, 'ascii')).toString('binary');\n\n        // Escape characters as required by the spec\n        string = string.replace(escapableRe, c => escapable[c]);\n      }\n      return `(${string})`;\n    } else if (Array.isArray(object)) {\n      const items = object.map(e => PDFObject.convert(e, encryptFn)).join(' ');\n      return `[${items}]`;\n    } else if ({}.toString.call(object) === '[object Object]') {\n      const out = ['<<'];\n      for (let key in object) {\n        const val = object[key];\n        out.push(`/${key} ${PDFObject.convert(val, encryptFn)}`);\n      }\n      out.push('>>');\n      return out.join('\\n');\n    } else if (typeof object === 'number') {\n      return PDFObject.number(object);\n    } else {\n      return `${object}`;\n    }\n  }\n  static number(n) {\n    if (n > -1e21 && n < 1e21) {\n      return Math.round(n * 1e6) / 1e6;\n    }\n    throw new Error(`unsupported number: ${n}`);\n  }\n}\n\n/*\r\nPDFReference - represents a reference to another object in the PDF object heirarchy\r\nBy Devon Govett\r\n*/\nclass PDFReference extends PDFAbstractReference {\n  constructor(document, id) {\n    let data = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    super();\n    this.document = document;\n    this.id = id;\n    this.data = data;\n    this.gen = 0;\n    this.compress = this.document.compress && !this.data.Filter;\n    this.uncompressedLength = 0;\n    this.buffer = [];\n  }\n  write(chunk) {\n    if (!Buffer.isBuffer(chunk)) {\n      chunk = Buffer.from(chunk + '\\n', 'binary');\n    }\n    this.uncompressedLength += chunk.length;\n    if (this.data.Length == null) {\n      this.data.Length = 0;\n    }\n    this.buffer.push(chunk);\n    this.data.Length += chunk.length;\n    if (this.compress) {\n      return this.data.Filter = 'FlateDecode';\n    }\n  }\n  end(chunk) {\n    if (chunk) {\n      this.write(chunk);\n    }\n    return this.finalize();\n  }\n  finalize() {\n    this.offset = this.document._offset;\n    const encryptFn = this.document._security ? this.document._security.getEncryptFn(this.id, this.gen) : null;\n    if (this.buffer.length) {\n      this.buffer = Buffer.concat(this.buffer);\n      if (this.compress) {\n        this.buffer = zlib.deflateSync(this.buffer);\n      }\n      if (encryptFn) {\n        this.buffer = encryptFn(this.buffer);\n      }\n      this.data.Length = this.buffer.length;\n    }\n    this.document._write(`${this.id} ${this.gen} obj`);\n    this.document._write(PDFObject.convert(this.data, encryptFn));\n    if (this.buffer.length) {\n      this.document._write('stream');\n      this.document._write(this.buffer);\n      this.buffer = []; // free up memory\n      this.document._write('\\nendstream');\n    }\n    this.document._write('endobj');\n    this.document._refEnd(this);\n  }\n  toString() {\n    return `${this.id} ${this.gen} R`;\n  }\n}\n\n/*\r\nPDFPage - represents a single page in the PDF document\r\nBy Devon Govett\r\n*/\n\nconst DEFAULT_MARGINS = {\n  top: 72,\n  left: 72,\n  bottom: 72,\n  right: 72\n};\nconst SIZES = {\n  '4A0': [4767.87, 6740.79],\n  '2A0': [3370.39, 4767.87],\n  A0: [2383.94, 3370.39],\n  A1: [1683.78, 2383.94],\n  A2: [1190.55, 1683.78],\n  A3: [841.89, 1190.55],\n  A4: [595.28, 841.89],\n  A5: [419.53, 595.28],\n  A6: [297.64, 419.53],\n  A7: [209.76, 297.64],\n  A8: [147.4, 209.76],\n  A9: [104.88, 147.4],\n  A10: [73.7, 104.88],\n  B0: [2834.65, 4008.19],\n  B1: [2004.09, 2834.65],\n  B2: [1417.32, 2004.09],\n  B3: [1000.63, 1417.32],\n  B4: [708.66, 1000.63],\n  B5: [498.9, 708.66],\n  B6: [354.33, 498.9],\n  B7: [249.45, 354.33],\n  B8: [175.75, 249.45],\n  B9: [124.72, 175.75],\n  B10: [87.87, 124.72],\n  C0: [2599.37, 3676.54],\n  C1: [1836.85, 2599.37],\n  C2: [1298.27, 1836.85],\n  C3: [918.43, 1298.27],\n  C4: [649.13, 918.43],\n  C5: [459.21, 649.13],\n  C6: [323.15, 459.21],\n  C7: [229.61, 323.15],\n  C8: [161.57, 229.61],\n  C9: [113.39, 161.57],\n  C10: [79.37, 113.39],\n  RA0: [2437.8, 3458.27],\n  RA1: [1729.13, 2437.8],\n  RA2: [1218.9, 1729.13],\n  RA3: [864.57, 1218.9],\n  RA4: [609.45, 864.57],\n  SRA0: [2551.18, 3628.35],\n  SRA1: [1814.17, 2551.18],\n  SRA2: [1275.59, 1814.17],\n  SRA3: [907.09, 1275.59],\n  SRA4: [637.8, 907.09],\n  EXECUTIVE: [521.86, 756.0],\n  FOLIO: [612.0, 936.0],\n  LEGAL: [612.0, 1008.0],\n  LETTER: [612.0, 792.0],\n  TABLOID: [792.0, 1224.0]\n};\nclass PDFPage {\n  constructor(document) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    this.document = document;\n    this.size = options.size || 'letter';\n    this.layout = options.layout || 'portrait';\n\n    // process margins\n    if (typeof options.margin === 'number') {\n      this.margins = {\n        top: options.margin,\n        left: options.margin,\n        bottom: options.margin,\n        right: options.margin\n      };\n\n      // default to 1 inch margins\n    } else {\n      this.margins = options.margins || DEFAULT_MARGINS;\n    }\n\n    // calculate page dimensions\n    const dimensions = Array.isArray(this.size) ? this.size : SIZES[this.size.toUpperCase()];\n    this.width = dimensions[this.layout === 'portrait' ? 0 : 1];\n    this.height = dimensions[this.layout === 'portrait' ? 1 : 0];\n    this.content = this.document.ref();\n\n    // Initialize the Font, XObject, and ExtGState dictionaries\n    this.resources = this.document.ref({\n      ProcSet: ['PDF', 'Text', 'ImageB', 'ImageC', 'ImageI']\n    });\n\n    // The page dictionary\n    this.dictionary = this.document.ref({\n      Type: 'Page',\n      Parent: this.document._root.data.Pages,\n      MediaBox: [0, 0, this.width, this.height],\n      Contents: this.content,\n      Resources: this.resources\n    });\n    this.markings = [];\n  }\n\n  // Lazily create these objects\n  get fonts() {\n    const data = this.resources.data;\n    return data.Font != null ? data.Font : data.Font = {};\n  }\n  get xobjects() {\n    const data = this.resources.data;\n    return data.XObject != null ? data.XObject : data.XObject = {};\n  }\n  get ext_gstates() {\n    const data = this.resources.data;\n    return data.ExtGState != null ? data.ExtGState : data.ExtGState = {};\n  }\n  get patterns() {\n    const data = this.resources.data;\n    return data.Pattern != null ? data.Pattern : data.Pattern = {};\n  }\n  get colorSpaces() {\n    const data = this.resources.data;\n    return data.ColorSpace || (data.ColorSpace = {});\n  }\n  get annotations() {\n    const data = this.dictionary.data;\n    return data.Annots != null ? data.Annots : data.Annots = [];\n  }\n  get structParentTreeKey() {\n    const data = this.dictionary.data;\n    return data.StructParents != null ? data.StructParents : data.StructParents = this.document.createStructParentTreeNextKey();\n  }\n  maxY() {\n    return this.height - this.margins.bottom;\n  }\n  write(chunk) {\n    return this.content.write(chunk);\n  }\n  end() {\n    this.dictionary.end();\n    this.resources.end();\n    return this.content.end();\n  }\n}\n\n/*\r\nPDFNameTree - represents a name tree object\r\n*/\nclass PDFNameTree extends PDFTree {\n  _compareKeys(a, b) {\n    return a.localeCompare(b);\n  }\n  _keysName() {\n    return \"Names\";\n  }\n  _dataForKey(k) {\n    return new String(k);\n  }\n}\n\n/**\r\n * Check if value is in a range group.\r\n * @param {number} value\r\n * @param {number[]} rangeGroup\r\n * @returns {boolean}\r\n */\nfunction inRange(value, rangeGroup) {\n  if (value < rangeGroup[0]) return false;\n  let startRange = 0;\n  let endRange = rangeGroup.length / 2;\n  while (startRange <= endRange) {\n    const middleRange = Math.floor((startRange + endRange) / 2);\n\n    // actual array index\n    const arrayIndex = middleRange * 2;\n\n    // Check if value is in range pointed by actual index\n    if (value >= rangeGroup[arrayIndex] && value <= rangeGroup[arrayIndex + 1]) {\n      return true;\n    }\n    if (value > rangeGroup[arrayIndex + 1]) {\n      // Search Right Side Of Array\n      startRange = middleRange + 1;\n    } else {\n      // Search Left Side Of Array\n      endRange = middleRange - 1;\n    }\n  }\n  return false;\n}\n\n// prettier-ignore-start\n/**\r\n * A.1 Unassigned code points in Unicode 3.2\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-A.1\r\n */\nconst unassigned_code_points = [0x0221, 0x0221, 0x0234, 0x024f, 0x02ae, 0x02af, 0x02ef, 0x02ff, 0x0350, 0x035f, 0x0370, 0x0373, 0x0376, 0x0379, 0x037b, 0x037d, 0x037f, 0x0383, 0x038b, 0x038b, 0x038d, 0x038d, 0x03a2, 0x03a2, 0x03cf, 0x03cf, 0x03f7, 0x03ff, 0x0487, 0x0487, 0x04cf, 0x04cf, 0x04f6, 0x04f7, 0x04fa, 0x04ff, 0x0510, 0x0530, 0x0557, 0x0558, 0x0560, 0x0560, 0x0588, 0x0588, 0x058b, 0x0590, 0x05a2, 0x05a2, 0x05ba, 0x05ba, 0x05c5, 0x05cf, 0x05eb, 0x05ef, 0x05f5, 0x060b, 0x060d, 0x061a, 0x061c, 0x061e, 0x0620, 0x0620, 0x063b, 0x063f, 0x0656, 0x065f, 0x06ee, 0x06ef, 0x06ff, 0x06ff, 0x070e, 0x070e, 0x072d, 0x072f, 0x074b, 0x077f, 0x07b2, 0x0900, 0x0904, 0x0904, 0x093a, 0x093b, 0x094e, 0x094f, 0x0955, 0x0957, 0x0971, 0x0980, 0x0984, 0x0984, 0x098d, 0x098e, 0x0991, 0x0992, 0x09a9, 0x09a9, 0x09b1, 0x09b1, 0x09b3, 0x09b5, 0x09ba, 0x09bb, 0x09bd, 0x09bd, 0x09c5, 0x09c6, 0x09c9, 0x09ca, 0x09ce, 0x09d6, 0x09d8, 0x09db, 0x09de, 0x09de, 0x09e4, 0x09e5, 0x09fb, 0x0a01, 0x0a03, 0x0a04, 0x0a0b, 0x0a0e, 0x0a11, 0x0a12, 0x0a29, 0x0a29, 0x0a31, 0x0a31, 0x0a34, 0x0a34, 0x0a37, 0x0a37, 0x0a3a, 0x0a3b, 0x0a3d, 0x0a3d, 0x0a43, 0x0a46, 0x0a49, 0x0a4a, 0x0a4e, 0x0a58, 0x0a5d, 0x0a5d, 0x0a5f, 0x0a65, 0x0a75, 0x0a80, 0x0a84, 0x0a84, 0x0a8c, 0x0a8c, 0x0a8e, 0x0a8e, 0x0a92, 0x0a92, 0x0aa9, 0x0aa9, 0x0ab1, 0x0ab1, 0x0ab4, 0x0ab4, 0x0aba, 0x0abb, 0x0ac6, 0x0ac6, 0x0aca, 0x0aca, 0x0ace, 0x0acf, 0x0ad1, 0x0adf, 0x0ae1, 0x0ae5, 0x0af0, 0x0b00, 0x0b04, 0x0b04, 0x0b0d, 0x0b0e, 0x0b11, 0x0b12, 0x0b29, 0x0b29, 0x0b31, 0x0b31, 0x0b34, 0x0b35, 0x0b3a, 0x0b3b, 0x0b44, 0x0b46, 0x0b49, 0x0b4a, 0x0b4e, 0x0b55, 0x0b58, 0x0b5b, 0x0b5e, 0x0b5e, 0x0b62, 0x0b65, 0x0b71, 0x0b81, 0x0b84, 0x0b84, 0x0b8b, 0x0b8d, 0x0b91, 0x0b91, 0x0b96, 0x0b98, 0x0b9b, 0x0b9b, 0x0b9d, 0x0b9d, 0x0ba0, 0x0ba2, 0x0ba5, 0x0ba7, 0x0bab, 0x0bad, 0x0bb6, 0x0bb6, 0x0bba, 0x0bbd, 0x0bc3, 0x0bc5, 0x0bc9, 0x0bc9, 0x0bce, 0x0bd6, 0x0bd8, 0x0be6, 0x0bf3, 0x0c00, 0x0c04, 0x0c04, 0x0c0d, 0x0c0d, 0x0c11, 0x0c11, 0x0c29, 0x0c29, 0x0c34, 0x0c34, 0x0c3a, 0x0c3d, 0x0c45, 0x0c45, 0x0c49, 0x0c49, 0x0c4e, 0x0c54, 0x0c57, 0x0c5f, 0x0c62, 0x0c65, 0x0c70, 0x0c81, 0x0c84, 0x0c84, 0x0c8d, 0x0c8d, 0x0c91, 0x0c91, 0x0ca9, 0x0ca9, 0x0cb4, 0x0cb4, 0x0cba, 0x0cbd, 0x0cc5, 0x0cc5, 0x0cc9, 0x0cc9, 0x0cce, 0x0cd4, 0x0cd7, 0x0cdd, 0x0cdf, 0x0cdf, 0x0ce2, 0x0ce5, 0x0cf0, 0x0d01, 0x0d04, 0x0d04, 0x0d0d, 0x0d0d, 0x0d11, 0x0d11, 0x0d29, 0x0d29, 0x0d3a, 0x0d3d, 0x0d44, 0x0d45, 0x0d49, 0x0d49, 0x0d4e, 0x0d56, 0x0d58, 0x0d5f, 0x0d62, 0x0d65, 0x0d70, 0x0d81, 0x0d84, 0x0d84, 0x0d97, 0x0d99, 0x0db2, 0x0db2, 0x0dbc, 0x0dbc, 0x0dbe, 0x0dbf, 0x0dc7, 0x0dc9, 0x0dcb, 0x0dce, 0x0dd5, 0x0dd5, 0x0dd7, 0x0dd7, 0x0de0, 0x0df1, 0x0df5, 0x0e00, 0x0e3b, 0x0e3e, 0x0e5c, 0x0e80, 0x0e83, 0x0e83, 0x0e85, 0x0e86, 0x0e89, 0x0e89, 0x0e8b, 0x0e8c, 0x0e8e, 0x0e93, 0x0e98, 0x0e98, 0x0ea0, 0x0ea0, 0x0ea4, 0x0ea4, 0x0ea6, 0x0ea6, 0x0ea8, 0x0ea9, 0x0eac, 0x0eac, 0x0eba, 0x0eba, 0x0ebe, 0x0ebf, 0x0ec5, 0x0ec5, 0x0ec7, 0x0ec7, 0x0ece, 0x0ecf, 0x0eda, 0x0edb, 0x0ede, 0x0eff, 0x0f48, 0x0f48, 0x0f6b, 0x0f70, 0x0f8c, 0x0f8f, 0x0f98, 0x0f98, 0x0fbd, 0x0fbd, 0x0fcd, 0x0fce, 0x0fd0, 0x0fff, 0x1022, 0x1022, 0x1028, 0x1028, 0x102b, 0x102b, 0x1033, 0x1035, 0x103a, 0x103f, 0x105a, 0x109f, 0x10c6, 0x10cf, 0x10f9, 0x10fa, 0x10fc, 0x10ff, 0x115a, 0x115e, 0x11a3, 0x11a7, 0x11fa, 0x11ff, 0x1207, 0x1207, 0x1247, 0x1247, 0x1249, 0x1249, 0x124e, 0x124f, 0x1257, 0x1257, 0x1259, 0x1259, 0x125e, 0x125f, 0x1287, 0x1287, 0x1289, 0x1289, 0x128e, 0x128f, 0x12af, 0x12af, 0x12b1, 0x12b1, 0x12b6, 0x12b7, 0x12bf, 0x12bf, 0x12c1, 0x12c1, 0x12c6, 0x12c7, 0x12cf, 0x12cf, 0x12d7, 0x12d7, 0x12ef, 0x12ef, 0x130f, 0x130f, 0x1311, 0x1311, 0x1316, 0x1317, 0x131f, 0x131f, 0x1347, 0x1347, 0x135b, 0x1360, 0x137d, 0x139f, 0x13f5, 0x1400, 0x1677, 0x167f, 0x169d, 0x169f, 0x16f1, 0x16ff, 0x170d, 0x170d, 0x1715, 0x171f, 0x1737, 0x173f, 0x1754, 0x175f, 0x176d, 0x176d, 0x1771, 0x1771, 0x1774, 0x177f, 0x17dd, 0x17df, 0x17ea, 0x17ff, 0x180f, 0x180f, 0x181a, 0x181f, 0x1878, 0x187f, 0x18aa, 0x1dff, 0x1e9c, 0x1e9f, 0x1efa, 0x1eff, 0x1f16, 0x1f17, 0x1f1e, 0x1f1f, 0x1f46, 0x1f47, 0x1f4e, 0x1f4f, 0x1f58, 0x1f58, 0x1f5a, 0x1f5a, 0x1f5c, 0x1f5c, 0x1f5e, 0x1f5e, 0x1f7e, 0x1f7f, 0x1fb5, 0x1fb5, 0x1fc5, 0x1fc5, 0x1fd4, 0x1fd5, 0x1fdc, 0x1fdc, 0x1ff0, 0x1ff1, 0x1ff5, 0x1ff5, 0x1fff, 0x1fff, 0x2053, 0x2056, 0x2058, 0x205e, 0x2064, 0x2069, 0x2072, 0x2073, 0x208f, 0x209f, 0x20b2, 0x20cf, 0x20eb, 0x20ff, 0x213b, 0x213c, 0x214c, 0x2152, 0x2184, 0x218f, 0x23cf, 0x23ff, 0x2427, 0x243f, 0x244b, 0x245f, 0x24ff, 0x24ff, 0x2614, 0x2615, 0x2618, 0x2618, 0x267e, 0x267f, 0x268a, 0x2700, 0x2705, 0x2705, 0x270a, 0x270b, 0x2728, 0x2728, 0x274c, 0x274c, 0x274e, 0x274e, 0x2753, 0x2755, 0x2757, 0x2757, 0x275f, 0x2760, 0x2795, 0x2797, 0x27b0, 0x27b0, 0x27bf, 0x27cf, 0x27ec, 0x27ef, 0x2b00, 0x2e7f, 0x2e9a, 0x2e9a, 0x2ef4, 0x2eff, 0x2fd6, 0x2fef, 0x2ffc, 0x2fff, 0x3040, 0x3040, 0x3097, 0x3098, 0x3100, 0x3104, 0x312d, 0x3130, 0x318f, 0x318f, 0x31b8, 0x31ef, 0x321d, 0x321f, 0x3244, 0x3250, 0x327c, 0x327e, 0x32cc, 0x32cf, 0x32ff, 0x32ff, 0x3377, 0x337a, 0x33de, 0x33df, 0x33ff, 0x33ff, 0x4db6, 0x4dff, 0x9fa6, 0x9fff, 0xa48d, 0xa48f, 0xa4c7, 0xabff, 0xd7a4, 0xd7ff, 0xfa2e, 0xfa2f, 0xfa6b, 0xfaff, 0xfb07, 0xfb12, 0xfb18, 0xfb1c, 0xfb37, 0xfb37, 0xfb3d, 0xfb3d, 0xfb3f, 0xfb3f, 0xfb42, 0xfb42, 0xfb45, 0xfb45, 0xfbb2, 0xfbd2, 0xfd40, 0xfd4f, 0xfd90, 0xfd91, 0xfdc8, 0xfdcf, 0xfdfd, 0xfdff, 0xfe10, 0xfe1f, 0xfe24, 0xfe2f, 0xfe47, 0xfe48, 0xfe53, 0xfe53, 0xfe67, 0xfe67, 0xfe6c, 0xfe6f, 0xfe75, 0xfe75, 0xfefd, 0xfefe, 0xff00, 0xff00, 0xffbf, 0xffc1, 0xffc8, 0xffc9, 0xffd0, 0xffd1, 0xffd8, 0xffd9, 0xffdd, 0xffdf, 0xffe7, 0xffe7, 0xffef, 0xfff8, 0x10000, 0x102ff, 0x1031f, 0x1031f, 0x10324, 0x1032f, 0x1034b, 0x103ff, 0x10426, 0x10427, 0x1044e, 0x1cfff, 0x1d0f6, 0x1d0ff, 0x1d127, 0x1d129, 0x1d1de, 0x1d3ff, 0x1d455, 0x1d455, 0x1d49d, 0x1d49d, 0x1d4a0, 0x1d4a1, 0x1d4a3, 0x1d4a4, 0x1d4a7, 0x1d4a8, 0x1d4ad, 0x1d4ad, 0x1d4ba, 0x1d4ba, 0x1d4bc, 0x1d4bc, 0x1d4c1, 0x1d4c1, 0x1d4c4, 0x1d4c4, 0x1d506, 0x1d506, 0x1d50b, 0x1d50c, 0x1d515, 0x1d515, 0x1d51d, 0x1d51d, 0x1d53a, 0x1d53a, 0x1d53f, 0x1d53f, 0x1d545, 0x1d545, 0x1d547, 0x1d549, 0x1d551, 0x1d551, 0x1d6a4, 0x1d6a7, 0x1d7ca, 0x1d7cd, 0x1d800, 0x1fffd, 0x2a6d7, 0x2f7ff, 0x2fa1e, 0x2fffd, 0x30000, 0x3fffd, 0x40000, 0x4fffd, 0x50000, 0x5fffd, 0x60000, 0x6fffd, 0x70000, 0x7fffd, 0x80000, 0x8fffd, 0x90000, 0x9fffd, 0xa0000, 0xafffd, 0xb0000, 0xbfffd, 0xc0000, 0xcfffd, 0xd0000, 0xdfffd, 0xe0000, 0xe0000, 0xe0002, 0xe001f, 0xe0080, 0xefffd];\n// prettier-ignore-end\n\nconst isUnassignedCodePoint = character => inRange(character, unassigned_code_points);\n\n// prettier-ignore-start\n/**\r\n * B.1 Commonly mapped to nothing\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-B.1\r\n */\nconst commonly_mapped_to_nothing = [0x00ad, 0x00ad, 0x034f, 0x034f, 0x1806, 0x1806, 0x180b, 0x180b, 0x180c, 0x180c, 0x180d, 0x180d, 0x200b, 0x200b, 0x200c, 0x200c, 0x200d, 0x200d, 0x2060, 0x2060, 0xfe00, 0xfe00, 0xfe01, 0xfe01, 0xfe02, 0xfe02, 0xfe03, 0xfe03, 0xfe04, 0xfe04, 0xfe05, 0xfe05, 0xfe06, 0xfe06, 0xfe07, 0xfe07, 0xfe08, 0xfe08, 0xfe09, 0xfe09, 0xfe0a, 0xfe0a, 0xfe0b, 0xfe0b, 0xfe0c, 0xfe0c, 0xfe0d, 0xfe0d, 0xfe0e, 0xfe0e, 0xfe0f, 0xfe0f, 0xfeff, 0xfeff];\n// prettier-ignore-end\n\nconst isCommonlyMappedToNothing = character => inRange(character, commonly_mapped_to_nothing);\n\n// prettier-ignore-start\n/**\r\n * C.1.2 Non-ASCII space characters\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-C.1.2\r\n */\nconst non_ASCII_space_characters = [0x00a0, 0x00a0 /* NO-BREAK SPACE */, 0x1680, 0x1680 /* OGHAM SPACE MARK */, 0x2000, 0x2000 /* EN QUAD */, 0x2001, 0x2001 /* EM QUAD */, 0x2002, 0x2002 /* EN SPACE */, 0x2003, 0x2003 /* EM SPACE */, 0x2004, 0x2004 /* THREE-PER-EM SPACE */, 0x2005, 0x2005 /* FOUR-PER-EM SPACE */, 0x2006, 0x2006 /* SIX-PER-EM SPACE */, 0x2007, 0x2007 /* FIGURE SPACE */, 0x2008, 0x2008 /* PUNCTUATION SPACE */, 0x2009, 0x2009 /* THIN SPACE */, 0x200a, 0x200a /* HAIR SPACE */, 0x200b, 0x200b /* ZERO WIDTH SPACE */, 0x202f, 0x202f /* NARROW NO-BREAK SPACE */, 0x205f, 0x205f /* MEDIUM MATHEMATICAL SPACE */, 0x3000, 0x3000 /* IDEOGRAPHIC SPACE */];\n// prettier-ignore-end\n\nconst isNonASCIISpaceCharacter = character => inRange(character, non_ASCII_space_characters);\n\n// prettier-ignore-start\nconst non_ASCII_controls_characters = [\n/**\r\n * C.2.2 Non-ASCII control characters\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-C.2.2\r\n */\n0x0080, 0x009f /* [CONTROL CHARACTERS] */, 0x06dd, 0x06dd /* ARABIC END OF AYAH */, 0x070f, 0x070f /* SYRIAC ABBREVIATION MARK */, 0x180e, 0x180e /* MONGOLIAN VOWEL SEPARATOR */, 0x200c, 0x200c /* ZERO WIDTH NON-JOINER */, 0x200d, 0x200d /* ZERO WIDTH JOINER */, 0x2028, 0x2028 /* LINE SEPARATOR */, 0x2029, 0x2029 /* PARAGRAPH SEPARATOR */, 0x2060, 0x2060 /* WORD JOINER */, 0x2061, 0x2061 /* FUNCTION APPLICATION */, 0x2062, 0x2062 /* INVISIBLE TIMES */, 0x2063, 0x2063 /* INVISIBLE SEPARATOR */, 0x206a, 0x206f /* [CONTROL CHARACTERS] */, 0xfeff, 0xfeff /* ZERO WIDTH NO-BREAK SPACE */, 0xfff9, 0xfffc /* [CONTROL CHARACTERS] */, 0x1d173, 0x1d17a /* [MUSICAL CONTROL CHARACTERS] */];\nconst non_character_codepoints = [\n/**\r\n * C.4 Non-character code points\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-C.4\r\n */\n0xfdd0, 0xfdef /* [NONCHARACTER CODE POINTS] */, 0xfffe, 0xffff /* [NONCHARACTER CODE POINTS] */, 0x1fffe, 0x1ffff /* [NONCHARACTER CODE POINTS] */, 0x2fffe, 0x2ffff /* [NONCHARACTER CODE POINTS] */, 0x3fffe, 0x3ffff /* [NONCHARACTER CODE POINTS] */, 0x4fffe, 0x4ffff /* [NONCHARACTER CODE POINTS] */, 0x5fffe, 0x5ffff /* [NONCHARACTER CODE POINTS] */, 0x6fffe, 0x6ffff /* [NONCHARACTER CODE POINTS] */, 0x7fffe, 0x7ffff /* [NONCHARACTER CODE POINTS] */, 0x8fffe, 0x8ffff /* [NONCHARACTER CODE POINTS] */, 0x9fffe, 0x9ffff /* [NONCHARACTER CODE POINTS] */, 0xafffe, 0xaffff /* [NONCHARACTER CODE POINTS] */, 0xbfffe, 0xbffff /* [NONCHARACTER CODE POINTS] */, 0xcfffe, 0xcffff /* [NONCHARACTER CODE POINTS] */, 0xdfffe, 0xdffff /* [NONCHARACTER CODE POINTS] */, 0xefffe, 0xeffff /* [NONCHARACTER CODE POINTS] */, 0x10fffe, 0x10ffff /* [NONCHARACTER CODE POINTS] */];\n\n/**\r\n * 2.3.  Prohibited Output\r\n */\nconst prohibited_characters = [\n/**\r\n * C.2.1 ASCII control characters\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-C.2.1\r\n */\n0, 0x001f /* [CONTROL CHARACTERS] */, 0x007f, 0x007f /* DELETE */,\n/**\r\n * C.8 Change display properties or are deprecated\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-C.8\r\n */\n0x0340, 0x0340 /* COMBINING GRAVE TONE MARK */, 0x0341, 0x0341 /* COMBINING ACUTE TONE MARK */, 0x200e, 0x200e /* LEFT-TO-RIGHT MARK */, 0x200f, 0x200f /* RIGHT-TO-LEFT MARK */, 0x202a, 0x202a /* LEFT-TO-RIGHT EMBEDDING */, 0x202b, 0x202b /* RIGHT-TO-LEFT EMBEDDING */, 0x202c, 0x202c /* POP DIRECTIONAL FORMATTING */, 0x202d, 0x202d /* LEFT-TO-RIGHT OVERRIDE */, 0x202e, 0x202e /* RIGHT-TO-LEFT OVERRIDE */, 0x206a, 0x206a /* INHIBIT SYMMETRIC SWAPPING */, 0x206b, 0x206b /* ACTIVATE SYMMETRIC SWAPPING */, 0x206c, 0x206c /* INHIBIT ARABIC FORM SHAPING */, 0x206d, 0x206d /* ACTIVATE ARABIC FORM SHAPING */, 0x206e, 0x206e /* NATIONAL DIGIT SHAPES */, 0x206f, 0x206f /* NOMINAL DIGIT SHAPES */,\n/**\r\n * C.7 Inappropriate for canonical representation\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-C.7\r\n */\n0x2ff0, 0x2ffb /* [IDEOGRAPHIC DESCRIPTION CHARACTERS] */,\n/**\r\n * C.5 Surrogate codes\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-C.5\r\n */\n0xd800, 0xdfff,\n/**\r\n * C.3 Private use\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-C.3\r\n */\n0xe000, 0xf8ff /* [PRIVATE USE, PLANE 0] */,\n/**\r\n * C.6 Inappropriate for plain text\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-C.6\r\n */\n0xfff9, 0xfff9 /* INTERLINEAR ANNOTATION ANCHOR */, 0xfffa, 0xfffa /* INTERLINEAR ANNOTATION SEPARATOR */, 0xfffb, 0xfffb /* INTERLINEAR ANNOTATION TERMINATOR */, 0xfffc, 0xfffc /* OBJECT REPLACEMENT CHARACTER */, 0xfffd, 0xfffd /* REPLACEMENT CHARACTER */,\n/**\r\n * C.9 Tagging characters\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-C.9\r\n */\n0xe0001, 0xe0001 /* LANGUAGE TAG */, 0xe0020, 0xe007f /* [TAGGING CHARACTERS] */,\n/**\r\n * C.3 Private use\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-C.3\r\n */\n\n0xf0000, 0xffffd /* [PRIVATE USE, PLANE 15] */, 0x100000, 0x10fffd /* [PRIVATE USE, PLANE 16] */];\n// prettier-ignore-end\n\nconst isProhibitedCharacter = character => inRange(character, non_ASCII_space_characters) || inRange(character, prohibited_characters) || inRange(character, non_ASCII_controls_characters) || inRange(character, non_character_codepoints);\n\n// prettier-ignore-start\n/**\r\n * D.1 Characters with bidirectional property \"R\" or \"AL\"\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-D.1\r\n */\nconst bidirectional_r_al = [0x05be, 0x05be, 0x05c0, 0x05c0, 0x05c3, 0x05c3, 0x05d0, 0x05ea, 0x05f0, 0x05f4, 0x061b, 0x061b, 0x061f, 0x061f, 0x0621, 0x063a, 0x0640, 0x064a, 0x066d, 0x066f, 0x0671, 0x06d5, 0x06dd, 0x06dd, 0x06e5, 0x06e6, 0x06fa, 0x06fe, 0x0700, 0x070d, 0x0710, 0x0710, 0x0712, 0x072c, 0x0780, 0x07a5, 0x07b1, 0x07b1, 0x200f, 0x200f, 0xfb1d, 0xfb1d, 0xfb1f, 0xfb28, 0xfb2a, 0xfb36, 0xfb38, 0xfb3c, 0xfb3e, 0xfb3e, 0xfb40, 0xfb41, 0xfb43, 0xfb44, 0xfb46, 0xfbb1, 0xfbd3, 0xfd3d, 0xfd50, 0xfd8f, 0xfd92, 0xfdc7, 0xfdf0, 0xfdfc, 0xfe70, 0xfe74, 0xfe76, 0xfefc];\n// prettier-ignore-end\n\nconst isBidirectionalRAL = character => inRange(character, bidirectional_r_al);\n\n// prettier-ignore-start\n/**\r\n * D.2 Characters with bidirectional property \"L\"\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-D.2\r\n */\nconst bidirectional_l = [0x0041, 0x005a, 0x0061, 0x007a, 0x00aa, 0x00aa, 0x00b5, 0x00b5, 0x00ba, 0x00ba, 0x00c0, 0x00d6, 0x00d8, 0x00f6, 0x00f8, 0x0220, 0x0222, 0x0233, 0x0250, 0x02ad, 0x02b0, 0x02b8, 0x02bb, 0x02c1, 0x02d0, 0x02d1, 0x02e0, 0x02e4, 0x02ee, 0x02ee, 0x037a, 0x037a, 0x0386, 0x0386, 0x0388, 0x038a, 0x038c, 0x038c, 0x038e, 0x03a1, 0x03a3, 0x03ce, 0x03d0, 0x03f5, 0x0400, 0x0482, 0x048a, 0x04ce, 0x04d0, 0x04f5, 0x04f8, 0x04f9, 0x0500, 0x050f, 0x0531, 0x0556, 0x0559, 0x055f, 0x0561, 0x0587, 0x0589, 0x0589, 0x0903, 0x0903, 0x0905, 0x0939, 0x093d, 0x0940, 0x0949, 0x094c, 0x0950, 0x0950, 0x0958, 0x0961, 0x0964, 0x0970, 0x0982, 0x0983, 0x0985, 0x098c, 0x098f, 0x0990, 0x0993, 0x09a8, 0x09aa, 0x09b0, 0x09b2, 0x09b2, 0x09b6, 0x09b9, 0x09be, 0x09c0, 0x09c7, 0x09c8, 0x09cb, 0x09cc, 0x09d7, 0x09d7, 0x09dc, 0x09dd, 0x09df, 0x09e1, 0x09e6, 0x09f1, 0x09f4, 0x09fa, 0x0a05, 0x0a0a, 0x0a0f, 0x0a10, 0x0a13, 0x0a28, 0x0a2a, 0x0a30, 0x0a32, 0x0a33, 0x0a35, 0x0a36, 0x0a38, 0x0a39, 0x0a3e, 0x0a40, 0x0a59, 0x0a5c, 0x0a5e, 0x0a5e, 0x0a66, 0x0a6f, 0x0a72, 0x0a74, 0x0a83, 0x0a83, 0x0a85, 0x0a8b, 0x0a8d, 0x0a8d, 0x0a8f, 0x0a91, 0x0a93, 0x0aa8, 0x0aaa, 0x0ab0, 0x0ab2, 0x0ab3, 0x0ab5, 0x0ab9, 0x0abd, 0x0ac0, 0x0ac9, 0x0ac9, 0x0acb, 0x0acc, 0x0ad0, 0x0ad0, 0x0ae0, 0x0ae0, 0x0ae6, 0x0aef, 0x0b02, 0x0b03, 0x0b05, 0x0b0c, 0x0b0f, 0x0b10, 0x0b13, 0x0b28, 0x0b2a, 0x0b30, 0x0b32, 0x0b33, 0x0b36, 0x0b39, 0x0b3d, 0x0b3e, 0x0b40, 0x0b40, 0x0b47, 0x0b48, 0x0b4b, 0x0b4c, 0x0b57, 0x0b57, 0x0b5c, 0x0b5d, 0x0b5f, 0x0b61, 0x0b66, 0x0b70, 0x0b83, 0x0b83, 0x0b85, 0x0b8a, 0x0b8e, 0x0b90, 0x0b92, 0x0b95, 0x0b99, 0x0b9a, 0x0b9c, 0x0b9c, 0x0b9e, 0x0b9f, 0x0ba3, 0x0ba4, 0x0ba8, 0x0baa, 0x0bae, 0x0bb5, 0x0bb7, 0x0bb9, 0x0bbe, 0x0bbf, 0x0bc1, 0x0bc2, 0x0bc6, 0x0bc8, 0x0bca, 0x0bcc, 0x0bd7, 0x0bd7, 0x0be7, 0x0bf2, 0x0c01, 0x0c03, 0x0c05, 0x0c0c, 0x0c0e, 0x0c10, 0x0c12, 0x0c28, 0x0c2a, 0x0c33, 0x0c35, 0x0c39, 0x0c41, 0x0c44, 0x0c60, 0x0c61, 0x0c66, 0x0c6f, 0x0c82, 0x0c83, 0x0c85, 0x0c8c, 0x0c8e, 0x0c90, 0x0c92, 0x0ca8, 0x0caa, 0x0cb3, 0x0cb5, 0x0cb9, 0x0cbe, 0x0cbe, 0x0cc0, 0x0cc4, 0x0cc7, 0x0cc8, 0x0cca, 0x0ccb, 0x0cd5, 0x0cd6, 0x0cde, 0x0cde, 0x0ce0, 0x0ce1, 0x0ce6, 0x0cef, 0x0d02, 0x0d03, 0x0d05, 0x0d0c, 0x0d0e, 0x0d10, 0x0d12, 0x0d28, 0x0d2a, 0x0d39, 0x0d3e, 0x0d40, 0x0d46, 0x0d48, 0x0d4a, 0x0d4c, 0x0d57, 0x0d57, 0x0d60, 0x0d61, 0x0d66, 0x0d6f, 0x0d82, 0x0d83, 0x0d85, 0x0d96, 0x0d9a, 0x0db1, 0x0db3, 0x0dbb, 0x0dbd, 0x0dbd, 0x0dc0, 0x0dc6, 0x0dcf, 0x0dd1, 0x0dd8, 0x0ddf, 0x0df2, 0x0df4, 0x0e01, 0x0e30, 0x0e32, 0x0e33, 0x0e40, 0x0e46, 0x0e4f, 0x0e5b, 0x0e81, 0x0e82, 0x0e84, 0x0e84, 0x0e87, 0x0e88, 0x0e8a, 0x0e8a, 0x0e8d, 0x0e8d, 0x0e94, 0x0e97, 0x0e99, 0x0e9f, 0x0ea1, 0x0ea3, 0x0ea5, 0x0ea5, 0x0ea7, 0x0ea7, 0x0eaa, 0x0eab, 0x0ead, 0x0eb0, 0x0eb2, 0x0eb3, 0x0ebd, 0x0ebd, 0x0ec0, 0x0ec4, 0x0ec6, 0x0ec6, 0x0ed0, 0x0ed9, 0x0edc, 0x0edd, 0x0f00, 0x0f17, 0x0f1a, 0x0f34, 0x0f36, 0x0f36, 0x0f38, 0x0f38, 0x0f3e, 0x0f47, 0x0f49, 0x0f6a, 0x0f7f, 0x0f7f, 0x0f85, 0x0f85, 0x0f88, 0x0f8b, 0x0fbe, 0x0fc5, 0x0fc7, 0x0fcc, 0x0fcf, 0x0fcf, 0x1000, 0x1021, 0x1023, 0x1027, 0x1029, 0x102a, 0x102c, 0x102c, 0x1031, 0x1031, 0x1038, 0x1038, 0x1040, 0x1057, 0x10a0, 0x10c5, 0x10d0, 0x10f8, 0x10fb, 0x10fb, 0x1100, 0x1159, 0x115f, 0x11a2, 0x11a8, 0x11f9, 0x1200, 0x1206, 0x1208, 0x1246, 0x1248, 0x1248, 0x124a, 0x124d, 0x1250, 0x1256, 0x1258, 0x1258, 0x125a, 0x125d, 0x1260, 0x1286, 0x1288, 0x1288, 0x128a, 0x128d, 0x1290, 0x12ae, 0x12b0, 0x12b0, 0x12b2, 0x12b5, 0x12b8, 0x12be, 0x12c0, 0x12c0, 0x12c2, 0x12c5, 0x12c8, 0x12ce, 0x12d0, 0x12d6, 0x12d8, 0x12ee, 0x12f0, 0x130e, 0x1310, 0x1310, 0x1312, 0x1315, 0x1318, 0x131e, 0x1320, 0x1346, 0x1348, 0x135a, 0x1361, 0x137c, 0x13a0, 0x13f4, 0x1401, 0x1676, 0x1681, 0x169a, 0x16a0, 0x16f0, 0x1700, 0x170c, 0x170e, 0x1711, 0x1720, 0x1731, 0x1735, 0x1736, 0x1740, 0x1751, 0x1760, 0x176c, 0x176e, 0x1770, 0x1780, 0x17b6, 0x17be, 0x17c5, 0x17c7, 0x17c8, 0x17d4, 0x17da, 0x17dc, 0x17dc, 0x17e0, 0x17e9, 0x1810, 0x1819, 0x1820, 0x1877, 0x1880, 0x18a8, 0x1e00, 0x1e9b, 0x1ea0, 0x1ef9, 0x1f00, 0x1f15, 0x1f18, 0x1f1d, 0x1f20, 0x1f45, 0x1f48, 0x1f4d, 0x1f50, 0x1f57, 0x1f59, 0x1f59, 0x1f5b, 0x1f5b, 0x1f5d, 0x1f5d, 0x1f5f, 0x1f7d, 0x1f80, 0x1fb4, 0x1fb6, 0x1fbc, 0x1fbe, 0x1fbe, 0x1fc2, 0x1fc4, 0x1fc6, 0x1fcc, 0x1fd0, 0x1fd3, 0x1fd6, 0x1fdb, 0x1fe0, 0x1fec, 0x1ff2, 0x1ff4, 0x1ff6, 0x1ffc, 0x200e, 0x200e, 0x2071, 0x2071, 0x207f, 0x207f, 0x2102, 0x2102, 0x2107, 0x2107, 0x210a, 0x2113, 0x2115, 0x2115, 0x2119, 0x211d, 0x2124, 0x2124, 0x2126, 0x2126, 0x2128, 0x2128, 0x212a, 0x212d, 0x212f, 0x2131, 0x2133, 0x2139, 0x213d, 0x213f, 0x2145, 0x2149, 0x2160, 0x2183, 0x2336, 0x237a, 0x2395, 0x2395, 0x249c, 0x24e9, 0x3005, 0x3007, 0x3021, 0x3029, 0x3031, 0x3035, 0x3038, 0x303c, 0x3041, 0x3096, 0x309d, 0x309f, 0x30a1, 0x30fa, 0x30fc, 0x30ff, 0x3105, 0x312c, 0x3131, 0x318e, 0x3190, 0x31b7, 0x31f0, 0x321c, 0x3220, 0x3243, 0x3260, 0x327b, 0x327f, 0x32b0, 0x32c0, 0x32cb, 0x32d0, 0x32fe, 0x3300, 0x3376, 0x337b, 0x33dd, 0x33e0, 0x33fe, 0x3400, 0x4db5, 0x4e00, 0x9fa5, 0xa000, 0xa48c, 0xac00, 0xd7a3, 0xd800, 0xfa2d, 0xfa30, 0xfa6a, 0xfb00, 0xfb06, 0xfb13, 0xfb17, 0xff21, 0xff3a, 0xff41, 0xff5a, 0xff66, 0xffbe, 0xffc2, 0xffc7, 0xffca, 0xffcf, 0xffd2, 0xffd7, 0xffda, 0xffdc, 0x10300, 0x1031e, 0x10320, 0x10323, 0x10330, 0x1034a, 0x10400, 0x10425, 0x10428, 0x1044d, 0x1d000, 0x1d0f5, 0x1d100, 0x1d126, 0x1d12a, 0x1d166, 0x1d16a, 0x1d172, 0x1d183, 0x1d184, 0x1d18c, 0x1d1a9, 0x1d1ae, 0x1d1dd, 0x1d400, 0x1d454, 0x1d456, 0x1d49c, 0x1d49e, 0x1d49f, 0x1d4a2, 0x1d4a2, 0x1d4a5, 0x1d4a6, 0x1d4a9, 0x1d4ac, 0x1d4ae, 0x1d4b9, 0x1d4bb, 0x1d4bb, 0x1d4bd, 0x1d4c0, 0x1d4c2, 0x1d4c3, 0x1d4c5, 0x1d505, 0x1d507, 0x1d50a, 0x1d50d, 0x1d514, 0x1d516, 0x1d51c, 0x1d51e, 0x1d539, 0x1d53b, 0x1d53e, 0x1d540, 0x1d544, 0x1d546, 0x1d546, 0x1d54a, 0x1d550, 0x1d552, 0x1d6a3, 0x1d6a8, 0x1d7c9, 0x20000, 0x2a6d6, 0x2f800, 0x2fa1d, 0xf0000, 0xffffd, 0x100000, 0x10fffd];\n// prettier-ignore-end\n\nconst isBidirectionalL = character => inRange(character, bidirectional_l);\n\n// 2.1.  Mapping\n\n/**\r\n * non-ASCII space characters [StringPrep, C.1.2] that can be\r\n * mapped to SPACE (U+0020)\r\n */\nconst mapping2space = isNonASCIISpaceCharacter;\n\n/**\r\n * the \"commonly mapped to nothing\" characters [StringPrep, B.1]\r\n * that can be mapped to nothing.\r\n */\nconst mapping2nothing = isCommonlyMappedToNothing;\n\n// utils\nconst getCodePoint = character => character.codePointAt(0);\nconst first = x => x[0];\nconst last = x => x[x.length - 1];\n\n/**\r\n * Convert provided string into an array of Unicode Code Points.\r\n * Based on https://stackoverflow.com/a/21409165/1556249\r\n * and https://www.npmjs.com/package/code-point-at.\r\n * @param {string} input\r\n * @returns {number[]}\r\n */\nfunction toCodePoints(input) {\n  const codepoints = [];\n  const size = input.length;\n  for (let i = 0; i < size; i += 1) {\n    const before = input.charCodeAt(i);\n    if (before >= 0xd800 && before <= 0xdbff && size > i + 1) {\n      const next = input.charCodeAt(i + 1);\n      if (next >= 0xdc00 && next <= 0xdfff) {\n        codepoints.push((before - 0xd800) * 0x400 + next - 0xdc00 + 0x10000);\n        i += 1;\n        continue;\n      }\n    }\n    codepoints.push(before);\n  }\n  return codepoints;\n}\n\n/**\r\n * SASLprep.\r\n * @param {string} input\r\n * @param {Object} opts\r\n * @param {boolean} opts.allowUnassigned\r\n * @returns {string}\r\n */\nfunction saslprep(input) {\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  if (typeof input !== 'string') {\n    throw new TypeError('Expected string.');\n  }\n  if (input.length === 0) {\n    return '';\n  }\n\n  // 1. Map\n  const mapped_input = toCodePoints(input)\n  // 1.1 mapping to space\n  .map(character => mapping2space(character) ? 0x20 : character)\n  // 1.2 mapping to nothing\n  .filter(character => !mapping2nothing(character));\n\n  // 2. Normalize\n  const normalized_input = String.fromCodePoint.apply(null, mapped_input).normalize('NFKC');\n  const normalized_map = toCodePoints(normalized_input);\n\n  // 3. Prohibit\n  const hasProhibited = normalized_map.some(isProhibitedCharacter);\n  if (hasProhibited) {\n    throw new Error('Prohibited character, see https://tools.ietf.org/html/rfc4013#section-2.3');\n  }\n\n  // Unassigned Code Points\n  if (opts.allowUnassigned !== true) {\n    const hasUnassigned = normalized_map.some(isUnassignedCodePoint);\n    if (hasUnassigned) {\n      throw new Error('Unassigned code point, see https://tools.ietf.org/html/rfc4013#section-2.5');\n    }\n  }\n\n  // 4. check bidi\n\n  const hasBidiRAL = normalized_map.some(isBidirectionalRAL);\n  const hasBidiL = normalized_map.some(isBidirectionalL);\n\n  // 4.1 If a string contains any RandALCat character, the string MUST NOT\n  // contain any LCat character.\n  if (hasBidiRAL && hasBidiL) {\n    throw new Error('String must not contain RandALCat and LCat at the same time,' + ' see https://tools.ietf.org/html/rfc3454#section-6');\n  }\n\n  /**\r\n   * 4.2 If a string contains any RandALCat character, a RandALCat\r\n   * character MUST be the first character of the string, and a\r\n   * RandALCat character MUST be the last character of the string.\r\n   */\n\n  const isFirstBidiRAL = isBidirectionalRAL(getCodePoint(first(normalized_input)));\n  const isLastBidiRAL = isBidirectionalRAL(getCodePoint(last(normalized_input)));\n  if (hasBidiRAL && !(isFirstBidiRAL && isLastBidiRAL)) {\n    throw new Error('Bidirectional RandALCat character must be the first and the last' + ' character of the string, see https://tools.ietf.org/html/rfc3454#section-6');\n  }\n  return normalized_input;\n}\n\n/*\r\n   PDFSecurity - represents PDF security settings\r\n   By Yang Liu <hi@zesik.com>\r\n */\nclass PDFSecurity {\n  static generateFileID() {\n    let info = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let infoStr = `${info.CreationDate.getTime()}\\n`;\n    for (let key in info) {\n      // eslint-disable-next-line no-prototype-builtins\n      if (!info.hasOwnProperty(key)) {\n        continue;\n      }\n      infoStr += `${key}: ${info[key].valueOf()}\\n`;\n    }\n    return wordArrayToBuffer(CryptoJS.MD5(infoStr));\n  }\n  static generateRandomWordArray(bytes) {\n    return CryptoJS.lib.WordArray.random(bytes);\n  }\n  static create(document) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    if (!options.ownerPassword && !options.userPassword) {\n      return null;\n    }\n    return new PDFSecurity(document, options);\n  }\n  constructor(document) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    if (!options.ownerPassword && !options.userPassword) {\n      throw new Error('None of owner password and user password is defined.');\n    }\n    this.document = document;\n    this._setupEncryption(options);\n  }\n  _setupEncryption(options) {\n    switch (options.pdfVersion) {\n      case '1.4':\n      case '1.5':\n        this.version = 2;\n        break;\n      case '1.6':\n      case '1.7':\n        this.version = 4;\n        break;\n      case '1.7ext3':\n        this.version = 5;\n        break;\n      default:\n        this.version = 1;\n        break;\n    }\n    const encDict = {\n      Filter: 'Standard'\n    };\n    switch (this.version) {\n      case 1:\n      case 2:\n      case 4:\n        this._setupEncryptionV1V2V4(this.version, encDict, options);\n        break;\n      case 5:\n        this._setupEncryptionV5(encDict, options);\n        break;\n    }\n    this.dictionary = this.document.ref(encDict);\n  }\n  _setupEncryptionV1V2V4(v, encDict, options) {\n    let r, permissions;\n    switch (v) {\n      case 1:\n        r = 2;\n        this.keyBits = 40;\n        permissions = getPermissionsR2(options.permissions);\n        break;\n      case 2:\n        r = 3;\n        this.keyBits = 128;\n        permissions = getPermissionsR3(options.permissions);\n        break;\n      case 4:\n        r = 4;\n        this.keyBits = 128;\n        permissions = getPermissionsR3(options.permissions);\n        break;\n    }\n    const paddedUserPassword = processPasswordR2R3R4(options.userPassword);\n    const paddedOwnerPassword = options.ownerPassword ? processPasswordR2R3R4(options.ownerPassword) : paddedUserPassword;\n    const ownerPasswordEntry = getOwnerPasswordR2R3R4(r, this.keyBits, paddedUserPassword, paddedOwnerPassword);\n    this.encryptionKey = getEncryptionKeyR2R3R4(r, this.keyBits, this.document._id, paddedUserPassword, ownerPasswordEntry, permissions);\n    let userPasswordEntry;\n    if (r === 2) {\n      userPasswordEntry = getUserPasswordR2(this.encryptionKey);\n    } else {\n      userPasswordEntry = getUserPasswordR3R4(this.document._id, this.encryptionKey);\n    }\n    encDict.V = v;\n    if (v >= 2) {\n      encDict.Length = this.keyBits;\n    }\n    if (v === 4) {\n      encDict.CF = {\n        StdCF: {\n          AuthEvent: 'DocOpen',\n          CFM: 'AESV2',\n          Length: this.keyBits / 8\n        }\n      };\n      encDict.StmF = 'StdCF';\n      encDict.StrF = 'StdCF';\n    }\n    encDict.R = r;\n    encDict.O = wordArrayToBuffer(ownerPasswordEntry);\n    encDict.U = wordArrayToBuffer(userPasswordEntry);\n    encDict.P = permissions;\n  }\n  _setupEncryptionV5(encDict, options) {\n    this.keyBits = 256;\n    const permissions = getPermissionsR3(options.permissions);\n    const processedUserPassword = processPasswordR5(options.userPassword);\n    const processedOwnerPassword = options.ownerPassword ? processPasswordR5(options.ownerPassword) : processedUserPassword;\n    this.encryptionKey = getEncryptionKeyR5(PDFSecurity.generateRandomWordArray);\n    const userPasswordEntry = getUserPasswordR5(processedUserPassword, PDFSecurity.generateRandomWordArray);\n    const userKeySalt = CryptoJS.lib.WordArray.create(userPasswordEntry.words.slice(10, 12), 8);\n    const userEncryptionKeyEntry = getUserEncryptionKeyR5(processedUserPassword, userKeySalt, this.encryptionKey);\n    const ownerPasswordEntry = getOwnerPasswordR5(processedOwnerPassword, userPasswordEntry, PDFSecurity.generateRandomWordArray);\n    const ownerKeySalt = CryptoJS.lib.WordArray.create(ownerPasswordEntry.words.slice(10, 12), 8);\n    const ownerEncryptionKeyEntry = getOwnerEncryptionKeyR5(processedOwnerPassword, ownerKeySalt, userPasswordEntry, this.encryptionKey);\n    const permsEntry = getEncryptedPermissionsR5(permissions, this.encryptionKey, PDFSecurity.generateRandomWordArray);\n    encDict.V = 5;\n    encDict.Length = this.keyBits;\n    encDict.CF = {\n      StdCF: {\n        AuthEvent: 'DocOpen',\n        CFM: 'AESV3',\n        Length: this.keyBits / 8\n      }\n    };\n    encDict.StmF = 'StdCF';\n    encDict.StrF = 'StdCF';\n    encDict.R = 5;\n    encDict.O = wordArrayToBuffer(ownerPasswordEntry);\n    encDict.OE = wordArrayToBuffer(ownerEncryptionKeyEntry);\n    encDict.U = wordArrayToBuffer(userPasswordEntry);\n    encDict.UE = wordArrayToBuffer(userEncryptionKeyEntry);\n    encDict.P = permissions;\n    encDict.Perms = wordArrayToBuffer(permsEntry);\n  }\n  getEncryptFn(obj, gen) {\n    let digest;\n    if (this.version < 5) {\n      digest = this.encryptionKey.clone().concat(CryptoJS.lib.WordArray.create([(obj & 0xff) << 24 | (obj & 0xff00) << 8 | obj >> 8 & 0xff00 | gen & 0xff, (gen & 0xff00) << 16], 5));\n    }\n    if (this.version === 1 || this.version === 2) {\n      let key = CryptoJS.MD5(digest);\n      key.sigBytes = Math.min(16, this.keyBits / 8 + 5);\n      return buffer => wordArrayToBuffer(CryptoJS.RC4.encrypt(CryptoJS.lib.WordArray.create(buffer), key).ciphertext);\n    }\n    let key;\n    if (this.version === 4) {\n      key = CryptoJS.MD5(digest.concat(CryptoJS.lib.WordArray.create([0x73416c54], 4)));\n    } else {\n      key = this.encryptionKey;\n    }\n    const iv = PDFSecurity.generateRandomWordArray(16);\n    const options = {\n      mode: CryptoJS.mode.CBC,\n      padding: CryptoJS.pad.Pkcs7,\n      iv\n    };\n    return buffer => wordArrayToBuffer(iv.clone().concat(CryptoJS.AES.encrypt(CryptoJS.lib.WordArray.create(buffer), key, options).ciphertext));\n  }\n  end() {\n    this.dictionary.end();\n  }\n}\nfunction getPermissionsR2() {\n  let permissionObject = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  let permissions = 0xffffffc0 >> 0;\n  if (permissionObject.printing) {\n    permissions |= 0b000000000100;\n  }\n  if (permissionObject.modifying) {\n    permissions |= 0b000000001000;\n  }\n  if (permissionObject.copying) {\n    permissions |= 0b000000010000;\n  }\n  if (permissionObject.annotating) {\n    permissions |= 0b000000100000;\n  }\n  return permissions;\n}\nfunction getPermissionsR3() {\n  let permissionObject = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  let permissions = 0xfffff0c0 >> 0;\n  if (permissionObject.printing === 'lowResolution') {\n    permissions |= 0b000000000100;\n  }\n  if (permissionObject.printing === 'highResolution') {\n    permissions |= 0b100000000100;\n  }\n  if (permissionObject.modifying) {\n    permissions |= 0b000000001000;\n  }\n  if (permissionObject.copying) {\n    permissions |= 0b000000010000;\n  }\n  if (permissionObject.annotating) {\n    permissions |= 0b000000100000;\n  }\n  if (permissionObject.fillingForms) {\n    permissions |= 0b000100000000;\n  }\n  if (permissionObject.contentAccessibility) {\n    permissions |= 0b001000000000;\n  }\n  if (permissionObject.documentAssembly) {\n    permissions |= 0b010000000000;\n  }\n  return permissions;\n}\nfunction getUserPasswordR2(encryptionKey) {\n  return CryptoJS.RC4.encrypt(processPasswordR2R3R4(), encryptionKey).ciphertext;\n}\nfunction getUserPasswordR3R4(documentId, encryptionKey) {\n  const key = encryptionKey.clone();\n  let cipher = CryptoJS.MD5(processPasswordR2R3R4().concat(CryptoJS.lib.WordArray.create(documentId)));\n  for (let i = 0; i < 20; i++) {\n    const xorRound = Math.ceil(key.sigBytes / 4);\n    for (let j = 0; j < xorRound; j++) {\n      key.words[j] = encryptionKey.words[j] ^ (i | i << 8 | i << 16 | i << 24);\n    }\n    cipher = CryptoJS.RC4.encrypt(cipher, key).ciphertext;\n  }\n  return cipher.concat(CryptoJS.lib.WordArray.create(null, 16));\n}\nfunction getOwnerPasswordR2R3R4(r, keyBits, paddedUserPassword, paddedOwnerPassword) {\n  let digest = paddedOwnerPassword;\n  let round = r >= 3 ? 51 : 1;\n  for (let i = 0; i < round; i++) {\n    digest = CryptoJS.MD5(digest);\n  }\n  const key = digest.clone();\n  key.sigBytes = keyBits / 8;\n  let cipher = paddedUserPassword;\n  round = r >= 3 ? 20 : 1;\n  for (let i = 0; i < round; i++) {\n    const xorRound = Math.ceil(key.sigBytes / 4);\n    for (let j = 0; j < xorRound; j++) {\n      key.words[j] = digest.words[j] ^ (i | i << 8 | i << 16 | i << 24);\n    }\n    cipher = CryptoJS.RC4.encrypt(cipher, key).ciphertext;\n  }\n  return cipher;\n}\nfunction getEncryptionKeyR2R3R4(r, keyBits, documentId, paddedUserPassword, ownerPasswordEntry, permissions) {\n  let key = paddedUserPassword.clone().concat(ownerPasswordEntry).concat(CryptoJS.lib.WordArray.create([lsbFirstWord(permissions)], 4)).concat(CryptoJS.lib.WordArray.create(documentId));\n  const round = r >= 3 ? 51 : 1;\n  for (let i = 0; i < round; i++) {\n    key = CryptoJS.MD5(key);\n    key.sigBytes = keyBits / 8;\n  }\n  return key;\n}\nfunction getUserPasswordR5(processedUserPassword, generateRandomWordArray) {\n  const validationSalt = generateRandomWordArray(8);\n  const keySalt = generateRandomWordArray(8);\n  return CryptoJS.SHA256(processedUserPassword.clone().concat(validationSalt)).concat(validationSalt).concat(keySalt);\n}\nfunction getUserEncryptionKeyR5(processedUserPassword, userKeySalt, encryptionKey) {\n  const key = CryptoJS.SHA256(processedUserPassword.clone().concat(userKeySalt));\n  const options = {\n    mode: CryptoJS.mode.CBC,\n    padding: CryptoJS.pad.NoPadding,\n    iv: CryptoJS.lib.WordArray.create(null, 16)\n  };\n  return CryptoJS.AES.encrypt(encryptionKey, key, options).ciphertext;\n}\nfunction getOwnerPasswordR5(processedOwnerPassword, userPasswordEntry, generateRandomWordArray) {\n  const validationSalt = generateRandomWordArray(8);\n  const keySalt = generateRandomWordArray(8);\n  return CryptoJS.SHA256(processedOwnerPassword.clone().concat(validationSalt).concat(userPasswordEntry)).concat(validationSalt).concat(keySalt);\n}\nfunction getOwnerEncryptionKeyR5(processedOwnerPassword, ownerKeySalt, userPasswordEntry, encryptionKey) {\n  const key = CryptoJS.SHA256(processedOwnerPassword.clone().concat(ownerKeySalt).concat(userPasswordEntry));\n  const options = {\n    mode: CryptoJS.mode.CBC,\n    padding: CryptoJS.pad.NoPadding,\n    iv: CryptoJS.lib.WordArray.create(null, 16)\n  };\n  return CryptoJS.AES.encrypt(encryptionKey, key, options).ciphertext;\n}\nfunction getEncryptionKeyR5(generateRandomWordArray) {\n  return generateRandomWordArray(32);\n}\nfunction getEncryptedPermissionsR5(permissions, encryptionKey, generateRandomWordArray) {\n  const cipher = CryptoJS.lib.WordArray.create([lsbFirstWord(permissions), 0xffffffff, 0x54616462], 12).concat(generateRandomWordArray(4));\n  const options = {\n    mode: CryptoJS.mode.ECB,\n    padding: CryptoJS.pad.NoPadding\n  };\n  return CryptoJS.AES.encrypt(cipher, encryptionKey, options).ciphertext;\n}\nfunction processPasswordR2R3R4() {\n  let password = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  const out = Buffer.alloc(32);\n  const length = password.length;\n  let index = 0;\n  while (index < length && index < 32) {\n    const code = password.charCodeAt(index);\n    if (code > 0xff) {\n      throw new Error('Password contains one or more invalid characters.');\n    }\n    out[index] = code;\n    index++;\n  }\n  while (index < 32) {\n    out[index] = PASSWORD_PADDING[index - length];\n    index++;\n  }\n  return CryptoJS.lib.WordArray.create(out);\n}\nfunction processPasswordR5() {\n  let password = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  password = unescape(encodeURIComponent(saslprep(password)));\n  const length = Math.min(127, password.length);\n  const out = Buffer.alloc(length);\n  for (let i = 0; i < length; i++) {\n    out[i] = password.charCodeAt(i);\n  }\n  return CryptoJS.lib.WordArray.create(out);\n}\nfunction lsbFirstWord(data) {\n  return (data & 0xff) << 24 | (data & 0xff00) << 8 | data >> 8 & 0xff00 | data >> 24 & 0xff;\n}\nfunction wordArrayToBuffer(wordArray) {\n  const byteArray = [];\n  for (let i = 0; i < wordArray.sigBytes; i++) {\n    byteArray.push(wordArray.words[Math.floor(i / 4)] >> 8 * (3 - i % 4) & 0xff);\n  }\n  return Buffer.from(byteArray);\n}\nconst PASSWORD_PADDING = [0x28, 0xbf, 0x4e, 0x5e, 0x4e, 0x75, 0x8a, 0x41, 0x64, 0x00, 0x4e, 0x56, 0xff, 0xfa, 0x01, 0x08, 0x2e, 0x2e, 0x00, 0xb6, 0xd0, 0x68, 0x3e, 0x80, 0x2f, 0x0c, 0xa9, 0xfe, 0x64, 0x53, 0x69, 0x7a];\nconst {\n  number\n} = PDFObject;\nclass PDFGradient {\n  constructor(doc) {\n    this.doc = doc;\n    this.stops = [];\n    this.embedded = false;\n    this.transform = [1, 0, 0, 1, 0, 0];\n  }\n  stop(pos, color, opacity) {\n    if (opacity == null) {\n      opacity = 1;\n    }\n    color = this.doc._normalizeColor(color);\n    if (this.stops.length === 0) {\n      if (color.length === 3) {\n        this._colorSpace = 'DeviceRGB';\n      } else if (color.length === 4) {\n        this._colorSpace = 'DeviceCMYK';\n      } else if (color.length === 1) {\n        this._colorSpace = 'DeviceGray';\n      } else {\n        throw new Error('Unknown color space');\n      }\n    } else if (this._colorSpace === 'DeviceRGB' && color.length !== 3 || this._colorSpace === 'DeviceCMYK' && color.length !== 4 || this._colorSpace === 'DeviceGray' && color.length !== 1) {\n      throw new Error('All gradient stops must use the same color space');\n    }\n    opacity = Math.max(0, Math.min(1, opacity));\n    this.stops.push([pos, color, opacity]);\n    return this;\n  }\n  setTransform(m11, m12, m21, m22, dx, dy) {\n    this.transform = [m11, m12, m21, m22, dx, dy];\n    return this;\n  }\n  embed(m) {\n    let fn;\n    const stopsLength = this.stops.length;\n    if (stopsLength === 0) {\n      return;\n    }\n    this.embedded = true;\n    this.matrix = m;\n\n    // if the last stop comes before 100%, add a copy at 100%\n    const last = this.stops[stopsLength - 1];\n    if (last[0] < 1) {\n      this.stops.push([1, last[1], last[2]]);\n    }\n    const bounds = [];\n    const encode = [];\n    const stops = [];\n    for (let i = 0; i < stopsLength - 1; i++) {\n      encode.push(0, 1);\n      if (i + 2 !== stopsLength) {\n        bounds.push(this.stops[i + 1][0]);\n      }\n      fn = this.doc.ref({\n        FunctionType: 2,\n        Domain: [0, 1],\n        C0: this.stops[i + 0][1],\n        C1: this.stops[i + 1][1],\n        N: 1\n      });\n      stops.push(fn);\n      fn.end();\n    }\n\n    // if there are only two stops, we don't need a stitching function\n    if (stopsLength === 1) {\n      fn = stops[0];\n    } else {\n      fn = this.doc.ref({\n        FunctionType: 3,\n        // stitching function\n        Domain: [0, 1],\n        Functions: stops,\n        Bounds: bounds,\n        Encode: encode\n      });\n      fn.end();\n    }\n    this.id = `Sh${++this.doc._gradCount}`;\n    const shader = this.shader(fn);\n    shader.end();\n    const pattern = this.doc.ref({\n      Type: 'Pattern',\n      PatternType: 2,\n      Shading: shader,\n      Matrix: this.matrix.map(number)\n    });\n    pattern.end();\n    if (this.stops.some(stop => stop[2] < 1)) {\n      let grad = this.opacityGradient();\n      grad._colorSpace = 'DeviceGray';\n      for (let stop of this.stops) {\n        grad.stop(stop[0], [stop[2]]);\n      }\n      grad = grad.embed(this.matrix);\n      const pageBBox = [0, 0, this.doc.page.width, this.doc.page.height];\n      const form = this.doc.ref({\n        Type: 'XObject',\n        Subtype: 'Form',\n        FormType: 1,\n        BBox: pageBBox,\n        Group: {\n          Type: 'Group',\n          S: 'Transparency',\n          CS: 'DeviceGray'\n        },\n        Resources: {\n          ProcSet: ['PDF', 'Text', 'ImageB', 'ImageC', 'ImageI'],\n          Pattern: {\n            Sh1: grad\n          }\n        }\n      });\n      form.write('/Pattern cs /Sh1 scn');\n      form.end(`${pageBBox.join(' ')} re f`);\n      const gstate = this.doc.ref({\n        Type: 'ExtGState',\n        SMask: {\n          Type: 'Mask',\n          S: 'Luminosity',\n          G: form\n        }\n      });\n      gstate.end();\n      const opacityPattern = this.doc.ref({\n        Type: 'Pattern',\n        PatternType: 1,\n        PaintType: 1,\n        TilingType: 2,\n        BBox: pageBBox,\n        XStep: pageBBox[2],\n        YStep: pageBBox[3],\n        Resources: {\n          ProcSet: ['PDF', 'Text', 'ImageB', 'ImageC', 'ImageI'],\n          Pattern: {\n            Sh1: pattern\n          },\n          ExtGState: {\n            Gs1: gstate\n          }\n        }\n      });\n      opacityPattern.write('/Gs1 gs /Pattern cs /Sh1 scn');\n      opacityPattern.end(`${pageBBox.join(' ')} re f`);\n      this.doc.page.patterns[this.id] = opacityPattern;\n    } else {\n      this.doc.page.patterns[this.id] = pattern;\n    }\n    return pattern;\n  }\n  apply(stroke) {\n    // apply gradient transform to existing document ctm\n    const [m0, m1, m2, m3, m4, m5] = this.doc._ctm;\n    const [m11, m12, m21, m22, dx, dy] = this.transform;\n    const m = [m0 * m11 + m2 * m12, m1 * m11 + m3 * m12, m0 * m21 + m2 * m22, m1 * m21 + m3 * m22, m0 * dx + m2 * dy + m4, m1 * dx + m3 * dy + m5];\n    if (!this.embedded || m.join(' ') !== this.matrix.join(' ')) {\n      this.embed(m);\n    }\n    this.doc._setColorSpace('Pattern', stroke);\n    const op = stroke ? 'SCN' : 'scn';\n    return this.doc.addContent(`/${this.id} ${op}`);\n  }\n}\nclass PDFLinearGradient extends PDFGradient {\n  constructor(doc, x1, y1, x2, y2) {\n    super(doc);\n    this.x1 = x1;\n    this.y1 = y1;\n    this.x2 = x2;\n    this.y2 = y2;\n  }\n  shader(fn) {\n    return this.doc.ref({\n      ShadingType: 2,\n      ColorSpace: this._colorSpace,\n      Coords: [this.x1, this.y1, this.x2, this.y2],\n      Function: fn,\n      Extend: [true, true]\n    });\n  }\n  opacityGradient() {\n    return new PDFLinearGradient(this.doc, this.x1, this.y1, this.x2, this.y2);\n  }\n}\nclass PDFRadialGradient extends PDFGradient {\n  constructor(doc, x1, y1, r1, x2, y2, r2) {\n    super(doc);\n    this.doc = doc;\n    this.x1 = x1;\n    this.y1 = y1;\n    this.r1 = r1;\n    this.x2 = x2;\n    this.y2 = y2;\n    this.r2 = r2;\n  }\n  shader(fn) {\n    return this.doc.ref({\n      ShadingType: 3,\n      ColorSpace: this._colorSpace,\n      Coords: [this.x1, this.y1, this.r1, this.x2, this.y2, this.r2],\n      Function: fn,\n      Extend: [true, true]\n    });\n  }\n  opacityGradient() {\n    return new PDFRadialGradient(this.doc, this.x1, this.y1, this.r1, this.x2, this.y2, this.r2);\n  }\n}\nvar Gradient = {\n  PDFGradient,\n  PDFLinearGradient,\n  PDFRadialGradient\n};\n\n/*\r\nPDF tiling pattern support. Uncolored only.\r\n */\n\nconst underlyingColorSpaces = ['DeviceCMYK', 'DeviceRGB'];\nclass PDFTilingPattern {\n  constructor(doc, bBox, xStep, yStep, stream) {\n    this.doc = doc;\n    this.bBox = bBox;\n    this.xStep = xStep;\n    this.yStep = yStep;\n    this.stream = stream;\n  }\n  createPattern() {\n    // no resources needed for our current usage\n    // required entry\n    const resources = this.doc.ref();\n    resources.end();\n    // apply default transform matrix (flipped in the default doc._ctm)\n    // see document.js & gradient.js\n    const [m0, m1, m2, m3, m4, m5] = this.doc._ctm;\n    const [m11, m12, m21, m22, dx, dy] = [1, 0, 0, 1, 0, 0];\n    const m = [m0 * m11 + m2 * m12, m1 * m11 + m3 * m12, m0 * m21 + m2 * m22, m1 * m21 + m3 * m22, m0 * dx + m2 * dy + m4, m1 * dx + m3 * dy + m5];\n    const pattern = this.doc.ref({\n      Type: 'Pattern',\n      PatternType: 1,\n      // tiling\n      PaintType: 2,\n      // 1-colored, 2-uncolored\n      TilingType: 2,\n      // 2-no distortion\n      BBox: this.bBox,\n      XStep: this.xStep,\n      YStep: this.yStep,\n      Matrix: m.map(v => +v.toFixed(5)),\n      Resources: resources\n    });\n    pattern.end(this.stream);\n    return pattern;\n  }\n  embedPatternColorSpaces() {\n    // map each pattern to an underlying color space\n    // and embed on each page\n    underlyingColorSpaces.forEach(csName => {\n      const csId = this.getPatternColorSpaceId(csName);\n      if (this.doc.page.colorSpaces[csId]) return;\n      const cs = this.doc.ref(['Pattern', csName]);\n      cs.end();\n      this.doc.page.colorSpaces[csId] = cs;\n    });\n  }\n  getPatternColorSpaceId(underlyingColorspace) {\n    return `CsP${underlyingColorspace}`;\n  }\n  embed() {\n    if (!this.id) {\n      this.doc._patternCount = this.doc._patternCount + 1;\n      this.id = 'P' + this.doc._patternCount;\n      this.pattern = this.createPattern();\n    }\n\n    // patterns are embedded in each page\n    if (!this.doc.page.patterns[this.id]) {\n      this.doc.page.patterns[this.id] = this.pattern;\n    }\n  }\n  apply(stroke, patternColor) {\n    // do any embedding/creating that might be needed\n    this.embedPatternColorSpaces();\n    this.embed();\n    const normalizedColor = this.doc._normalizeColor(patternColor);\n    if (!normalizedColor) throw Error(`invalid pattern color. (value: ${patternColor})`);\n\n    // select one of the pattern color spaces\n    const csId = this.getPatternColorSpaceId(this.doc._getColorSpace(normalizedColor));\n    this.doc._setColorSpace(csId, stroke);\n\n    // stroke/fill using the pattern and color (in the above underlying color space)\n    const op = stroke ? 'SCN' : 'scn';\n    return this.doc.addContent(`${normalizedColor.join(' ')} /${this.id} ${op}`);\n  }\n}\nvar pattern = {\n  PDFTilingPattern\n};\nconst {\n  PDFGradient: PDFGradient$1,\n  PDFLinearGradient: PDFLinearGradient$1,\n  PDFRadialGradient: PDFRadialGradient$1\n} = Gradient;\nconst {\n  PDFTilingPattern: PDFTilingPattern$1\n} = pattern;\nvar ColorMixin = {\n  initColor() {\n    // The opacity dictionaries\n    this._opacityRegistry = {};\n    this._opacityCount = 0;\n    this._patternCount = 0;\n    return this._gradCount = 0;\n  },\n  _normalizeColor(color) {\n    if (typeof color === 'string') {\n      if (color.charAt(0) === '#') {\n        if (color.length === 4) {\n          color = color.replace(/#([0-9A-F])([0-9A-F])([0-9A-F])/i, '#$1$1$2$2$3$3');\n        }\n        const hex = parseInt(color.slice(1), 16);\n        color = [hex >> 16, hex >> 8 & 0xff, hex & 0xff];\n      } else if (namedColors[color]) {\n        color = namedColors[color];\n      }\n    }\n    if (Array.isArray(color)) {\n      // RGB\n      if (color.length === 3) {\n        color = color.map(part => part / 255);\n        // CMYK\n      } else if (color.length === 4) {\n        color = color.map(part => part / 100);\n      }\n      return color;\n    }\n    return null;\n  },\n  _setColor(color, stroke) {\n    if (color instanceof PDFGradient$1) {\n      color.apply(stroke);\n      return true;\n      // see if tiling pattern, decode & apply it it\n    } else if (Array.isArray(color) && color[0] instanceof PDFTilingPattern$1) {\n      color[0].apply(stroke, color[1]);\n      return true;\n    }\n    // any other case should be a normal color and not a pattern\n    return this._setColorCore(color, stroke);\n  },\n  _setColorCore(color, stroke) {\n    color = this._normalizeColor(color);\n    if (!color) {\n      return false;\n    }\n    const op = stroke ? 'SCN' : 'scn';\n    const space = this._getColorSpace(color);\n    this._setColorSpace(space, stroke);\n    color = color.join(' ');\n    this.addContent(`${color} ${op}`);\n    return true;\n  },\n  _setColorSpace(space, stroke) {\n    const op = stroke ? 'CS' : 'cs';\n    return this.addContent(`/${space} ${op}`);\n  },\n  _getColorSpace(color) {\n    return color.length === 4 ? 'DeviceCMYK' : 'DeviceRGB';\n  },\n  fillColor(color, opacity) {\n    const set = this._setColor(color, false);\n    if (set) {\n      this.fillOpacity(opacity);\n    }\n\n    // save this for text wrapper, which needs to reset\n    // the fill color on new pages\n    this._fillColor = [color, opacity];\n    return this;\n  },\n  strokeColor(color, opacity) {\n    const set = this._setColor(color, true);\n    if (set) {\n      this.strokeOpacity(opacity);\n    }\n    return this;\n  },\n  opacity(opacity) {\n    this._doOpacity(opacity, opacity);\n    return this;\n  },\n  fillOpacity(opacity) {\n    this._doOpacity(opacity, null);\n    return this;\n  },\n  strokeOpacity(opacity) {\n    this._doOpacity(null, opacity);\n    return this;\n  },\n  _doOpacity(fillOpacity, strokeOpacity) {\n    let dictionary, name;\n    if (fillOpacity == null && strokeOpacity == null) {\n      return;\n    }\n    if (fillOpacity != null) {\n      fillOpacity = Math.max(0, Math.min(1, fillOpacity));\n    }\n    if (strokeOpacity != null) {\n      strokeOpacity = Math.max(0, Math.min(1, strokeOpacity));\n    }\n    const key = `${fillOpacity}_${strokeOpacity}`;\n    if (this._opacityRegistry[key]) {\n      [dictionary, name] = this._opacityRegistry[key];\n    } else {\n      dictionary = {\n        Type: 'ExtGState'\n      };\n      if (fillOpacity != null) {\n        dictionary.ca = fillOpacity;\n      }\n      if (strokeOpacity != null) {\n        dictionary.CA = strokeOpacity;\n      }\n      dictionary = this.ref(dictionary);\n      dictionary.end();\n      const id = ++this._opacityCount;\n      name = `Gs${id}`;\n      this._opacityRegistry[key] = [dictionary, name];\n    }\n    this.page.ext_gstates[name] = dictionary;\n    return this.addContent(`/${name} gs`);\n  },\n  linearGradient(x1, y1, x2, y2) {\n    return new PDFLinearGradient$1(this, x1, y1, x2, y2);\n  },\n  radialGradient(x1, y1, r1, x2, y2, r2) {\n    return new PDFRadialGradient$1(this, x1, y1, r1, x2, y2, r2);\n  },\n  pattern(bbox, xStep, yStep, stream) {\n    return new PDFTilingPattern$1(this, bbox, xStep, yStep, stream);\n  }\n};\nvar namedColors = {\n  aliceblue: [240, 248, 255],\n  antiquewhite: [250, 235, 215],\n  aqua: [0, 255, 255],\n  aquamarine: [127, 255, 212],\n  azure: [240, 255, 255],\n  beige: [245, 245, 220],\n  bisque: [255, 228, 196],\n  black: [0, 0, 0],\n  blanchedalmond: [255, 235, 205],\n  blue: [0, 0, 255],\n  blueviolet: [138, 43, 226],\n  brown: [165, 42, 42],\n  burlywood: [222, 184, 135],\n  cadetblue: [95, 158, 160],\n  chartreuse: [127, 255, 0],\n  chocolate: [210, 105, 30],\n  coral: [255, 127, 80],\n  cornflowerblue: [100, 149, 237],\n  cornsilk: [255, 248, 220],\n  crimson: [220, 20, 60],\n  cyan: [0, 255, 255],\n  darkblue: [0, 0, 139],\n  darkcyan: [0, 139, 139],\n  darkgoldenrod: [184, 134, 11],\n  darkgray: [169, 169, 169],\n  darkgreen: [0, 100, 0],\n  darkgrey: [169, 169, 169],\n  darkkhaki: [189, 183, 107],\n  darkmagenta: [139, 0, 139],\n  darkolivegreen: [85, 107, 47],\n  darkorange: [255, 140, 0],\n  darkorchid: [153, 50, 204],\n  darkred: [139, 0, 0],\n  darksalmon: [233, 150, 122],\n  darkseagreen: [143, 188, 143],\n  darkslateblue: [72, 61, 139],\n  darkslategray: [47, 79, 79],\n  darkslategrey: [47, 79, 79],\n  darkturquoise: [0, 206, 209],\n  darkviolet: [148, 0, 211],\n  deeppink: [255, 20, 147],\n  deepskyblue: [0, 191, 255],\n  dimgray: [105, 105, 105],\n  dimgrey: [105, 105, 105],\n  dodgerblue: [30, 144, 255],\n  firebrick: [178, 34, 34],\n  floralwhite: [255, 250, 240],\n  forestgreen: [34, 139, 34],\n  fuchsia: [255, 0, 255],\n  gainsboro: [220, 220, 220],\n  ghostwhite: [248, 248, 255],\n  gold: [255, 215, 0],\n  goldenrod: [218, 165, 32],\n  gray: [128, 128, 128],\n  grey: [128, 128, 128],\n  green: [0, 128, 0],\n  greenyellow: [173, 255, 47],\n  honeydew: [240, 255, 240],\n  hotpink: [255, 105, 180],\n  indianred: [205, 92, 92],\n  indigo: [75, 0, 130],\n  ivory: [255, 255, 240],\n  khaki: [240, 230, 140],\n  lavender: [230, 230, 250],\n  lavenderblush: [255, 240, 245],\n  lawngreen: [124, 252, 0],\n  lemonchiffon: [255, 250, 205],\n  lightblue: [173, 216, 230],\n  lightcoral: [240, 128, 128],\n  lightcyan: [224, 255, 255],\n  lightgoldenrodyellow: [250, 250, 210],\n  lightgray: [211, 211, 211],\n  lightgreen: [144, 238, 144],\n  lightgrey: [211, 211, 211],\n  lightpink: [255, 182, 193],\n  lightsalmon: [255, 160, 122],\n  lightseagreen: [32, 178, 170],\n  lightskyblue: [135, 206, 250],\n  lightslategray: [119, 136, 153],\n  lightslategrey: [119, 136, 153],\n  lightsteelblue: [176, 196, 222],\n  lightyellow: [255, 255, 224],\n  lime: [0, 255, 0],\n  limegreen: [50, 205, 50],\n  linen: [250, 240, 230],\n  magenta: [255, 0, 255],\n  maroon: [128, 0, 0],\n  mediumaquamarine: [102, 205, 170],\n  mediumblue: [0, 0, 205],\n  mediumorchid: [186, 85, 211],\n  mediumpurple: [147, 112, 219],\n  mediumseagreen: [60, 179, 113],\n  mediumslateblue: [123, 104, 238],\n  mediumspringgreen: [0, 250, 154],\n  mediumturquoise: [72, 209, 204],\n  mediumvioletred: [199, 21, 133],\n  midnightblue: [25, 25, 112],\n  mintcream: [245, 255, 250],\n  mistyrose: [255, 228, 225],\n  moccasin: [255, 228, 181],\n  navajowhite: [255, 222, 173],\n  navy: [0, 0, 128],\n  oldlace: [253, 245, 230],\n  olive: [128, 128, 0],\n  olivedrab: [107, 142, 35],\n  orange: [255, 165, 0],\n  orangered: [255, 69, 0],\n  orchid: [218, 112, 214],\n  palegoldenrod: [238, 232, 170],\n  palegreen: [152, 251, 152],\n  paleturquoise: [175, 238, 238],\n  palevioletred: [219, 112, 147],\n  papayawhip: [255, 239, 213],\n  peachpuff: [255, 218, 185],\n  peru: [205, 133, 63],\n  pink: [255, 192, 203],\n  plum: [221, 160, 221],\n  powderblue: [176, 224, 230],\n  purple: [128, 0, 128],\n  red: [255, 0, 0],\n  rosybrown: [188, 143, 143],\n  royalblue: [65, 105, 225],\n  saddlebrown: [139, 69, 19],\n  salmon: [250, 128, 114],\n  sandybrown: [244, 164, 96],\n  seagreen: [46, 139, 87],\n  seashell: [255, 245, 238],\n  sienna: [160, 82, 45],\n  silver: [192, 192, 192],\n  skyblue: [135, 206, 235],\n  slateblue: [106, 90, 205],\n  slategray: [112, 128, 144],\n  slategrey: [112, 128, 144],\n  snow: [255, 250, 250],\n  springgreen: [0, 255, 127],\n  steelblue: [70, 130, 180],\n  tan: [210, 180, 140],\n  teal: [0, 128, 128],\n  thistle: [216, 191, 216],\n  tomato: [255, 99, 71],\n  turquoise: [64, 224, 208],\n  violet: [238, 130, 238],\n  wheat: [245, 222, 179],\n  white: [255, 255, 255],\n  whitesmoke: [245, 245, 245],\n  yellow: [255, 255, 0],\n  yellowgreen: [154, 205, 50]\n};\nlet cx, cy, px, py, sx, sy;\ncx = cy = px = py = sx = sy = 0;\nconst parameters = {\n  A: 7,\n  a: 7,\n  C: 6,\n  c: 6,\n  H: 1,\n  h: 1,\n  L: 2,\n  l: 2,\n  M: 2,\n  m: 2,\n  Q: 4,\n  q: 4,\n  S: 4,\n  s: 4,\n  T: 2,\n  t: 2,\n  V: 1,\n  v: 1,\n  Z: 0,\n  z: 0\n};\nconst parse = function (path) {\n  let cmd;\n  const ret = [];\n  let args = [];\n  let curArg = '';\n  let foundDecimal = false;\n  let params = 0;\n  for (let c of path) {\n    if (parameters[c] != null) {\n      params = parameters[c];\n      if (cmd) {\n        // save existing command\n        if (curArg.length > 0) {\n          args[args.length] = +curArg;\n        }\n        ret[ret.length] = {\n          cmd,\n          args\n        };\n        args = [];\n        curArg = '';\n        foundDecimal = false;\n      }\n      cmd = c;\n    } else if ([' ', ','].includes(c) || c === '-' && curArg.length > 0 && curArg[curArg.length - 1] !== 'e' || c === '.' && foundDecimal) {\n      if (curArg.length === 0) {\n        continue;\n      }\n      if (args.length === params) {\n        // handle reused commands\n        ret[ret.length] = {\n          cmd,\n          args\n        };\n        args = [+curArg];\n\n        // handle assumed commands\n        if (cmd === 'M') {\n          cmd = 'L';\n        }\n        if (cmd === 'm') {\n          cmd = 'l';\n        }\n      } else {\n        args[args.length] = +curArg;\n      }\n      foundDecimal = c === '.';\n\n      // fix for negative numbers or repeated decimals with no delimeter between commands\n      curArg = ['-', '.'].includes(c) ? c : '';\n    } else {\n      curArg += c;\n      if (c === '.') {\n        foundDecimal = true;\n      }\n    }\n  }\n\n  // add the last command\n  if (curArg.length > 0) {\n    if (args.length === params) {\n      // handle reused commands\n      ret[ret.length] = {\n        cmd,\n        args\n      };\n      args = [+curArg];\n\n      // handle assumed commands\n      if (cmd === 'M') {\n        cmd = 'L';\n      }\n      if (cmd === 'm') {\n        cmd = 'l';\n      }\n    } else {\n      args[args.length] = +curArg;\n    }\n  }\n  ret[ret.length] = {\n    cmd,\n    args\n  };\n  return ret;\n};\nconst apply = function (commands, doc) {\n  // current point, control point, and subpath starting point\n  cx = cy = px = py = sx = sy = 0;\n\n  // run the commands\n  for (let i = 0; i < commands.length; i++) {\n    const c = commands[i];\n    if (typeof runners[c.cmd] === 'function') {\n      runners[c.cmd](doc, c.args);\n    }\n  }\n};\nconst runners = {\n  M(doc, a) {\n    cx = a[0];\n    cy = a[1];\n    px = py = null;\n    sx = cx;\n    sy = cy;\n    return doc.moveTo(cx, cy);\n  },\n  m(doc, a) {\n    cx += a[0];\n    cy += a[1];\n    px = py = null;\n    sx = cx;\n    sy = cy;\n    return doc.moveTo(cx, cy);\n  },\n  C(doc, a) {\n    cx = a[4];\n    cy = a[5];\n    px = a[2];\n    py = a[3];\n    return doc.bezierCurveTo(...a);\n  },\n  c(doc, a) {\n    doc.bezierCurveTo(a[0] + cx, a[1] + cy, a[2] + cx, a[3] + cy, a[4] + cx, a[5] + cy);\n    px = cx + a[2];\n    py = cy + a[3];\n    cx += a[4];\n    return cy += a[5];\n  },\n  S(doc, a) {\n    if (px === null) {\n      px = cx;\n      py = cy;\n    }\n    doc.bezierCurveTo(cx - (px - cx), cy - (py - cy), a[0], a[1], a[2], a[3]);\n    px = a[0];\n    py = a[1];\n    cx = a[2];\n    return cy = a[3];\n  },\n  s(doc, a) {\n    if (px === null) {\n      px = cx;\n      py = cy;\n    }\n    doc.bezierCurveTo(cx - (px - cx), cy - (py - cy), cx + a[0], cy + a[1], cx + a[2], cy + a[3]);\n    px = cx + a[0];\n    py = cy + a[1];\n    cx += a[2];\n    return cy += a[3];\n  },\n  Q(doc, a) {\n    px = a[0];\n    py = a[1];\n    cx = a[2];\n    cy = a[3];\n    return doc.quadraticCurveTo(a[0], a[1], cx, cy);\n  },\n  q(doc, a) {\n    doc.quadraticCurveTo(a[0] + cx, a[1] + cy, a[2] + cx, a[3] + cy);\n    px = cx + a[0];\n    py = cy + a[1];\n    cx += a[2];\n    return cy += a[3];\n  },\n  T(doc, a) {\n    if (px === null) {\n      px = cx;\n      py = cy;\n    } else {\n      px = cx - (px - cx);\n      py = cy - (py - cy);\n    }\n    doc.quadraticCurveTo(px, py, a[0], a[1]);\n    px = cx - (px - cx);\n    py = cy - (py - cy);\n    cx = a[0];\n    return cy = a[1];\n  },\n  t(doc, a) {\n    if (px === null) {\n      px = cx;\n      py = cy;\n    } else {\n      px = cx - (px - cx);\n      py = cy - (py - cy);\n    }\n    doc.quadraticCurveTo(px, py, cx + a[0], cy + a[1]);\n    cx += a[0];\n    return cy += a[1];\n  },\n  A(doc, a) {\n    solveArc(doc, cx, cy, a);\n    cx = a[5];\n    return cy = a[6];\n  },\n  a(doc, a) {\n    a[5] += cx;\n    a[6] += cy;\n    solveArc(doc, cx, cy, a);\n    cx = a[5];\n    return cy = a[6];\n  },\n  L(doc, a) {\n    cx = a[0];\n    cy = a[1];\n    px = py = null;\n    return doc.lineTo(cx, cy);\n  },\n  l(doc, a) {\n    cx += a[0];\n    cy += a[1];\n    px = py = null;\n    return doc.lineTo(cx, cy);\n  },\n  H(doc, a) {\n    cx = a[0];\n    px = py = null;\n    return doc.lineTo(cx, cy);\n  },\n  h(doc, a) {\n    cx += a[0];\n    px = py = null;\n    return doc.lineTo(cx, cy);\n  },\n  V(doc, a) {\n    cy = a[0];\n    px = py = null;\n    return doc.lineTo(cx, cy);\n  },\n  v(doc, a) {\n    cy += a[0];\n    px = py = null;\n    return doc.lineTo(cx, cy);\n  },\n  Z(doc) {\n    doc.closePath();\n    cx = sx;\n    return cy = sy;\n  },\n  z(doc) {\n    doc.closePath();\n    cx = sx;\n    return cy = sy;\n  }\n};\nconst solveArc = function (doc, x, y, coords) {\n  const [rx, ry, rot, large, sweep, ex, ey] = coords;\n  const segs = arcToSegments(ex, ey, rx, ry, large, sweep, rot, x, y);\n  for (let seg of segs) {\n    const bez = segmentToBezier(...seg);\n    doc.bezierCurveTo(...bez);\n  }\n};\n\n// from Inkscape svgtopdf, thanks!\nconst arcToSegments = function (x, y, rx, ry, large, sweep, rotateX, ox, oy) {\n  const th = rotateX * (Math.PI / 180);\n  const sin_th = Math.sin(th);\n  const cos_th = Math.cos(th);\n  rx = Math.abs(rx);\n  ry = Math.abs(ry);\n  px = cos_th * (ox - x) * 0.5 + sin_th * (oy - y) * 0.5;\n  py = cos_th * (oy - y) * 0.5 - sin_th * (ox - x) * 0.5;\n  let pl = px * px / (rx * rx) + py * py / (ry * ry);\n  if (pl > 1) {\n    pl = Math.sqrt(pl);\n    rx *= pl;\n    ry *= pl;\n  }\n  const a00 = cos_th / rx;\n  const a01 = sin_th / rx;\n  const a10 = -sin_th / ry;\n  const a11 = cos_th / ry;\n  const x0 = a00 * ox + a01 * oy;\n  const y0 = a10 * ox + a11 * oy;\n  const x1 = a00 * x + a01 * y;\n  const y1 = a10 * x + a11 * y;\n  const d = (x1 - x0) * (x1 - x0) + (y1 - y0) * (y1 - y0);\n  let sfactor_sq = 1 / d - 0.25;\n  if (sfactor_sq < 0) {\n    sfactor_sq = 0;\n  }\n  let sfactor = Math.sqrt(sfactor_sq);\n  if (sweep === large) {\n    sfactor = -sfactor;\n  }\n  const xc = 0.5 * (x0 + x1) - sfactor * (y1 - y0);\n  const yc = 0.5 * (y0 + y1) + sfactor * (x1 - x0);\n  const th0 = Math.atan2(y0 - yc, x0 - xc);\n  const th1 = Math.atan2(y1 - yc, x1 - xc);\n  let th_arc = th1 - th0;\n  if (th_arc < 0 && sweep === 1) {\n    th_arc += 2 * Math.PI;\n  } else if (th_arc > 0 && sweep === 0) {\n    th_arc -= 2 * Math.PI;\n  }\n  const segments = Math.ceil(Math.abs(th_arc / (Math.PI * 0.5 + 0.001)));\n  const result = [];\n  for (let i = 0; i < segments; i++) {\n    const th2 = th0 + i * th_arc / segments;\n    const th3 = th0 + (i + 1) * th_arc / segments;\n    result[i] = [xc, yc, th2, th3, rx, ry, sin_th, cos_th];\n  }\n  return result;\n};\nconst segmentToBezier = function (cx, cy, th0, th1, rx, ry, sin_th, cos_th) {\n  const a00 = cos_th * rx;\n  const a01 = -sin_th * ry;\n  const a10 = sin_th * rx;\n  const a11 = cos_th * ry;\n  const th_half = 0.5 * (th1 - th0);\n  const t = 8 / 3 * Math.sin(th_half * 0.5) * Math.sin(th_half * 0.5) / Math.sin(th_half);\n  const x1 = cx + Math.cos(th0) - t * Math.sin(th0);\n  const y1 = cy + Math.sin(th0) + t * Math.cos(th0);\n  const x3 = cx + Math.cos(th1);\n  const y3 = cy + Math.sin(th1);\n  const x2 = x3 + t * Math.sin(th1);\n  const y2 = y3 - t * Math.cos(th1);\n  return [a00 * x1 + a01 * y1, a10 * x1 + a11 * y1, a00 * x2 + a01 * y2, a10 * x2 + a11 * y2, a00 * x3 + a01 * y3, a10 * x3 + a11 * y3];\n};\nclass SVGPath {\n  static apply(doc, path) {\n    const commands = parse(path);\n    apply(commands, doc);\n  }\n}\nconst {\n  number: number$1\n} = PDFObject;\n\n// This constant is used to approximate a symmetrical arc using a cubic\n// Bezier curve.\nconst KAPPA = 4.0 * ((Math.sqrt(2) - 1.0) / 3.0);\nvar VectorMixin = {\n  initVector() {\n    this._ctm = [1, 0, 0, 1, 0, 0]; // current transformation matrix\n    return this._ctmStack = [];\n  },\n  save() {\n    this._ctmStack.push(this._ctm.slice());\n    // TODO: save/restore colorspace and styles so not setting it unnessesarily all the time?\n    return this.addContent('q');\n  },\n  restore() {\n    this._ctm = this._ctmStack.pop() || [1, 0, 0, 1, 0, 0];\n    return this.addContent('Q');\n  },\n  closePath() {\n    return this.addContent('h');\n  },\n  lineWidth(w) {\n    return this.addContent(`${number$1(w)} w`);\n  },\n  _CAP_STYLES: {\n    BUTT: 0,\n    ROUND: 1,\n    SQUARE: 2\n  },\n  lineCap(c) {\n    if (typeof c === 'string') {\n      c = this._CAP_STYLES[c.toUpperCase()];\n    }\n    return this.addContent(`${c} J`);\n  },\n  _JOIN_STYLES: {\n    MITER: 0,\n    ROUND: 1,\n    BEVEL: 2\n  },\n  lineJoin(j) {\n    if (typeof j === 'string') {\n      j = this._JOIN_STYLES[j.toUpperCase()];\n    }\n    return this.addContent(`${j} j`);\n  },\n  miterLimit(m) {\n    return this.addContent(`${number$1(m)} M`);\n  },\n  dash(length) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const originalLength = length;\n    if (!Array.isArray(length)) {\n      length = [length, options.space || length];\n    }\n    const valid = length.every(x => Number.isFinite(x) && x > 0);\n    if (!valid) {\n      throw new Error(`dash(${JSON.stringify(originalLength)}, ${JSON.stringify(options)}) invalid, lengths must be numeric and greater than zero`);\n    }\n    length = length.map(number$1).join(' ');\n    return this.addContent(`[${length}] ${number$1(options.phase || 0)} d`);\n  },\n  undash() {\n    return this.addContent('[] 0 d');\n  },\n  moveTo(x, y) {\n    return this.addContent(`${number$1(x)} ${number$1(y)} m`);\n  },\n  lineTo(x, y) {\n    return this.addContent(`${number$1(x)} ${number$1(y)} l`);\n  },\n  bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y) {\n    return this.addContent(`${number$1(cp1x)} ${number$1(cp1y)} ${number$1(cp2x)} ${number$1(cp2y)} ${number$1(x)} ${number$1(y)} c`);\n  },\n  quadraticCurveTo(cpx, cpy, x, y) {\n    return this.addContent(`${number$1(cpx)} ${number$1(cpy)} ${number$1(x)} ${number$1(y)} v`);\n  },\n  rect(x, y, w, h) {\n    return this.addContent(`${number$1(x)} ${number$1(y)} ${number$1(w)} ${number$1(h)} re`);\n  },\n  roundedRect(x, y, w, h, r) {\n    if (r == null) {\n      r = 0;\n    }\n    r = Math.min(r, 0.5 * w, 0.5 * h);\n\n    // amount to inset control points from corners (see `ellipse`)\n    const c = r * (1.0 - KAPPA);\n    this.moveTo(x + r, y);\n    this.lineTo(x + w - r, y);\n    this.bezierCurveTo(x + w - c, y, x + w, y + c, x + w, y + r);\n    this.lineTo(x + w, y + h - r);\n    this.bezierCurveTo(x + w, y + h - c, x + w - c, y + h, x + w - r, y + h);\n    this.lineTo(x + r, y + h);\n    this.bezierCurveTo(x + c, y + h, x, y + h - c, x, y + h - r);\n    this.lineTo(x, y + r);\n    this.bezierCurveTo(x, y + c, x + c, y, x + r, y);\n    return this.closePath();\n  },\n  ellipse(x, y, r1, r2) {\n    // based on http://stackoverflow.com/questions/2172798/how-to-draw-an-oval-in-html5-canvas/2173084#2173084\n    if (r2 == null) {\n      r2 = r1;\n    }\n    x -= r1;\n    y -= r2;\n    const ox = r1 * KAPPA;\n    const oy = r2 * KAPPA;\n    const xe = x + r1 * 2;\n    const ye = y + r2 * 2;\n    const xm = x + r1;\n    const ym = y + r2;\n    this.moveTo(x, ym);\n    this.bezierCurveTo(x, ym - oy, xm - ox, y, xm, y);\n    this.bezierCurveTo(xm + ox, y, xe, ym - oy, xe, ym);\n    this.bezierCurveTo(xe, ym + oy, xm + ox, ye, xm, ye);\n    this.bezierCurveTo(xm - ox, ye, x, ym + oy, x, ym);\n    return this.closePath();\n  },\n  circle(x, y, radius) {\n    return this.ellipse(x, y, radius);\n  },\n  arc(x, y, radius, startAngle, endAngle, anticlockwise) {\n    if (anticlockwise == null) {\n      anticlockwise = false;\n    }\n    const TWO_PI = 2.0 * Math.PI;\n    const HALF_PI = 0.5 * Math.PI;\n    let deltaAng = endAngle - startAngle;\n    if (Math.abs(deltaAng) > TWO_PI) {\n      // draw only full circle if more than that is specified\n      deltaAng = TWO_PI;\n    } else if (deltaAng !== 0 && anticlockwise !== deltaAng < 0) {\n      // necessary to flip direction of rendering\n      const dir = anticlockwise ? -1 : 1;\n      deltaAng = dir * TWO_PI + deltaAng;\n    }\n    const numSegs = Math.ceil(Math.abs(deltaAng) / HALF_PI);\n    const segAng = deltaAng / numSegs;\n    const handleLen = segAng / HALF_PI * KAPPA * radius;\n    let curAng = startAngle;\n\n    // component distances between anchor point and control point\n    let deltaCx = -Math.sin(curAng) * handleLen;\n    let deltaCy = Math.cos(curAng) * handleLen;\n\n    // anchor point\n    let ax = x + Math.cos(curAng) * radius;\n    let ay = y + Math.sin(curAng) * radius;\n\n    // calculate and render segments\n    this.moveTo(ax, ay);\n    for (let segIdx = 0; segIdx < numSegs; segIdx++) {\n      // starting control point\n      const cp1x = ax + deltaCx;\n      const cp1y = ay + deltaCy;\n\n      // step angle\n      curAng += segAng;\n\n      // next anchor point\n      ax = x + Math.cos(curAng) * radius;\n      ay = y + Math.sin(curAng) * radius;\n\n      // next control point delta\n      deltaCx = -Math.sin(curAng) * handleLen;\n      deltaCy = Math.cos(curAng) * handleLen;\n\n      // ending control point\n      const cp2x = ax - deltaCx;\n      const cp2y = ay - deltaCy;\n\n      // render segment\n      this.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, ax, ay);\n    }\n    return this;\n  },\n  polygon() {\n    for (var _len = arguments.length, points = new Array(_len), _key = 0; _key < _len; _key++) {\n      points[_key] = arguments[_key];\n    }\n    this.moveTo(...(points.shift() || []));\n    for (let point of points) {\n      this.lineTo(...(point || []));\n    }\n    return this.closePath();\n  },\n  path(path) {\n    SVGPath.apply(this, path);\n    return this;\n  },\n  _windingRule(rule) {\n    if (/even-?odd/.test(rule)) {\n      return '*';\n    }\n    return '';\n  },\n  fill(color, rule) {\n    if (/(even-?odd)|(non-?zero)/.test(color)) {\n      rule = color;\n      color = null;\n    }\n    if (color) {\n      this.fillColor(color);\n    }\n    return this.addContent(`f${this._windingRule(rule)}`);\n  },\n  stroke(color) {\n    if (color) {\n      this.strokeColor(color);\n    }\n    return this.addContent('S');\n  },\n  fillAndStroke(fillColor, strokeColor, rule) {\n    if (strokeColor == null) {\n      strokeColor = fillColor;\n    }\n    const isFillRule = /(even-?odd)|(non-?zero)/;\n    if (isFillRule.test(fillColor)) {\n      rule = fillColor;\n      fillColor = null;\n    }\n    if (isFillRule.test(strokeColor)) {\n      rule = strokeColor;\n      strokeColor = fillColor;\n    }\n    if (fillColor) {\n      this.fillColor(fillColor);\n      this.strokeColor(strokeColor);\n    }\n    return this.addContent(`B${this._windingRule(rule)}`);\n  },\n  clip(rule) {\n    return this.addContent(`W${this._windingRule(rule)} n`);\n  },\n  transform(m11, m12, m21, m22, dx, dy) {\n    // keep track of the current transformation matrix\n    if (m11 === 1 && m12 === 0 && m21 === 0 && m22 === 1 && dx === 0 && dy === 0) {\n      // Ignore identity transforms\n      return this;\n    }\n    const m = this._ctm;\n    const [m0, m1, m2, m3, m4, m5] = m;\n    m[0] = m0 * m11 + m2 * m12;\n    m[1] = m1 * m11 + m3 * m12;\n    m[2] = m0 * m21 + m2 * m22;\n    m[3] = m1 * m21 + m3 * m22;\n    m[4] = m0 * dx + m2 * dy + m4;\n    m[5] = m1 * dx + m3 * dy + m5;\n    const values = [m11, m12, m21, m22, dx, dy].map(v => number$1(v)).join(' ');\n    return this.addContent(`${values} cm`);\n  },\n  translate(x, y) {\n    return this.transform(1, 0, 0, 1, x, y);\n  },\n  rotate(angle) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    let y;\n    const rad = angle * Math.PI / 180;\n    const cos = Math.cos(rad);\n    const sin = Math.sin(rad);\n    let x = y = 0;\n    if (options.origin != null) {\n      [x, y] = options.origin;\n      const x1 = x * cos - y * sin;\n      const y1 = x * sin + y * cos;\n      x -= x1;\n      y -= y1;\n    }\n    return this.transform(cos, sin, -sin, cos, x, y);\n  },\n  scale(xFactor, yFactor) {\n    let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    let y;\n    if (yFactor == null) {\n      yFactor = xFactor;\n    }\n    if (typeof yFactor === 'object') {\n      options = yFactor;\n      yFactor = xFactor;\n    }\n    let x = y = 0;\n    if (options.origin != null) {\n      [x, y] = options.origin;\n      x -= xFactor * x;\n      y -= yFactor * y;\n    }\n    return this.transform(xFactor, 0, 0, yFactor, x, y);\n  }\n};\nconst WIN_ANSI_MAP = {\n  402: 131,\n  8211: 150,\n  8212: 151,\n  8216: 145,\n  8217: 146,\n  8218: 130,\n  8220: 147,\n  8221: 148,\n  8222: 132,\n  8224: 134,\n  8225: 135,\n  8226: 149,\n  8230: 133,\n  8364: 128,\n  8240: 137,\n  8249: 139,\n  8250: 155,\n  710: 136,\n  8482: 153,\n  338: 140,\n  339: 156,\n  732: 152,\n  352: 138,\n  353: 154,\n  376: 159,\n  381: 142,\n  382: 158\n};\nconst characters = `\\\n.notdef       .notdef        .notdef        .notdef\n.notdef       .notdef        .notdef        .notdef\n.notdef       .notdef        .notdef        .notdef\n.notdef       .notdef        .notdef        .notdef\n.notdef       .notdef        .notdef        .notdef\n.notdef       .notdef        .notdef        .notdef\n.notdef       .notdef        .notdef        .notdef\n.notdef       .notdef        .notdef        .notdef\n  \nspace         exclam         quotedbl       numbersign\ndollar        percent        ampersand      quotesingle\nparenleft     parenright     asterisk       plus\ncomma         hyphen         period         slash\nzero          one            two            three\nfour          five           six            seven\neight         nine           colon          semicolon\nless          equal          greater        question\n  \nat            A              B              C\nD             E              F              G\nH             I              J              K\nL             M              N              O\nP             Q              R              S\nT             U              V              W\nX             Y              Z              bracketleft\nbackslash     bracketright   asciicircum    underscore\n  \ngrave         a              b              c\nd             e              f              g\nh             i              j              k\nl             m              n              o\np             q              r              s\nt             u              v              w\nx             y              z              braceleft\nbar           braceright     asciitilde     .notdef\n  \nEuro          .notdef        quotesinglbase florin\nquotedblbase  ellipsis       dagger         daggerdbl\ncircumflex    perthousand    Scaron         guilsinglleft\nOE            .notdef        Zcaron         .notdef\n.notdef       quoteleft      quoteright     quotedblleft\nquotedblright bullet         endash         emdash\ntilde         trademark      scaron         guilsinglright\noe            .notdef        zcaron         ydieresis\n  \nspace         exclamdown     cent           sterling\ncurrency      yen            brokenbar      section\ndieresis      copyright      ordfeminine    guillemotleft\nlogicalnot    hyphen         registered     macron\ndegree        plusminus      twosuperior    threesuperior\nacute         mu             paragraph      periodcentered\ncedilla       onesuperior    ordmasculine   guillemotright\nonequarter    onehalf        threequarters  questiondown\n  \nAgrave        Aacute         Acircumflex    Atilde\nAdieresis     Aring          AE             Ccedilla\nEgrave        Eacute         Ecircumflex    Edieresis\nIgrave        Iacute         Icircumflex    Idieresis\nEth           Ntilde         Ograve         Oacute\nOcircumflex   Otilde         Odieresis      multiply\nOslash        Ugrave         Uacute         Ucircumflex\nUdieresis     Yacute         Thorn          germandbls\n  \nagrave        aacute         acircumflex    atilde\nadieresis     aring          ae             ccedilla\negrave        eacute         ecircumflex    edieresis\nigrave        iacute         icircumflex    idieresis\neth           ntilde         ograve         oacute\nocircumflex   otilde         odieresis      divide\noslash        ugrave         uacute         ucircumflex\nudieresis     yacute         thorn          ydieresis\\\n`.split(/\\s+/);\nclass AFMFont {\n  static open(filename) {\n    return new AFMFont(fs.readFileSync(filename, 'utf8'));\n  }\n  constructor(contents) {\n    this.contents = contents;\n    this.attributes = {};\n    this.glyphWidths = {};\n    this.boundingBoxes = {};\n    this.kernPairs = {};\n    this.parse();\n    // todo: remove charWidths since appears to not be used\n    this.charWidths = new Array(256);\n    for (let char = 0; char <= 255; char++) {\n      this.charWidths[char] = this.glyphWidths[characters[char]];\n    }\n    this.bbox = this.attributes['FontBBox'].split(/\\s+/).map(e => +e);\n    this.ascender = +(this.attributes['Ascender'] || 0);\n    this.descender = +(this.attributes['Descender'] || 0);\n    this.xHeight = +(this.attributes['XHeight'] || 0);\n    this.capHeight = +(this.attributes['CapHeight'] || 0);\n    this.lineGap = this.bbox[3] - this.bbox[1] - (this.ascender - this.descender);\n  }\n  parse() {\n    let section = '';\n    for (let line of this.contents.split('\\n')) {\n      var match;\n      var a;\n      if (match = line.match(/^Start(\\w+)/)) {\n        section = match[1];\n        continue;\n      } else if (match = line.match(/^End(\\w+)/)) {\n        section = '';\n        continue;\n      }\n      switch (section) {\n        case 'FontMetrics':\n          match = line.match(/(^\\w+)\\s+(.*)/);\n          var key = match[1];\n          var value = match[2];\n          if (a = this.attributes[key]) {\n            if (!Array.isArray(a)) {\n              a = this.attributes[key] = [a];\n            }\n            a.push(value);\n          } else {\n            this.attributes[key] = value;\n          }\n          break;\n        case 'CharMetrics':\n          if (!/^CH?\\s/.test(line)) {\n            continue;\n          }\n          var name = line.match(/\\bN\\s+(\\.?\\w+)\\s*;/)[1];\n          this.glyphWidths[name] = +line.match(/\\bWX\\s+(\\d+)\\s*;/)[1];\n          break;\n        case 'KernPairs':\n          match = line.match(/^KPX\\s+(\\.?\\w+)\\s+(\\.?\\w+)\\s+(-?\\d+)/);\n          if (match) {\n            this.kernPairs[match[1] + '\\0' + match[2]] = parseInt(match[3]);\n          }\n          break;\n      }\n    }\n  }\n  encodeText(text) {\n    const res = [];\n    for (let i = 0, len = text.length; i < len; i++) {\n      let char = text.charCodeAt(i);\n      char = WIN_ANSI_MAP[char] || char;\n      res.push(char.toString(16));\n    }\n    return res;\n  }\n  glyphsForString(string) {\n    const glyphs = [];\n    for (let i = 0, len = string.length; i < len; i++) {\n      const charCode = string.charCodeAt(i);\n      glyphs.push(this.characterToGlyph(charCode));\n    }\n    return glyphs;\n  }\n  characterToGlyph(character) {\n    return characters[WIN_ANSI_MAP[character] || character] || '.notdef';\n  }\n  widthOfGlyph(glyph) {\n    return this.glyphWidths[glyph] || 0;\n  }\n  getKernPair(left, right) {\n    return this.kernPairs[left + '\\0' + right] || 0;\n  }\n  advancesForGlyphs(glyphs) {\n    const advances = [];\n    for (let index = 0; index < glyphs.length; index++) {\n      const left = glyphs[index];\n      const right = glyphs[index + 1];\n      advances.push(this.widthOfGlyph(left) + this.getKernPair(left, right));\n    }\n    return advances;\n  }\n}\nclass PDFFont {\n  constructor() {}\n  encode() {\n    throw new Error('Must be implemented by subclasses');\n  }\n  widthOfString() {\n    throw new Error('Must be implemented by subclasses');\n  }\n  ref() {\n    return this.dictionary != null ? this.dictionary : this.dictionary = this.document.ref();\n  }\n  finalize() {\n    if (this.embedded || this.dictionary == null) {\n      return;\n    }\n    this.embed();\n    return this.embedded = true;\n  }\n  embed() {\n    throw new Error('Must be implemented by subclasses');\n  }\n  lineHeight(size, includeGap) {\n    if (includeGap == null) {\n      includeGap = false;\n    }\n    const gap = includeGap ? this.lineGap : 0;\n    return (this.ascender + gap - this.descender) / 1000 * size;\n  }\n}\n\n// This insanity is so bundlers can inline the font files\nconst STANDARD_FONTS = {\n  Courier() {\n    return fs.readFileSync(__dirname + '/data/Courier.afm', 'utf8');\n  },\n  'Courier-Bold'() {\n    return fs.readFileSync(__dirname + '/data/Courier-Bold.afm', 'utf8');\n  },\n  'Courier-Oblique'() {\n    return fs.readFileSync(__dirname + '/data/Courier-Oblique.afm', 'utf8');\n  },\n  'Courier-BoldOblique'() {\n    return fs.readFileSync(__dirname + '/data/Courier-BoldOblique.afm', 'utf8');\n  },\n  Helvetica() {\n    return fs.readFileSync(__dirname + '/data/Helvetica.afm', 'utf8');\n  },\n  'Helvetica-Bold'() {\n    return fs.readFileSync(__dirname + '/data/Helvetica-Bold.afm', 'utf8');\n  },\n  'Helvetica-Oblique'() {\n    return fs.readFileSync(__dirname + '/data/Helvetica-Oblique.afm', 'utf8');\n  },\n  'Helvetica-BoldOblique'() {\n    return fs.readFileSync(__dirname + '/data/Helvetica-BoldOblique.afm', 'utf8');\n  },\n  'Times-Roman'() {\n    return fs.readFileSync(__dirname + '/data/Times-Roman.afm', 'utf8');\n  },\n  'Times-Bold'() {\n    return fs.readFileSync(__dirname + '/data/Times-Bold.afm', 'utf8');\n  },\n  'Times-Italic'() {\n    return fs.readFileSync(__dirname + '/data/Times-Italic.afm', 'utf8');\n  },\n  'Times-BoldItalic'() {\n    return fs.readFileSync(__dirname + '/data/Times-BoldItalic.afm', 'utf8');\n  },\n  Symbol() {\n    return fs.readFileSync(__dirname + '/data/Symbol.afm', 'utf8');\n  },\n  ZapfDingbats() {\n    return fs.readFileSync(__dirname + '/data/ZapfDingbats.afm', 'utf8');\n  }\n};\nclass StandardFont extends PDFFont {\n  constructor(document, name, id) {\n    super();\n    this.document = document;\n    this.name = name;\n    this.id = id;\n    this.font = new AFMFont(STANDARD_FONTS[this.name]());\n    ({\n      ascender: this.ascender,\n      descender: this.descender,\n      bbox: this.bbox,\n      lineGap: this.lineGap,\n      xHeight: this.xHeight,\n      capHeight: this.capHeight\n    } = this.font);\n  }\n  embed() {\n    this.dictionary.data = {\n      Type: 'Font',\n      BaseFont: this.name,\n      Subtype: 'Type1',\n      Encoding: 'WinAnsiEncoding'\n    };\n    return this.dictionary.end();\n  }\n  encode(text) {\n    const encoded = this.font.encodeText(text);\n    const glyphs = this.font.glyphsForString(`${text}`);\n    const advances = this.font.advancesForGlyphs(glyphs);\n    const positions = [];\n    for (let i = 0; i < glyphs.length; i++) {\n      const glyph = glyphs[i];\n      positions.push({\n        xAdvance: advances[i],\n        yAdvance: 0,\n        xOffset: 0,\n        yOffset: 0,\n        advanceWidth: this.font.widthOfGlyph(glyph)\n      });\n    }\n    return [encoded, positions];\n  }\n  widthOfString(string, size) {\n    const glyphs = this.font.glyphsForString(`${string}`);\n    const advances = this.font.advancesForGlyphs(glyphs);\n    let width = 0;\n    for (let advance of advances) {\n      width += advance;\n    }\n    const scale = size / 1000;\n    return width * scale;\n  }\n  static isStandardFont(name) {\n    return name in STANDARD_FONTS;\n  }\n}\nconst toHex = function (num) {\n  return `0000${num.toString(16)}`.slice(-4);\n};\nclass EmbeddedFont extends PDFFont {\n  constructor(document, font, id) {\n    super();\n    this.document = document;\n    this.font = font;\n    this.id = id;\n    this.subset = this.font.createSubset();\n    this.unicode = [[0]];\n    this.widths = [this.font.getGlyph(0).advanceWidth];\n    this.name = this.font.postscriptName;\n    this.scale = 1000 / this.font.unitsPerEm;\n    this.ascender = this.font.ascent * this.scale;\n    this.descender = this.font.descent * this.scale;\n    this.xHeight = this.font.xHeight * this.scale;\n    this.capHeight = this.font.capHeight * this.scale;\n    this.lineGap = this.font.lineGap * this.scale;\n    this.bbox = this.font.bbox;\n    if (document.options.fontLayoutCache !== false) {\n      this.layoutCache = Object.create(null);\n    }\n  }\n  layoutRun(text, features) {\n    const run = this.font.layout(text, features);\n\n    // Normalize position values\n    for (let i = 0; i < run.positions.length; i++) {\n      const position = run.positions[i];\n      for (let key in position) {\n        position[key] *= this.scale;\n      }\n      position.advanceWidth = run.glyphs[i].advanceWidth * this.scale;\n    }\n    return run;\n  }\n  layoutCached(text) {\n    if (!this.layoutCache) {\n      return this.layoutRun(text);\n    }\n    let cached;\n    if (cached = this.layoutCache[text]) {\n      return cached;\n    }\n    const run = this.layoutRun(text);\n    this.layoutCache[text] = run;\n    return run;\n  }\n  layout(text, features, onlyWidth) {\n    // Skip the cache if any user defined features are applied\n    if (features) {\n      return this.layoutRun(text, features);\n    }\n    let glyphs = onlyWidth ? null : [];\n    let positions = onlyWidth ? null : [];\n    let advanceWidth = 0;\n\n    // Split the string by words to increase cache efficiency.\n    // For this purpose, spaces and tabs are a good enough delimeter.\n    let last = 0;\n    let index = 0;\n    while (index <= text.length) {\n      var needle;\n      if (index === text.length && last < index || (needle = text.charAt(index), [' ', '\\t'].includes(needle))) {\n        const run = this.layoutCached(text.slice(last, ++index));\n        if (!onlyWidth) {\n          glyphs = glyphs.concat(run.glyphs);\n          positions = positions.concat(run.positions);\n        }\n        advanceWidth += run.advanceWidth;\n        last = index;\n      } else {\n        index++;\n      }\n    }\n    return {\n      glyphs,\n      positions,\n      advanceWidth\n    };\n  }\n  encode(text, features) {\n    const {\n      glyphs,\n      positions\n    } = this.layout(text, features);\n    const res = [];\n    for (let i = 0; i < glyphs.length; i++) {\n      const glyph = glyphs[i];\n      const gid = this.subset.includeGlyph(glyph.id);\n      res.push(`0000${gid.toString(16)}`.slice(-4));\n      if (this.widths[gid] == null) {\n        this.widths[gid] = glyph.advanceWidth * this.scale;\n      }\n      if (this.unicode[gid] == null) {\n        this.unicode[gid] = glyph.codePoints;\n      }\n    }\n    return [res, positions];\n  }\n  widthOfString(string, size, features) {\n    const width = this.layout(string, features, true).advanceWidth;\n    const scale = size / 1000;\n    return width * scale;\n  }\n  embed() {\n    const isCFF = this.subset.cff != null;\n    const fontFile = this.document.ref();\n    if (isCFF) {\n      fontFile.data.Subtype = 'CIDFontType0C';\n    }\n    this.subset.encodeStream().on('data', data => fontFile.write(data)).on('end', () => fontFile.end());\n    const familyClass = ((this.font['OS/2'] != null ? this.font['OS/2'].sFamilyClass : undefined) || 0) >> 8;\n    let flags = 0;\n    if (this.font.post.isFixedPitch) {\n      flags |= 1 << 0;\n    }\n    if (1 <= familyClass && familyClass <= 7) {\n      flags |= 1 << 1;\n    }\n    flags |= 1 << 2; // assume the font uses non-latin characters\n    if (familyClass === 10) {\n      flags |= 1 << 3;\n    }\n    if (this.font.head.macStyle.italic) {\n      flags |= 1 << 6;\n    }\n\n    // generate a tag (6 uppercase letters. 17 is the char code offset from '0' to 'A'. 73 will map to 'Z')\n    const tag = [1, 2, 3, 4, 5, 6].map(i => String.fromCharCode((this.id.charCodeAt(i) || 73) + 17)).join('');\n    const name = tag + '+' + this.font.postscriptName;\n    const {\n      bbox\n    } = this.font;\n    const descriptor = this.document.ref({\n      Type: 'FontDescriptor',\n      FontName: name,\n      Flags: flags,\n      FontBBox: [bbox.minX * this.scale, bbox.minY * this.scale, bbox.maxX * this.scale, bbox.maxY * this.scale],\n      ItalicAngle: this.font.italicAngle,\n      Ascent: this.ascender,\n      Descent: this.descender,\n      CapHeight: (this.font.capHeight || this.font.ascent) * this.scale,\n      XHeight: (this.font.xHeight || 0) * this.scale,\n      StemV: 0\n    }); // not sure how to calculate this\n\n    if (isCFF) {\n      descriptor.data.FontFile3 = fontFile;\n    } else {\n      descriptor.data.FontFile2 = fontFile;\n    }\n    if (this.document.subset) {\n      const CIDSet = Buffer.from('FFFFFFFFC0', 'hex');\n      const CIDSetRef = this.document.ref();\n      CIDSetRef.write(CIDSet);\n      CIDSetRef.end();\n      descriptor.data.CIDSet = CIDSetRef;\n    }\n    descriptor.end();\n    const descendantFontData = {\n      Type: 'Font',\n      Subtype: 'CIDFontType0',\n      BaseFont: name,\n      CIDSystemInfo: {\n        Registry: new String('Adobe'),\n        Ordering: new String('Identity'),\n        Supplement: 0\n      },\n      FontDescriptor: descriptor,\n      W: [0, this.widths]\n    };\n    if (!isCFF) {\n      descendantFontData.Subtype = 'CIDFontType2';\n      descendantFontData.CIDToGIDMap = 'Identity';\n    }\n    const descendantFont = this.document.ref(descendantFontData);\n    descendantFont.end();\n    this.dictionary.data = {\n      Type: 'Font',\n      Subtype: 'Type0',\n      BaseFont: name,\n      Encoding: 'Identity-H',\n      DescendantFonts: [descendantFont],\n      ToUnicode: this.toUnicodeCmap()\n    };\n    return this.dictionary.end();\n  }\n\n  // Maps the glyph ids encoded in the PDF back to unicode strings\n  // Because of ligature substitutions and the like, there may be one or more\n  // unicode characters represented by each glyph.\n  toUnicodeCmap() {\n    const cmap = this.document.ref();\n    const entries = [];\n    for (let codePoints of this.unicode) {\n      const encoded = [];\n\n      // encode codePoints to utf16\n      for (let value of codePoints) {\n        if (value > 0xffff) {\n          value -= 0x10000;\n          encoded.push(toHex(value >>> 10 & 0x3ff | 0xd800));\n          value = 0xdc00 | value & 0x3ff;\n        }\n        encoded.push(toHex(value));\n      }\n      entries.push(`<${encoded.join(' ')}>`);\n    }\n    const chunkSize = 256;\n    const chunks = Math.ceil(entries.length / chunkSize);\n    const ranges = [];\n    for (let i = 0; i < chunks; i++) {\n      const start = i * chunkSize;\n      const end = Math.min((i + 1) * chunkSize, entries.length);\n      ranges.push(`<${toHex(start)}> <${toHex(end - 1)}> [${entries.slice(start, end).join(' ')}]`);\n    }\n    cmap.end(`\\\n/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange\n1 beginbfrange\n${ranges.join('\\n')}\nendbfrange\nendcmap\nCMapName currentdict /CMap defineresource pop\nend\nend\\\n`);\n    return cmap;\n  }\n}\nclass PDFFontFactory {\n  static open(document, src, family, id) {\n    let font;\n    if (typeof src === 'string') {\n      if (StandardFont.isStandardFont(src)) {\n        return new StandardFont(document, src, id);\n      }\n      src = fs.readFileSync(src);\n    }\n    if (Buffer.isBuffer(src)) {\n      font = fontkit.create(src, family);\n    } else if (src instanceof Uint8Array) {\n      font = fontkit.create(Buffer.from(src), family);\n    } else if (src instanceof ArrayBuffer) {\n      font = fontkit.create(Buffer.from(new Uint8Array(src)), family);\n    }\n    if (font == null) {\n      throw new Error('Not a supported font format or standard PDF font.');\n    }\n    return new EmbeddedFont(document, font, id);\n  }\n}\nvar FontsMixin = {\n  initFonts() {\n    let defaultFont = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'Helvetica';\n    // Lookup table for embedded fonts\n    this._fontFamilies = {};\n    this._fontCount = 0;\n\n    // Font state\n    this._fontSize = 12;\n    this._font = null;\n    this._registeredFonts = {};\n\n    // Set the default font\n    if (defaultFont) {\n      this.font(defaultFont);\n    }\n  },\n  font(src, family, size) {\n    let cacheKey, font;\n    if (typeof family === 'number') {\n      size = family;\n      family = null;\n    }\n\n    // check registered fonts if src is a string\n    if (typeof src === 'string' && this._registeredFonts[src]) {\n      cacheKey = src;\n      ({\n        src,\n        family\n      } = this._registeredFonts[src]);\n    } else {\n      cacheKey = family || src;\n      if (typeof cacheKey !== 'string') {\n        cacheKey = null;\n      }\n    }\n    if (size != null) {\n      this.fontSize(size);\n    }\n\n    // fast path: check if the font is already in the PDF\n    if (font = this._fontFamilies[cacheKey]) {\n      this._font = font;\n      return this;\n    }\n\n    // load the font\n    const id = `F${++this._fontCount}`;\n    this._font = PDFFontFactory.open(this, src, family, id);\n\n    // check for existing font familes with the same name already in the PDF\n    // useful if the font was passed as a buffer\n    if (font = this._fontFamilies[this._font.name]) {\n      this._font = font;\n      return this;\n    }\n\n    // save the font for reuse later\n    if (cacheKey) {\n      this._fontFamilies[cacheKey] = this._font;\n    }\n    if (this._font.name) {\n      this._fontFamilies[this._font.name] = this._font;\n    }\n    return this;\n  },\n  fontSize(_fontSize) {\n    this._fontSize = _fontSize;\n    return this;\n  },\n  currentLineHeight(includeGap) {\n    if (includeGap == null) {\n      includeGap = false;\n    }\n    return this._font.lineHeight(this._fontSize, includeGap);\n  },\n  registerFont(name, src, family) {\n    this._registeredFonts[name] = {\n      src,\n      family\n    };\n    return this;\n  }\n};\nconst SOFT_HYPHEN = '\\u00AD';\nconst HYPHEN = '-';\nclass LineWrapper extends EventEmitter {\n  constructor(document, options) {\n    super();\n    this.document = document;\n    this.indent = options.indent || 0;\n    this.characterSpacing = options.characterSpacing || 0;\n    this.wordSpacing = options.wordSpacing === 0;\n    this.columns = options.columns || 1;\n    this.columnGap = options.columnGap != null ? options.columnGap : 18; // 1/4 inch\n    this.lineWidth = (options.width - this.columnGap * (this.columns - 1)) / this.columns;\n    this.spaceLeft = this.lineWidth;\n    this.startX = this.document.x;\n    this.startY = this.document.y;\n    this.column = 1;\n    this.ellipsis = options.ellipsis;\n    this.continuedX = 0;\n    this.features = options.features;\n\n    // calculate the maximum Y position the text can appear at\n    if (options.height != null) {\n      this.height = options.height;\n      this.maxY = this.startY + options.height;\n    } else {\n      this.maxY = this.document.page.maxY();\n    }\n\n    // handle paragraph indents\n    this.on('firstLine', options => {\n      // if this is the first line of the text segment, and\n      // we're continuing where we left off, indent that much\n      // otherwise use the user specified indent option\n      const indent = this.continuedX || this.indent;\n      this.document.x += indent;\n      this.lineWidth -= indent;\n      return this.once('line', () => {\n        this.document.x -= indent;\n        this.lineWidth += indent;\n        if (options.continued && !this.continuedX) {\n          this.continuedX = this.indent;\n        }\n        if (!options.continued) {\n          return this.continuedX = 0;\n        }\n      });\n    });\n\n    // handle left aligning last lines of paragraphs\n    this.on('lastLine', options => {\n      const {\n        align\n      } = options;\n      if (align === 'justify') {\n        options.align = 'left';\n      }\n      this.lastLine = true;\n      return this.once('line', () => {\n        this.document.y += options.paragraphGap || 0;\n        options.align = align;\n        return this.lastLine = false;\n      });\n    });\n  }\n  wordWidth(word) {\n    return this.document.widthOfString(word, this) + this.characterSpacing + this.wordSpacing;\n  }\n  canFit(word, w) {\n    if (word[word.length - 1] != SOFT_HYPHEN) {\n      return w <= this.spaceLeft;\n    }\n    return w + this.wordWidth(HYPHEN) <= this.spaceLeft;\n  }\n  eachWord(text, fn) {\n    // setup a unicode line breaker\n    let bk;\n    const breaker = new LineBreaker(text);\n    let last = null;\n    const wordWidths = Object.create(null);\n    while (bk = breaker.nextBreak()) {\n      var shouldContinue;\n      let word = text.slice((last != null ? last.position : undefined) || 0, bk.position);\n      let w = wordWidths[word] != null ? wordWidths[word] : wordWidths[word] = this.wordWidth(word);\n\n      // if the word is longer than the whole line, chop it up\n      // TODO: break by grapheme clusters, not JS string characters\n      if (w > this.lineWidth + this.continuedX) {\n        // make some fake break objects\n        let lbk = last;\n        const fbk = {};\n        while (word.length) {\n          // fit as much of the word as possible into the space we have\n          var l, mightGrow;\n          if (w > this.spaceLeft) {\n            // start our check at the end of our available space - this method is faster than a loop of each character and it resolves\n            // an issue with long loops when processing massive words, such as a huge number of spaces\n            l = Math.ceil(this.spaceLeft / (w / word.length));\n            w = this.wordWidth(word.slice(0, l));\n            mightGrow = w <= this.spaceLeft && l < word.length;\n          } else {\n            l = word.length;\n          }\n          let mustShrink = w > this.spaceLeft && l > 0;\n          // shrink or grow word as necessary after our near-guess above\n          while (mustShrink || mightGrow) {\n            if (mustShrink) {\n              w = this.wordWidth(word.slice(0, --l));\n              mustShrink = w > this.spaceLeft && l > 0;\n            } else {\n              w = this.wordWidth(word.slice(0, ++l));\n              mustShrink = w > this.spaceLeft && l > 0;\n              mightGrow = w <= this.spaceLeft && l < word.length;\n            }\n          }\n\n          // check for the edge case where a single character cannot fit into a line.\n          if (l === 0 && this.spaceLeft === this.lineWidth) {\n            l = 1;\n          }\n\n          // send a required break unless this is the last piece and a linebreak is not specified\n          fbk.required = bk.required || l < word.length;\n          shouldContinue = fn(word.slice(0, l), w, fbk, lbk);\n          lbk = {\n            required: false\n          };\n\n          // get the remaining piece of the word\n          word = word.slice(l);\n          w = this.wordWidth(word);\n          if (shouldContinue === false) {\n            break;\n          }\n        }\n      } else {\n        // otherwise just emit the break as it was given to us\n        shouldContinue = fn(word, w, bk, last);\n      }\n      if (shouldContinue === false) {\n        break;\n      }\n      last = bk;\n    }\n  }\n  wrap(text, options) {\n    // override options from previous continued fragments\n    if (options.indent != null) {\n      this.indent = options.indent;\n    }\n    if (options.characterSpacing != null) {\n      this.characterSpacing = options.characterSpacing;\n    }\n    if (options.wordSpacing != null) {\n      this.wordSpacing = options.wordSpacing;\n    }\n    if (options.ellipsis != null) {\n      this.ellipsis = options.ellipsis;\n    }\n\n    // make sure we're actually on the page\n    // and that the first line of is never by\n    // itself at the bottom of a page (orphans)\n    const nextY = this.document.y + this.document.currentLineHeight(true);\n    if (this.document.y > this.maxY || nextY > this.maxY) {\n      this.nextSection();\n    }\n    let buffer = '';\n    let textWidth = 0;\n    let wc = 0;\n    let lc = 0;\n    let {\n      y\n    } = this.document; // used to reset Y pos if options.continued (below)\n    const emitLine = () => {\n      options.textWidth = textWidth + this.wordSpacing * (wc - 1);\n      options.wordCount = wc;\n      options.lineWidth = this.lineWidth;\n      ({\n        y\n      } = this.document);\n      this.emit('line', buffer, options, this);\n      return lc++;\n    };\n    this.emit('sectionStart', options, this);\n    this.eachWord(text, (word, w, bk, last) => {\n      if (last == null || last.required) {\n        this.emit('firstLine', options, this);\n        this.spaceLeft = this.lineWidth;\n      }\n      if (this.canFit(word, w)) {\n        buffer += word;\n        textWidth += w;\n        wc++;\n      }\n      if (bk.required || !this.canFit(word, w)) {\n        // if the user specified a max height and an ellipsis, and is about to pass the\n        // max height and max columns after the next line, append the ellipsis\n        const lh = this.document.currentLineHeight(true);\n        if (this.height != null && this.ellipsis && this.document.y + lh * 2 > this.maxY && this.column >= this.columns) {\n          if (this.ellipsis === true) {\n            this.ellipsis = '';\n          } // map default ellipsis character\n          buffer = buffer.replace(/\\s+$/, '');\n          textWidth = this.wordWidth(buffer + this.ellipsis);\n\n          // remove characters from the buffer until the ellipsis fits\n          // to avoid infinite loop need to stop while-loop if buffer is empty string\n          while (buffer && textWidth > this.lineWidth) {\n            buffer = buffer.slice(0, -1).replace(/\\s+$/, '');\n            textWidth = this.wordWidth(buffer + this.ellipsis);\n          }\n          // need to add ellipsis only if there is enough space for it\n          if (textWidth <= this.lineWidth) {\n            buffer = buffer + this.ellipsis;\n          }\n          textWidth = this.wordWidth(buffer);\n        }\n        if (bk.required) {\n          if (w > this.spaceLeft) {\n            emitLine();\n            buffer = word;\n            textWidth = w;\n            wc = 1;\n          }\n          this.emit('lastLine', options, this);\n        }\n\n        // Previous entry is a soft hyphen - add visible hyphen.\n        if (buffer[buffer.length - 1] == SOFT_HYPHEN) {\n          buffer = buffer.slice(0, -1) + HYPHEN;\n          this.spaceLeft -= this.wordWidth(HYPHEN);\n        }\n        emitLine();\n\n        // if we've reached the edge of the page,\n        // continue on a new page or column\n        if (this.document.y + lh > this.maxY) {\n          const shouldContinue = this.nextSection();\n\n          // stop if we reached the maximum height\n          if (!shouldContinue) {\n            wc = 0;\n            buffer = '';\n            return false;\n          }\n        }\n\n        // reset the space left and buffer\n        if (bk.required) {\n          this.spaceLeft = this.lineWidth;\n          buffer = '';\n          textWidth = 0;\n          return wc = 0;\n        } else {\n          // reset the space left and buffer\n          this.spaceLeft = this.lineWidth - w;\n          buffer = word;\n          textWidth = w;\n          return wc = 1;\n        }\n      } else {\n        return this.spaceLeft -= w;\n      }\n    });\n    if (wc > 0) {\n      this.emit('lastLine', options, this);\n      emitLine();\n    }\n    this.emit('sectionEnd', options, this);\n\n    // if the wrap is set to be continued, save the X position\n    // to start the first line of the next segment at, and reset\n    // the y position\n    if (options.continued === true) {\n      if (lc > 1) {\n        this.continuedX = 0;\n      }\n      this.continuedX += options.textWidth || 0;\n      return this.document.y = y;\n    } else {\n      return this.document.x = this.startX;\n    }\n  }\n  nextSection(options) {\n    this.emit('sectionEnd', options, this);\n    if (++this.column > this.columns) {\n      // if a max height was specified by the user, we're done.\n      // otherwise, the default is to make a new page at the bottom.\n      if (this.height != null) {\n        return false;\n      }\n      this.document.continueOnNewPage();\n      this.column = 1;\n      this.startY = this.document.page.margins.top;\n      this.maxY = this.document.page.maxY();\n      this.document.x = this.startX;\n      if (this.document._fillColor) {\n        this.document.fillColor(...this.document._fillColor);\n      }\n      this.emit('pageBreak', options, this);\n    } else {\n      this.document.x += this.lineWidth + this.columnGap;\n      this.document.y = this.startY;\n      this.emit('columnBreak', options, this);\n    }\n    this.emit('sectionStart', options, this);\n    return true;\n  }\n}\nconst {\n  number: number$2\n} = PDFObject;\nvar TextMixin = {\n  initText() {\n    this._line = this._line.bind(this);\n    // Current coordinates\n    this.x = 0;\n    this.y = 0;\n    return this._lineGap = 0;\n  },\n  lineGap(_lineGap) {\n    this._lineGap = _lineGap;\n    return this;\n  },\n  moveDown(lines) {\n    if (lines == null) {\n      lines = 1;\n    }\n    this.y += this.currentLineHeight(true) * lines + this._lineGap;\n    return this;\n  },\n  moveUp(lines) {\n    if (lines == null) {\n      lines = 1;\n    }\n    this.y -= this.currentLineHeight(true) * lines + this._lineGap;\n    return this;\n  },\n  _text(text, x, y, options, lineCallback) {\n    options = this._initOptions(x, y, options);\n\n    // Convert text to a string\n    text = text == null ? '' : `${text}`;\n\n    // if the wordSpacing option is specified, remove multiple consecutive spaces\n    if (options.wordSpacing) {\n      text = text.replace(/\\s{2,}/g, ' ');\n    }\n    const addStructure = () => {\n      if (options.structParent) {\n        options.structParent.add(this.struct(options.structType || 'P', [this.markStructureContent(options.structType || 'P')]));\n      }\n    };\n\n    // word wrapping\n    if (options.width) {\n      let wrapper = this._wrapper;\n      if (!wrapper) {\n        wrapper = new LineWrapper(this, options);\n        wrapper.on('line', lineCallback);\n        wrapper.on('firstLine', addStructure);\n      }\n      this._wrapper = options.continued ? wrapper : null;\n      this._textOptions = options.continued ? options : null;\n      wrapper.wrap(text, options);\n\n      // render paragraphs as single lines\n    } else {\n      for (let line of text.split('\\n')) {\n        addStructure();\n        lineCallback(line, options);\n      }\n    }\n    return this;\n  },\n  text(text, x, y, options) {\n    return this._text(text, x, y, options, this._line);\n  },\n  widthOfString(string) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return this._font.widthOfString(string, this._fontSize, options.features) + (options.characterSpacing || 0) * (string.length - 1);\n  },\n  heightOfString(text, options) {\n    const {\n      x,\n      y\n    } = this;\n    options = this._initOptions(options);\n    options.height = Infinity; // don't break pages\n\n    const lineGap = options.lineGap || this._lineGap || 0;\n    this._text(text, this.x, this.y, options, () => {\n      return this.y += this.currentLineHeight(true) + lineGap;\n    });\n    const height = this.y - y;\n    this.x = x;\n    this.y = y;\n    return height;\n  },\n  list(list, x, y, options, wrapper) {\n    options = this._initOptions(x, y, options);\n    const listType = options.listType || 'bullet';\n    const unit = Math.round(this._font.ascender / 1000 * this._fontSize);\n    const midLine = unit / 2;\n    const r = options.bulletRadius || unit / 3;\n    const indent = options.textIndent || (listType === 'bullet' ? r * 5 : unit * 2);\n    const itemIndent = options.bulletIndent || (listType === 'bullet' ? r * 8 : unit * 2);\n    let level = 1;\n    const items = [];\n    const levels = [];\n    const numbers = [];\n    var flatten = function (list) {\n      let n = 1;\n      for (let i = 0; i < list.length; i++) {\n        const item = list[i];\n        if (Array.isArray(item)) {\n          level++;\n          flatten(item);\n          level--;\n        } else {\n          items.push(item);\n          levels.push(level);\n          if (listType !== 'bullet') {\n            numbers.push(n++);\n          }\n        }\n      }\n    };\n    flatten(list);\n    const label = function (n) {\n      switch (listType) {\n        case 'numbered':\n          return `${n}.`;\n        case 'lettered':\n          var letter = String.fromCharCode((n - 1) % 26 + 65);\n          var times = Math.floor((n - 1) / 26 + 1);\n          var text = Array(times + 1).join(letter);\n          return `${text}.`;\n      }\n    };\n    const drawListItem = function (listItem) {\n      wrapper = new LineWrapper(this, options);\n      wrapper.on('line', this._line);\n      level = 1;\n      let i = 0;\n      wrapper.once('firstLine', () => {\n        let item, itemType, labelType, bodyType;\n        if (options.structParent) {\n          if (options.structTypes) {\n            [itemType, labelType, bodyType] = options.structTypes;\n          } else {\n            [itemType, labelType, bodyType] = ['LI', 'Lbl', 'LBody'];\n          }\n        }\n        if (itemType) {\n          item = this.struct(itemType);\n          options.structParent.add(item);\n        } else if (options.structParent) {\n          item = options.structParent;\n        }\n        let l;\n        if ((l = levels[i++]) !== level) {\n          const diff = itemIndent * (l - level);\n          this.x += diff;\n          wrapper.lineWidth -= diff;\n          level = l;\n        }\n        if (item && (labelType || bodyType)) {\n          item.add(this.struct(labelType || bodyType, [this.markStructureContent(labelType || bodyType)]));\n        }\n        switch (listType) {\n          case 'bullet':\n            this.circle(this.x - indent + r, this.y + midLine, r);\n            this.fill();\n            break;\n          case 'numbered':\n          case 'lettered':\n            var text = label(numbers[i - 1]);\n            this._fragment(text, this.x - indent, this.y, options);\n            break;\n        }\n        if (item && labelType && bodyType) {\n          item.add(this.struct(bodyType, [this.markStructureContent(bodyType)]));\n        }\n        if (item && item !== options.structParent) {\n          item.end();\n        }\n      });\n      wrapper.on('sectionStart', () => {\n        const pos = indent + itemIndent * (level - 1);\n        this.x += pos;\n        return wrapper.lineWidth -= pos;\n      });\n      wrapper.on('sectionEnd', () => {\n        const pos = indent + itemIndent * (level - 1);\n        this.x -= pos;\n        return wrapper.lineWidth += pos;\n      });\n      wrapper.wrap(listItem, options);\n    };\n    for (let i = 0; i < items.length; i++) {\n      drawListItem.call(this, items[i]);\n    }\n    return this;\n  },\n  _initOptions() {\n    let x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let y = arguments.length > 1 ? arguments[1] : undefined;\n    let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    if (typeof x === 'object') {\n      options = x;\n      x = null;\n    }\n\n    // clone options object\n    const result = Object.assign({}, options);\n\n    // extend options with previous values for continued text\n    if (this._textOptions) {\n      for (let key in this._textOptions) {\n        const val = this._textOptions[key];\n        if (key !== 'continued') {\n          if (result[key] === undefined) {\n            result[key] = val;\n          }\n        }\n      }\n    }\n\n    // Update the current position\n    if (x != null) {\n      this.x = x;\n    }\n    if (y != null) {\n      this.y = y;\n    }\n\n    // wrap to margins if no x or y position passed\n    if (result.lineBreak !== false) {\n      if (result.width == null) {\n        result.width = this.page.width - this.x - this.page.margins.right;\n      }\n      result.width = Math.max(result.width, 0);\n    }\n    if (!result.columns) {\n      result.columns = 0;\n    }\n    if (result.columnGap == null) {\n      result.columnGap = 18;\n    } // 1/4 inch\n\n    return result;\n  },\n  _line(text) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    let wrapper = arguments.length > 2 ? arguments[2] : undefined;\n    this._fragment(text, this.x, this.y, options);\n    const lineGap = options.lineGap || this._lineGap || 0;\n    if (!wrapper) {\n      return this.x += this.widthOfString(text);\n    } else {\n      return this.y += this.currentLineHeight(true) + lineGap;\n    }\n  },\n  _fragment(text, x, y, options) {\n    let dy, encoded, i, positions, textWidth, words;\n    text = `${text}`.replace(/\\n/g, '');\n    if (text.length === 0) {\n      return;\n    }\n\n    // handle options\n    const align = options.align || 'left';\n    let wordSpacing = options.wordSpacing || 0;\n    const characterSpacing = options.characterSpacing || 0;\n\n    // text alignments\n    if (options.width) {\n      switch (align) {\n        case 'right':\n          textWidth = this.widthOfString(text.replace(/\\s+$/, ''), options);\n          x += options.lineWidth - textWidth;\n          break;\n        case 'center':\n          x += options.lineWidth / 2 - options.textWidth / 2;\n          break;\n        case 'justify':\n          // calculate the word spacing value\n          words = text.trim().split(/\\s+/);\n          textWidth = this.widthOfString(text.replace(/\\s+/g, ''), options);\n          var spaceWidth = this.widthOfString(' ') + characterSpacing;\n          wordSpacing = Math.max(0, (options.lineWidth - textWidth) / Math.max(1, words.length - 1) - spaceWidth);\n          break;\n      }\n    }\n\n    // text baseline alignments based on http://wiki.apache.org/xmlgraphics-fop/LineLayout/AlignmentHandling\n    if (typeof options.baseline === 'number') {\n      dy = -options.baseline;\n    } else {\n      switch (options.baseline) {\n        case 'svg-middle':\n          dy = 0.5 * this._font.xHeight;\n          break;\n        case 'middle':\n        case 'svg-central':\n          dy = 0.5 * (this._font.descender + this._font.ascender);\n          break;\n        case 'bottom':\n        case 'ideographic':\n          dy = this._font.descender;\n          break;\n        case 'alphabetic':\n          dy = 0;\n          break;\n        case 'mathematical':\n          dy = 0.5 * this._font.ascender;\n          break;\n        case 'hanging':\n          dy = 0.8 * this._font.ascender;\n          break;\n        case 'top':\n          dy = this._font.ascender;\n          break;\n        default:\n          dy = this._font.ascender;\n      }\n      dy = dy / 1000 * this._fontSize;\n    }\n\n    // calculate the actual rendered width of the string after word and character spacing\n    const renderedWidth = options.textWidth + wordSpacing * (options.wordCount - 1) + characterSpacing * (text.length - 1);\n\n    // create link annotations if the link option is given\n    if (options.link != null) {\n      this.link(x, y, renderedWidth, this.currentLineHeight(), options.link);\n    }\n    if (options.goTo != null) {\n      this.goTo(x, y, renderedWidth, this.currentLineHeight(), options.goTo);\n    }\n    if (options.destination != null) {\n      this.addNamedDestination(options.destination, 'XYZ', x, y, null);\n    }\n\n    // create underline\n    if (options.underline) {\n      this.save();\n      if (!options.stroke) {\n        this.strokeColor(...(this._fillColor || []));\n      }\n      const lineWidth = this._fontSize < 10 ? 0.5 : Math.floor(this._fontSize / 10);\n      this.lineWidth(lineWidth);\n      let lineY = y + this.currentLineHeight() - lineWidth;\n      this.moveTo(x, lineY);\n      this.lineTo(x + renderedWidth, lineY);\n      this.stroke();\n      this.restore();\n    }\n\n    // create strikethrough line\n    if (options.strike) {\n      this.save();\n      if (!options.stroke) {\n        this.strokeColor(...(this._fillColor || []));\n      }\n      const lineWidth = this._fontSize < 10 ? 0.5 : Math.floor(this._fontSize / 10);\n      this.lineWidth(lineWidth);\n      let lineY = y + this.currentLineHeight() / 2;\n      this.moveTo(x, lineY);\n      this.lineTo(x + renderedWidth, lineY);\n      this.stroke();\n      this.restore();\n    }\n    this.save();\n\n    // oblique (angle in degrees or boolean)\n    if (options.oblique) {\n      let skew;\n      if (typeof options.oblique === 'number') {\n        skew = -Math.tan(options.oblique * Math.PI / 180);\n      } else {\n        skew = -0.25;\n      }\n      this.transform(1, 0, 0, 1, x, y);\n      this.transform(1, 0, skew, 1, -skew * dy, 0);\n      this.transform(1, 0, 0, 1, -x, -y);\n    }\n\n    // flip coordinate system\n    this.transform(1, 0, 0, -1, 0, this.page.height);\n    y = this.page.height - y - dy;\n\n    // add current font to page if necessary\n    if (this.page.fonts[this._font.id] == null) {\n      this.page.fonts[this._font.id] = this._font.ref();\n    }\n\n    // begin the text object\n    this.addContent('BT');\n\n    // text position\n    this.addContent(`1 0 0 1 ${number$2(x)} ${number$2(y)} Tm`);\n\n    // font and font size\n    this.addContent(`/${this._font.id} ${number$2(this._fontSize)} Tf`);\n\n    // rendering mode\n    const mode = options.fill && options.stroke ? 2 : options.stroke ? 1 : 0;\n    if (mode) {\n      this.addContent(`${mode} Tr`);\n    }\n\n    // Character spacing\n    if (characterSpacing) {\n      this.addContent(`${number$2(characterSpacing)} Tc`);\n    }\n\n    // Add the actual text\n    // If we have a word spacing value, we need to encode each word separately\n    // since the normal Tw operator only works on character code 32, which isn't\n    // used for embedded fonts.\n    if (wordSpacing) {\n      words = text.trim().split(/\\s+/);\n      wordSpacing += this.widthOfString(' ') + characterSpacing;\n      wordSpacing *= 1000 / this._fontSize;\n      encoded = [];\n      positions = [];\n      for (let word of words) {\n        const [encodedWord, positionsWord] = this._font.encode(word, options.features);\n        encoded = encoded.concat(encodedWord);\n        positions = positions.concat(positionsWord);\n\n        // add the word spacing to the end of the word\n        // clone object because of cache\n        const space = {};\n        const object = positions[positions.length - 1];\n        for (let key in object) {\n          const val = object[key];\n          space[key] = val;\n        }\n        space.xAdvance += wordSpacing;\n        positions[positions.length - 1] = space;\n      }\n    } else {\n      [encoded, positions] = this._font.encode(text, options.features);\n    }\n    const scale = this._fontSize / 1000;\n    const commands = [];\n    let last = 0;\n    let hadOffset = false;\n\n    // Adds a segment of text to the TJ command buffer\n    const addSegment = cur => {\n      if (last < cur) {\n        const hex = encoded.slice(last, cur).join('');\n        const advance = positions[cur - 1].xAdvance - positions[cur - 1].advanceWidth;\n        commands.push(`<${hex}> ${number$2(-advance)}`);\n      }\n      return last = cur;\n    };\n\n    // Flushes the current TJ commands to the output stream\n    const flush = i => {\n      addSegment(i);\n      if (commands.length > 0) {\n        this.addContent(`[${commands.join(' ')}] TJ`);\n        return commands.length = 0;\n      }\n    };\n    for (i = 0; i < positions.length; i++) {\n      // If we have an x or y offset, we have to break out of the current TJ command\n      // so we can move the text position.\n      const pos = positions[i];\n      if (pos.xOffset || pos.yOffset) {\n        // Flush the current buffer\n        flush(i);\n\n        // Move the text position and flush just the current character\n        this.addContent(`1 0 0 1 ${number$2(x + pos.xOffset * scale)} ${number$2(y + pos.yOffset * scale)} Tm`);\n        flush(i + 1);\n        hadOffset = true;\n      } else {\n        // If the last character had an offset, reset the text position\n        if (hadOffset) {\n          this.addContent(`1 0 0 1 ${number$2(x)} ${number$2(y)} Tm`);\n          hadOffset = false;\n        }\n\n        // Group segments that don't have any advance adjustments\n        if (pos.xAdvance - pos.advanceWidth !== 0) {\n          addSegment(i + 1);\n        }\n      }\n      x += pos.xAdvance * scale;\n    }\n\n    // Flush any remaining commands\n    flush(i);\n\n    // end the text object\n    this.addContent('ET');\n\n    // restore flipped coordinate system\n    return this.restore();\n  }\n};\nconst MARKERS = [0xffc0, 0xffc1, 0xffc2, 0xffc3, 0xffc5, 0xffc6, 0xffc7, 0xffc8, 0xffc9, 0xffca, 0xffcb, 0xffcc, 0xffcd, 0xffce, 0xffcf];\nconst COLOR_SPACE_MAP = {\n  1: 'DeviceGray',\n  3: 'DeviceRGB',\n  4: 'DeviceCMYK'\n};\nclass JPEG {\n  constructor(data, label) {\n    let marker;\n    this.data = data;\n    this.label = label;\n    if (this.data.readUInt16BE(0) !== 0xffd8) {\n      throw 'SOI not found in JPEG';\n    }\n\n    // Parse the EXIF orientation\n    this.orientation = exif.fromBuffer(this.data).Orientation || 1;\n    let pos = 2;\n    while (pos < this.data.length) {\n      marker = this.data.readUInt16BE(pos);\n      pos += 2;\n      if (MARKERS.includes(marker)) {\n        break;\n      }\n      pos += this.data.readUInt16BE(pos);\n    }\n    if (!MARKERS.includes(marker)) {\n      throw 'Invalid JPEG.';\n    }\n    pos += 2;\n    this.bits = this.data[pos++];\n    this.height = this.data.readUInt16BE(pos);\n    pos += 2;\n    this.width = this.data.readUInt16BE(pos);\n    pos += 2;\n    const channels = this.data[pos++];\n    this.colorSpace = COLOR_SPACE_MAP[channels];\n    this.obj = null;\n  }\n  embed(document) {\n    if (this.obj) {\n      return;\n    }\n    this.obj = document.ref({\n      Type: 'XObject',\n      Subtype: 'Image',\n      BitsPerComponent: this.bits,\n      Width: this.width,\n      Height: this.height,\n      ColorSpace: this.colorSpace,\n      Filter: 'DCTDecode'\n    });\n\n    // add extra decode params for CMYK images. By swapping the\n    // min and max values from the default, we invert the colors. See\n    // section 4.8.4 of the spec.\n    if (this.colorSpace === 'DeviceCMYK') {\n      this.obj.data['Decode'] = [1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0];\n    }\n    this.obj.end(this.data);\n\n    // free memory\n    return this.data = null;\n  }\n}\nclass PNGImage {\n  constructor(data, label) {\n    this.label = label;\n    this.image = new PNG(data);\n    this.width = this.image.width;\n    this.height = this.image.height;\n    this.imgData = this.image.imgData;\n    this.obj = null;\n  }\n  embed(document) {\n    let dataDecoded = false;\n    this.document = document;\n    if (this.obj) {\n      return;\n    }\n    const hasAlphaChannel = this.image.hasAlphaChannel;\n    const isInterlaced = this.image.interlaceMethod === 1;\n    this.obj = this.document.ref({\n      Type: 'XObject',\n      Subtype: 'Image',\n      BitsPerComponent: hasAlphaChannel ? 8 : this.image.bits,\n      Width: this.width,\n      Height: this.height,\n      Filter: 'FlateDecode'\n    });\n    if (!hasAlphaChannel) {\n      const params = this.document.ref({\n        Predictor: isInterlaced ? 1 : 15,\n        Colors: this.image.colors,\n        BitsPerComponent: this.image.bits,\n        Columns: this.width\n      });\n      this.obj.data['DecodeParms'] = params;\n      params.end();\n    }\n    if (this.image.palette.length === 0) {\n      this.obj.data['ColorSpace'] = this.image.colorSpace;\n    } else {\n      // embed the color palette in the PDF as an object stream\n      const palette = this.document.ref();\n      palette.end(Buffer.from(this.image.palette));\n\n      // build the color space array for the image\n      this.obj.data['ColorSpace'] = ['Indexed', 'DeviceRGB', this.image.palette.length / 3 - 1, palette];\n    }\n\n    // For PNG color types 0, 2 and 3, the transparency data is stored in\n    // a dedicated PNG chunk.\n    if (this.image.transparency.grayscale != null) {\n      // Use Color Key Masking (spec section 4.8.5)\n      // An array with N elements, where N is two times the number of color components.\n      const val = this.image.transparency.grayscale;\n      this.obj.data['Mask'] = [val, val];\n    } else if (this.image.transparency.rgb) {\n      // Use Color Key Masking (spec section 4.8.5)\n      // An array with N elements, where N is two times the number of color components.\n      const {\n        rgb\n      } = this.image.transparency;\n      const mask = [];\n      for (let x of rgb) {\n        mask.push(x, x);\n      }\n      this.obj.data['Mask'] = mask;\n    } else if (this.image.transparency.indexed) {\n      // Create a transparency SMask for the image based on the data\n      // in the PLTE and tRNS sections. See below for details on SMasks.\n      dataDecoded = true;\n      return this.loadIndexedAlphaChannel();\n    } else if (hasAlphaChannel) {\n      // For PNG color types 4 and 6, the transparency data is stored as a alpha\n      // channel mixed in with the main image data. Separate this data out into an\n      // SMask object and store it separately in the PDF.\n      dataDecoded = true;\n      return this.splitAlphaChannel();\n    }\n    if (isInterlaced && !dataDecoded) {\n      return this.decodeData();\n    }\n    this.finalize();\n  }\n  finalize() {\n    if (this.alphaChannel) {\n      const sMask = this.document.ref({\n        Type: 'XObject',\n        Subtype: 'Image',\n        Height: this.height,\n        Width: this.width,\n        BitsPerComponent: 8,\n        Filter: 'FlateDecode',\n        ColorSpace: 'DeviceGray',\n        Decode: [0, 1]\n      });\n      sMask.end(this.alphaChannel);\n      this.obj.data['SMask'] = sMask;\n    }\n\n    // add the actual image data\n    this.obj.end(this.imgData);\n\n    // free memory\n    this.image = null;\n    return this.imgData = null;\n  }\n  splitAlphaChannel() {\n    return this.image.decodePixels(pixels => {\n      let a, p;\n      const colorCount = this.image.colors;\n      const pixelCount = this.width * this.height;\n      const imgData = Buffer.alloc(pixelCount * colorCount);\n      const alphaChannel = Buffer.alloc(pixelCount);\n      let i = p = a = 0;\n      const len = pixels.length;\n      // For 16bit images copy only most significant byte (MSB) - PNG data is always stored in network byte order (MSB first)\n      const skipByteCount = this.image.bits === 16 ? 1 : 0;\n      while (i < len) {\n        for (let colorIndex = 0; colorIndex < colorCount; colorIndex++) {\n          imgData[p++] = pixels[i++];\n          i += skipByteCount;\n        }\n        alphaChannel[a++] = pixels[i++];\n        i += skipByteCount;\n      }\n      this.imgData = zlib.deflateSync(imgData);\n      this.alphaChannel = zlib.deflateSync(alphaChannel);\n      return this.finalize();\n    });\n  }\n  loadIndexedAlphaChannel() {\n    const transparency = this.image.transparency.indexed;\n    return this.image.decodePixels(pixels => {\n      const alphaChannel = Buffer.alloc(this.width * this.height);\n      let i = 0;\n      for (let j = 0, end = pixels.length; j < end; j++) {\n        alphaChannel[i++] = transparency[pixels[j]];\n      }\n      this.alphaChannel = zlib.deflateSync(alphaChannel);\n      return this.finalize();\n    });\n  }\n  decodeData() {\n    this.image.decodePixels(pixels => {\n      this.imgData = zlib.deflateSync(pixels);\n      this.finalize();\n    });\n  }\n}\n\n/*\r\nPDFImage - embeds images in PDF documents\r\nBy Devon Govett\r\n*/\nclass PDFImage {\n  static open(src, label) {\n    let data;\n    if (Buffer.isBuffer(src)) {\n      data = src;\n    } else if (src instanceof ArrayBuffer) {\n      data = Buffer.from(new Uint8Array(src));\n    } else {\n      let match;\n      if (match = /^data:.+?;base64,(.*)$/.exec(src)) {\n        data = Buffer.from(match[1], 'base64');\n      } else {\n        data = fs.readFileSync(src);\n        if (!data) {\n          return;\n        }\n      }\n    }\n    if (data[0] === 0xff && data[1] === 0xd8) {\n      return new JPEG(data, label);\n    } else if (data[0] === 0x89 && data.toString('ascii', 1, 4) === 'PNG') {\n      return new PNGImage(data, label);\n    } else {\n      throw new Error('Unknown image format.');\n    }\n  }\n}\nvar ImagesMixin = {\n  initImages() {\n    this._imageRegistry = {};\n    return this._imageCount = 0;\n  },\n  image(src, x, y) {\n    let options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    let bh, bp, bw, image, ip, left, left1, rotateAngle, originX, originY;\n    if (typeof x === 'object') {\n      options = x;\n      x = null;\n    }\n\n    // Ignore orientation based on document options or image options\n    const ignoreOrientation = options.ignoreOrientation || options.ignoreOrientation !== false && this.options.ignoreOrientation;\n    x = (left = x != null ? x : options.x) != null ? left : this.x;\n    y = (left1 = y != null ? y : options.y) != null ? left1 : this.y;\n    if (typeof src === 'string') {\n      image = this._imageRegistry[src];\n    }\n    if (!image) {\n      if (src.width && src.height) {\n        image = src;\n      } else {\n        image = this.openImage(src);\n      }\n    }\n    if (!image.obj) {\n      image.embed(this);\n    }\n    if (this.page.xobjects[image.label] == null) {\n      this.page.xobjects[image.label] = image.obj;\n    }\n    let {\n      width,\n      height\n    } = image;\n\n    // If EXIF orientation calls for it, swap width and height\n    if (!ignoreOrientation && image.orientation > 4) {\n      [width, height] = [height, width];\n    }\n    let w = options.width || width;\n    let h = options.height || height;\n    if (options.width && !options.height) {\n      const wp = w / width;\n      w = width * wp;\n      h = height * wp;\n    } else if (options.height && !options.width) {\n      const hp = h / height;\n      w = width * hp;\n      h = height * hp;\n    } else if (options.scale) {\n      w = width * options.scale;\n      h = height * options.scale;\n    } else if (options.fit) {\n      [bw, bh] = options.fit;\n      bp = bw / bh;\n      ip = width / height;\n      if (ip > bp) {\n        w = bw;\n        h = bw / ip;\n      } else {\n        h = bh;\n        w = bh * ip;\n      }\n    } else if (options.cover) {\n      [bw, bh] = options.cover;\n      bp = bw / bh;\n      ip = width / height;\n      if (ip > bp) {\n        h = bh;\n        w = bh * ip;\n      } else {\n        w = bw;\n        h = bw / ip;\n      }\n    }\n    if (options.fit || options.cover) {\n      if (options.align === 'center') {\n        x = x + bw / 2 - w / 2;\n      } else if (options.align === 'right') {\n        x = x + bw - w;\n      }\n      if (options.valign === 'center') {\n        y = y + bh / 2 - h / 2;\n      } else if (options.valign === 'bottom') {\n        y = y + bh - h;\n      }\n    }\n    if (!ignoreOrientation) {\n      switch (image.orientation) {\n        // No orientation (need to flip image, though, because of the default transform matrix on the document)\n        default:\n        case 1:\n          h = -h;\n          y -= h;\n          rotateAngle = 0;\n          break;\n        // Flip Horizontal\n        case 2:\n          w = -w;\n          h = -h;\n          x -= w;\n          y -= h;\n          rotateAngle = 0;\n          break;\n        // Rotate 180 degrees\n        case 3:\n          originX = x;\n          originY = y;\n          h = -h;\n          x -= w;\n          rotateAngle = 180;\n          break;\n        // Flip vertical\n        case 4:\n          // Do nothing, image will be flipped\n\n          break;\n        // Flip horizontally and rotate 270 degrees CW\n        case 5:\n          originX = x;\n          originY = y;\n          [w, h] = [h, w];\n          y -= h;\n          rotateAngle = 90;\n          break;\n        // Rotate 90 degrees CW\n        case 6:\n          originX = x;\n          originY = y;\n          [w, h] = [h, w];\n          h = -h;\n          rotateAngle = 90;\n          break;\n        // Flip horizontally and rotate 90 degrees CW\n        case 7:\n          originX = x;\n          originY = y;\n          [w, h] = [h, w];\n          h = -h;\n          w = -w;\n          x -= w;\n          rotateAngle = 90;\n          break;\n        // Rotate 270 degrees CW\n        case 8:\n          originX = x;\n          originY = y;\n          [w, h] = [h, w];\n          h = -h;\n          x -= w;\n          y -= h;\n          rotateAngle = -90;\n          break;\n      }\n    } else {\n      h = -h;\n      y -= h;\n      rotateAngle = 0;\n    }\n\n    // create link annotations if the link option is given\n    if (options.link != null) {\n      this.link(x, y, w, h, options.link);\n    }\n    if (options.goTo != null) {\n      this.goTo(x, y, w, h, options.goTo);\n    }\n    if (options.destination != null) {\n      this.addNamedDestination(options.destination, 'XYZ', x, y, null);\n    }\n\n    // Set the current y position to below the image if it is in the document flow\n    if (this.y === y) {\n      this.y += h;\n    }\n    this.save();\n    if (rotateAngle) {\n      this.rotate(rotateAngle, {\n        origin: [originX, originY]\n      });\n    }\n    this.transform(w, 0, 0, h, x, y);\n    this.addContent(`/${image.label} Do`);\n    this.restore();\n    return this;\n  },\n  openImage(src) {\n    let image;\n    if (typeof src === 'string') {\n      image = this._imageRegistry[src];\n    }\n    if (!image) {\n      image = PDFImage.open(src, `I${++this._imageCount}`);\n      if (typeof src === 'string') {\n        this._imageRegistry[src] = image;\n      }\n    }\n    return image;\n  }\n};\nvar AnnotationsMixin = {\n  annotate(x, y, w, h, options) {\n    options.Type = 'Annot';\n    options.Rect = this._convertRect(x, y, w, h);\n    options.Border = [0, 0, 0];\n    if (options.Subtype === 'Link' && typeof options.F === 'undefined') {\n      options.F = 1 << 2; // Print Annotation Flag\n    }\n    if (options.Subtype !== 'Link') {\n      if (options.C == null) {\n        options.C = this._normalizeColor(options.color || [0, 0, 0]);\n      }\n    } // convert colors\n    delete options.color;\n    if (typeof options.Dest === 'string') {\n      options.Dest = new String(options.Dest);\n    }\n\n    // Capitalize keys\n    for (let key in options) {\n      const val = options[key];\n      options[key[0].toUpperCase() + key.slice(1)] = val;\n    }\n    const ref = this.ref(options);\n    this.page.annotations.push(ref);\n    ref.end();\n    return this;\n  },\n  note(x, y, w, h, contents) {\n    let options = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};\n    options.Subtype = 'Text';\n    options.Contents = new String(contents);\n    options.Name = 'Comment';\n    if (options.color == null) {\n      options.color = [243, 223, 92];\n    }\n    return this.annotate(x, y, w, h, options);\n  },\n  goTo(x, y, w, h, name) {\n    let options = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};\n    options.Subtype = 'Link';\n    options.A = this.ref({\n      S: 'GoTo',\n      D: new String(name)\n    });\n    options.A.end();\n    return this.annotate(x, y, w, h, options);\n  },\n  link(x, y, w, h, url) {\n    let options = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};\n    options.Subtype = 'Link';\n    if (typeof url === 'number') {\n      // Link to a page in the document (the page must already exist)\n      const pages = this._root.data.Pages.data;\n      if (url >= 0 && url < pages.Kids.length) {\n        options.A = this.ref({\n          S: 'GoTo',\n          D: [pages.Kids[url], 'XYZ', null, null, null]\n        });\n        options.A.end();\n      } else {\n        throw new Error(`The document has no page ${url}`);\n      }\n    } else {\n      // Link to an external url\n      options.A = this.ref({\n        S: 'URI',\n        URI: new String(url)\n      });\n      options.A.end();\n    }\n    return this.annotate(x, y, w, h, options);\n  },\n  _markup(x, y, w, h) {\n    let options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n    const [x1, y1, x2, y2] = this._convertRect(x, y, w, h);\n    options.QuadPoints = [x1, y2, x2, y2, x1, y1, x2, y1];\n    options.Contents = new String();\n    return this.annotate(x, y, w, h, options);\n  },\n  highlight(x, y, w, h) {\n    let options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n    options.Subtype = 'Highlight';\n    if (options.color == null) {\n      options.color = [241, 238, 148];\n    }\n    return this._markup(x, y, w, h, options);\n  },\n  underline(x, y, w, h) {\n    let options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n    options.Subtype = 'Underline';\n    return this._markup(x, y, w, h, options);\n  },\n  strike(x, y, w, h) {\n    let options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n    options.Subtype = 'StrikeOut';\n    return this._markup(x, y, w, h, options);\n  },\n  lineAnnotation(x1, y1, x2, y2) {\n    let options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n    options.Subtype = 'Line';\n    options.Contents = new String();\n    options.L = [x1, this.page.height - y1, x2, this.page.height - y2];\n    return this.annotate(x1, y1, x2, y2, options);\n  },\n  rectAnnotation(x, y, w, h) {\n    let options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n    options.Subtype = 'Square';\n    options.Contents = new String();\n    return this.annotate(x, y, w, h, options);\n  },\n  ellipseAnnotation(x, y, w, h) {\n    let options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n    options.Subtype = 'Circle';\n    options.Contents = new String();\n    return this.annotate(x, y, w, h, options);\n  },\n  textAnnotation(x, y, w, h, text) {\n    let options = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};\n    options.Subtype = 'FreeText';\n    options.Contents = new String(text);\n    options.DA = new String();\n    return this.annotate(x, y, w, h, options);\n  },\n  fileAnnotation(x, y, w, h) {\n    let file = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n    let options = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};\n    // create hidden file\n    const filespec = this.file(file.src, Object.assign({\n      hidden: true\n    }, file));\n    options.Subtype = 'FileAttachment';\n    options.FS = filespec;\n\n    // add description from filespec unless description (Contents) has already been set\n    if (options.Contents) {\n      options.Contents = new String(options.Contents);\n    } else if (filespec.data.Desc) {\n      options.Contents = filespec.data.Desc;\n    }\n    return this.annotate(x, y, w, h, options);\n  },\n  _convertRect(x1, y1, w, h) {\n    // flip y1 and y2\n    let y2 = y1;\n    y1 += h;\n\n    // make x2\n    let x2 = x1 + w;\n\n    // apply current transformation matrix to points\n    const [m0, m1, m2, m3, m4, m5] = this._ctm;\n    x1 = m0 * x1 + m2 * y1 + m4;\n    y1 = m1 * x1 + m3 * y1 + m5;\n    x2 = m0 * x2 + m2 * y2 + m4;\n    y2 = m1 * x2 + m3 * y2 + m5;\n    return [x1, y1, x2, y2];\n  }\n};\nclass PDFOutline {\n  constructor(document, parent, title, dest) {\n    let options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {\n      expanded: false\n    };\n    this.document = document;\n    this.options = options;\n    this.outlineData = {};\n    if (dest !== null) {\n      this.outlineData['Dest'] = [dest.dictionary, 'Fit'];\n    }\n    if (parent !== null) {\n      this.outlineData['Parent'] = parent;\n    }\n    if (title !== null) {\n      this.outlineData['Title'] = new String(title);\n    }\n    this.dictionary = this.document.ref(this.outlineData);\n    this.children = [];\n  }\n  addItem(title) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n      expanded: false\n    };\n    const result = new PDFOutline(this.document, this.dictionary, title, this.document.page, options);\n    this.children.push(result);\n    return result;\n  }\n  endOutline() {\n    if (this.children.length > 0) {\n      if (this.options.expanded) {\n        this.outlineData.Count = this.children.length;\n      }\n      const first = this.children[0],\n        last = this.children[this.children.length - 1];\n      this.outlineData.First = first.dictionary;\n      this.outlineData.Last = last.dictionary;\n      for (let i = 0, len = this.children.length; i < len; i++) {\n        const child = this.children[i];\n        if (i > 0) {\n          child.outlineData.Prev = this.children[i - 1].dictionary;\n        }\n        if (i < this.children.length - 1) {\n          child.outlineData.Next = this.children[i + 1].dictionary;\n        }\n        child.endOutline();\n      }\n    }\n    return this.dictionary.end();\n  }\n}\nvar OutlineMixin = {\n  initOutline() {\n    return this.outline = new PDFOutline(this, null, null, null);\n  },\n  endOutline() {\n    this.outline.endOutline();\n    if (this.outline.children.length > 0) {\n      this._root.data.Outlines = this.outline.dictionary;\n      return this._root.data.PageMode = 'UseOutlines';\n    }\n  }\n};\n\n/*\r\nPDFStructureContent - a reference to a marked structure content\r\nBy Ben Schmidt\r\n*/\n\nclass PDFStructureContent {\n  constructor(pageRef, mcid) {\n    this.refs = [{\n      pageRef,\n      mcid\n    }];\n  }\n  push(structContent) {\n    structContent.refs.forEach(ref => this.refs.push(ref));\n  }\n}\n\n/*\r\nPDFStructureElement - represents an element in the PDF logical structure tree\r\nBy Ben Schmidt\r\n*/\nclass PDFStructureElement {\n  constructor(document, type) {\n    let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    let children = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n    this.document = document;\n    this._attached = false;\n    this._ended = false;\n    this._flushed = false;\n    this.dictionary = document.ref({\n      // Type: \"StructElem\",\n      S: type\n    });\n    const data = this.dictionary.data;\n    if (Array.isArray(options) || this._isValidChild(options)) {\n      children = options;\n      options = {};\n    }\n    if (typeof options.title !== 'undefined') {\n      data.T = new String(options.title);\n    }\n    if (typeof options.lang !== 'undefined') {\n      data.Lang = new String(options.lang);\n    }\n    if (typeof options.alt !== 'undefined') {\n      data.Alt = new String(options.alt);\n    }\n    if (typeof options.expanded !== 'undefined') {\n      data.E = new String(options.expanded);\n    }\n    if (typeof options.actual !== 'undefined') {\n      data.ActualText = new String(options.actual);\n    }\n    this._children = [];\n    if (children) {\n      if (!Array.isArray(children)) {\n        children = [children];\n      }\n      children.forEach(child => this.add(child));\n      this.end();\n    }\n  }\n  add(child) {\n    if (this._ended) {\n      throw new Error(`Cannot add child to already-ended structure element`);\n    }\n    if (!this._isValidChild(child)) {\n      throw new Error(`Invalid structure element child`);\n    }\n    if (child instanceof PDFStructureElement) {\n      child.setParent(this.dictionary);\n      if (this._attached) {\n        child.setAttached();\n      }\n    }\n    if (child instanceof PDFStructureContent) {\n      this._addContentToParentTree(child);\n    }\n    if (typeof child === 'function' && this._attached) {\n      // _contentForClosure() adds the content to the parent tree\n      child = this._contentForClosure(child);\n    }\n    this._children.push(child);\n    return this;\n  }\n  _addContentToParentTree(content) {\n    content.refs.forEach(_ref => {\n      let {\n        pageRef,\n        mcid\n      } = _ref;\n      const pageStructParents = this.document.getStructParentTree().get(pageRef.data.StructParents);\n      pageStructParents[mcid] = this.dictionary;\n    });\n  }\n  setParent(parentRef) {\n    if (this.dictionary.data.P) {\n      throw new Error(`Structure element added to more than one parent`);\n    }\n    this.dictionary.data.P = parentRef;\n    this._flush();\n  }\n  setAttached() {\n    if (this._attached) {\n      return;\n    }\n    this._children.forEach((child, index) => {\n      if (child instanceof PDFStructureElement) {\n        child.setAttached();\n      }\n      if (typeof child === 'function') {\n        this._children[index] = this._contentForClosure(child);\n      }\n    });\n    this._attached = true;\n    this._flush();\n  }\n  end() {\n    if (this._ended) {\n      return;\n    }\n    this._children.filter(child => child instanceof PDFStructureElement).forEach(child => child.end());\n    this._ended = true;\n    this._flush();\n  }\n  _isValidChild(child) {\n    return child instanceof PDFStructureElement || child instanceof PDFStructureContent || typeof child === 'function';\n  }\n  _contentForClosure(closure) {\n    const content = this.document.markStructureContent(this.dictionary.data.S);\n    closure();\n    this.document.endMarkedContent();\n    this._addContentToParentTree(content);\n    return content;\n  }\n  _isFlushable() {\n    if (!this.dictionary.data.P || !this._ended) {\n      return false;\n    }\n    return this._children.every(child => {\n      if (typeof child === 'function') {\n        return false;\n      }\n      if (child instanceof PDFStructureElement) {\n        return child._isFlushable();\n      }\n      return true;\n    });\n  }\n  _flush() {\n    if (this._flushed || !this._isFlushable()) {\n      return;\n    }\n    this.dictionary.data.K = [];\n    this._children.forEach(child => this._flushChild(child));\n    this.dictionary.end();\n\n    // free memory used by children; the dictionary itself may still be\n    // referenced by a parent structure element or root, but we can\n    // at least trim the tree here\n    this._children = [];\n    this.dictionary.data.K = null;\n    this._flushed = true;\n  }\n  _flushChild(child) {\n    if (child instanceof PDFStructureElement) {\n      this.dictionary.data.K.push(child.dictionary);\n    }\n    if (child instanceof PDFStructureContent) {\n      child.refs.forEach(_ref2 => {\n        let {\n          pageRef,\n          mcid\n        } = _ref2;\n        if (!this.dictionary.data.Pg) {\n          this.dictionary.data.Pg = pageRef;\n        }\n        if (this.dictionary.data.Pg === pageRef) {\n          this.dictionary.data.K.push(mcid);\n        } else {\n          this.dictionary.data.K.push({\n            Type: \"MCR\",\n            Pg: pageRef,\n            MCID: mcid\n          });\n        }\n      });\n    }\n  }\n}\n\n/*\r\nPDFNumberTree - represents a number tree object\r\n*/\nclass PDFNumberTree extends PDFTree {\n  _compareKeys(a, b) {\n    return parseInt(a) - parseInt(b);\n  }\n  _keysName() {\n    return \"Nums\";\n  }\n  _dataForKey(k) {\n    return parseInt(k);\n  }\n}\n\n/*\r\nMarkings mixin - support marked content sequences in content streams\r\nBy Ben Schmidt\r\n*/\nvar MarkingsMixin = {\n  initMarkings(options) {\n    this.structChildren = [];\n    if (options.tagged) {\n      this.getMarkInfoDictionary().data.Marked = true;\n      this.getStructTreeRoot();\n    }\n  },\n  markContent(tag) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    if (tag === 'Artifact' || options && options.mcid) {\n      let toClose = 0;\n      this.page.markings.forEach(marking => {\n        if (toClose || marking.structContent || marking.tag === 'Artifact') {\n          toClose++;\n        }\n      });\n      while (toClose--) {\n        this.endMarkedContent();\n      }\n    }\n    if (!options) {\n      this.page.markings.push({\n        tag\n      });\n      this.addContent(`/${tag} BMC`);\n      return this;\n    }\n    this.page.markings.push({\n      tag,\n      options\n    });\n    const dictionary = {};\n    if (typeof options.mcid !== 'undefined') {\n      dictionary.MCID = options.mcid;\n    }\n    if (tag === 'Artifact') {\n      if (typeof options.type === 'string') {\n        dictionary.Type = options.type;\n      }\n      if (Array.isArray(options.bbox)) {\n        dictionary.BBox = [options.bbox[0], this.page.height - options.bbox[3], options.bbox[2], this.page.height - options.bbox[1]];\n      }\n      if (Array.isArray(options.attached) && options.attached.every(val => typeof val === 'string')) {\n        dictionary.Attached = options.attached;\n      }\n    }\n    if (tag === 'Span') {\n      if (options.lang) {\n        dictionary.Lang = new String(options.lang);\n      }\n      if (options.alt) {\n        dictionary.Alt = new String(options.alt);\n      }\n      if (options.expanded) {\n        dictionary.E = new String(options.expanded);\n      }\n      if (options.actual) {\n        dictionary.ActualText = new String(options.actual);\n      }\n    }\n    this.addContent(`/${tag} ${PDFObject.convert(dictionary)} BDC`);\n    return this;\n  },\n  markStructureContent(tag) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const pageStructParents = this.getStructParentTree().get(this.page.structParentTreeKey);\n    const mcid = pageStructParents.length;\n    pageStructParents.push(null);\n    this.markContent(tag, {\n      ...options,\n      mcid\n    });\n    const structContent = new PDFStructureContent(this.page.dictionary, mcid);\n    this.page.markings.slice(-1)[0].structContent = structContent;\n    return structContent;\n  },\n  endMarkedContent() {\n    this.page.markings.pop();\n    this.addContent('EMC');\n    return this;\n  },\n  struct(type) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    let children = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    return new PDFStructureElement(this, type, options, children);\n  },\n  addStructure(structElem) {\n    const structTreeRoot = this.getStructTreeRoot();\n    structElem.setParent(structTreeRoot);\n    structElem.setAttached();\n    this.structChildren.push(structElem);\n    if (!structTreeRoot.data.K) {\n      structTreeRoot.data.K = [];\n    }\n    structTreeRoot.data.K.push(structElem.dictionary);\n    return this;\n  },\n  initPageMarkings(pageMarkings) {\n    pageMarkings.forEach(marking => {\n      if (marking.structContent) {\n        const structContent = marking.structContent;\n        const newStructContent = this.markStructureContent(marking.tag, marking.options);\n        structContent.push(newStructContent);\n        this.page.markings.slice(-1)[0].structContent = structContent;\n      } else {\n        this.markContent(marking.tag, marking.options);\n      }\n    });\n  },\n  endPageMarkings(page) {\n    const pageMarkings = page.markings;\n    pageMarkings.forEach(() => page.write('EMC'));\n    page.markings = [];\n    return pageMarkings;\n  },\n  getMarkInfoDictionary() {\n    if (!this._root.data.MarkInfo) {\n      this._root.data.MarkInfo = this.ref({});\n    }\n    return this._root.data.MarkInfo;\n  },\n  getStructTreeRoot() {\n    if (!this._root.data.StructTreeRoot) {\n      this._root.data.StructTreeRoot = this.ref({\n        Type: 'StructTreeRoot',\n        ParentTree: new PDFNumberTree(),\n        ParentTreeNextKey: 0\n      });\n    }\n    return this._root.data.StructTreeRoot;\n  },\n  getStructParentTree() {\n    return this.getStructTreeRoot().data.ParentTree;\n  },\n  createStructParentTreeNextKey() {\n    // initialise the MarkInfo dictionary\n    this.getMarkInfoDictionary();\n    const structTreeRoot = this.getStructTreeRoot();\n    const key = structTreeRoot.data.ParentTreeNextKey++;\n    structTreeRoot.data.ParentTree.add(key, []);\n    return key;\n  },\n  endMarkings() {\n    const structTreeRoot = this._root.data.StructTreeRoot;\n    if (structTreeRoot) {\n      structTreeRoot.end();\n      this.structChildren.forEach(structElem => structElem.end());\n    }\n    if (this._root.data.MarkInfo) {\n      this._root.data.MarkInfo.end();\n    }\n  }\n};\nconst FIELD_FLAGS = {\n  readOnly: 1,\n  required: 2,\n  noExport: 4,\n  multiline: 0x1000,\n  password: 0x2000,\n  toggleToOffButton: 0x4000,\n  radioButton: 0x8000,\n  pushButton: 0x10000,\n  combo: 0x20000,\n  edit: 0x40000,\n  sort: 0x80000,\n  multiSelect: 0x200000,\n  noSpell: 0x400000\n};\nconst FIELD_JUSTIFY = {\n  left: 0,\n  center: 1,\n  right: 2\n};\nconst VALUE_MAP = {\n  value: 'V',\n  defaultValue: 'DV'\n};\nconst FORMAT_SPECIAL = {\n  zip: '0',\n  zipPlus4: '1',\n  zip4: '1',\n  phone: '2',\n  ssn: '3'\n};\nconst FORMAT_DEFAULT = {\n  number: {\n    nDec: 0,\n    sepComma: false,\n    negStyle: 'MinusBlack',\n    currency: '',\n    currencyPrepend: true\n  },\n  percent: {\n    nDec: 0,\n    sepComma: false\n  }\n};\nvar AcroFormMixin = {\n  /**\r\n   * Must call if adding AcroForms to a document. Must also call font() before\r\n   * this method to set the default font.\r\n   */\n  initForm() {\n    if (!this._font) {\n      throw new Error('Must set a font before calling initForm method');\n    }\n    this._acroform = {\n      fonts: {},\n      defaultFont: this._font.name\n    };\n    this._acroform.fonts[this._font.id] = this._font.ref();\n    let data = {\n      Fields: [],\n      NeedAppearances: true,\n      DA: new String(`/${this._font.id} 0 Tf 0 g`),\n      DR: {\n        Font: {}\n      }\n    };\n    data.DR.Font[this._font.id] = this._font.ref();\n    const AcroForm = this.ref(data);\n    this._root.data.AcroForm = AcroForm;\n    return this;\n  },\n  /**\r\n   * Called automatically by document.js\r\n   */\n  endAcroForm() {\n    if (this._root.data.AcroForm) {\n      if (!Object.keys(this._acroform.fonts).length && !this._acroform.defaultFont) {\n        throw new Error('No fonts specified for PDF form');\n      }\n      let fontDict = this._root.data.AcroForm.data.DR.Font;\n      Object.keys(this._acroform.fonts).forEach(name => {\n        fontDict[name] = this._acroform.fonts[name];\n      });\n      this._root.data.AcroForm.data.Fields.forEach(fieldRef => {\n        this._endChild(fieldRef);\n      });\n      this._root.data.AcroForm.end();\n    }\n    return this;\n  },\n  _endChild(ref) {\n    if (Array.isArray(ref.data.Kids)) {\n      ref.data.Kids.forEach(childRef => {\n        this._endChild(childRef);\n      });\n      ref.end();\n    }\n    return this;\n  },\n  /**\r\n   * Creates and adds a form field to the document. Form fields are intermediate\r\n   * nodes in a PDF form that are used to specify form name heirarchy and form\r\n   * value defaults.\r\n   * @param {string} name - field name (T attribute in field dictionary)\r\n   * @param {object} options  - other attributes to include in field dictionary\r\n   */\n  formField(name) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    let fieldDict = this._fieldDict(name, null, options);\n    let fieldRef = this.ref(fieldDict);\n    this._addToParent(fieldRef);\n    return fieldRef;\n  },\n  /**\r\n   * Creates and adds a Form Annotation to the document. Form annotations are\r\n   * called Widget annotations internally within a PDF file.\r\n   * @param {string} name - form field name (T attribute of widget annotation\r\n   * dictionary)\r\n   * @param {number} x\r\n   * @param {number} y\r\n   * @param {number} w\r\n   * @param {number} h\r\n   * @param {object} options\r\n   */\n  formAnnotation(name, type, x, y, w, h) {\n    let options = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : {};\n    let fieldDict = this._fieldDict(name, type, options);\n    fieldDict.Subtype = 'Widget';\n    if (fieldDict.F === undefined) {\n      fieldDict.F = 4; // print the annotation\n    }\n\n    // Add Field annot to page, and get it's ref\n    this.annotate(x, y, w, h, fieldDict);\n    let annotRef = this.page.annotations[this.page.annotations.length - 1];\n    return this._addToParent(annotRef);\n  },\n  formText(name, x, y, w, h) {\n    let options = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};\n    return this.formAnnotation(name, 'text', x, y, w, h, options);\n  },\n  formPushButton(name, x, y, w, h) {\n    let options = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};\n    return this.formAnnotation(name, 'pushButton', x, y, w, h, options);\n  },\n  formCombo(name, x, y, w, h) {\n    let options = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};\n    return this.formAnnotation(name, 'combo', x, y, w, h, options);\n  },\n  formList(name, x, y, w, h) {\n    let options = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};\n    return this.formAnnotation(name, 'list', x, y, w, h, options);\n  },\n  formRadioButton(name, x, y, w, h) {\n    let options = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};\n    return this.formAnnotation(name, 'radioButton', x, y, w, h, options);\n  },\n  formCheckbox(name, x, y, w, h) {\n    let options = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};\n    return this.formAnnotation(name, 'checkbox', x, y, w, h, options);\n  },\n  _addToParent(fieldRef) {\n    let parent = fieldRef.data.Parent;\n    if (parent) {\n      if (!parent.data.Kids) {\n        parent.data.Kids = [];\n      }\n      parent.data.Kids.push(fieldRef);\n    } else {\n      this._root.data.AcroForm.data.Fields.push(fieldRef);\n    }\n    return this;\n  },\n  _fieldDict(name, type) {\n    let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    if (!this._acroform) {\n      throw new Error('Call document.initForms() method before adding form elements to document');\n    }\n    let opts = Object.assign({}, options);\n    if (type !== null) {\n      opts = this._resolveType(type, options);\n    }\n    opts = this._resolveFlags(opts);\n    opts = this._resolveJustify(opts);\n    opts = this._resolveFont(opts);\n    opts = this._resolveStrings(opts);\n    opts = this._resolveColors(opts);\n    opts = this._resolveFormat(opts);\n    opts.T = new String(name);\n    if (opts.parent) {\n      opts.Parent = opts.parent;\n      delete opts.parent;\n    }\n    return opts;\n  },\n  _resolveType(type, opts) {\n    if (type === 'text') {\n      opts.FT = 'Tx';\n    } else if (type === 'pushButton') {\n      opts.FT = 'Btn';\n      opts.pushButton = true;\n    } else if (type === 'radioButton') {\n      opts.FT = 'Btn';\n      opts.radioButton = true;\n    } else if (type === 'checkbox') {\n      opts.FT = 'Btn';\n    } else if (type === 'combo') {\n      opts.FT = 'Ch';\n      opts.combo = true;\n    } else if (type === 'list') {\n      opts.FT = 'Ch';\n    } else {\n      throw new Error(`Invalid form annotation type '${type}'`);\n    }\n    return opts;\n  },\n  _resolveFormat(opts) {\n    const f = opts.format;\n    if (f && f.type) {\n      let fnKeystroke;\n      let fnFormat;\n      let params = '';\n      if (FORMAT_SPECIAL[f.type] !== undefined) {\n        fnKeystroke = `AFSpecial_Keystroke`;\n        fnFormat = `AFSpecial_Format`;\n        params = FORMAT_SPECIAL[f.type];\n      } else {\n        let format = f.type.charAt(0).toUpperCase() + f.type.slice(1);\n        fnKeystroke = `AF${format}_Keystroke`;\n        fnFormat = `AF${format}_Format`;\n        if (f.type === 'date') {\n          fnKeystroke += 'Ex';\n          params = String(f.param);\n        } else if (f.type === 'time') {\n          params = String(f.param);\n        } else if (f.type === 'number') {\n          let p = Object.assign({}, FORMAT_DEFAULT.number, f);\n          params = String([String(p.nDec), p.sepComma ? '0' : '1', '\"' + p.negStyle + '\"', 'null', '\"' + p.currency + '\"', String(p.currencyPrepend)].join(','));\n        } else if (f.type === 'percent') {\n          let p = Object.assign({}, FORMAT_DEFAULT.percent, f);\n          params = String([String(p.nDec), p.sepComma ? '0' : '1'].join(','));\n        }\n      }\n      opts.AA = opts.AA ? opts.AA : {};\n      opts.AA.K = {\n        S: 'JavaScript',\n        JS: new String(`${fnKeystroke}(${params});`)\n      };\n      opts.AA.F = {\n        S: 'JavaScript',\n        JS: new String(`${fnFormat}(${params});`)\n      };\n    }\n    delete opts.format;\n    return opts;\n  },\n  _resolveColors(opts) {\n    let color = this._normalizeColor(opts.backgroundColor);\n    if (color) {\n      if (!opts.MK) {\n        opts.MK = {};\n      }\n      opts.MK.BG = color;\n    }\n    color = this._normalizeColor(opts.borderColor);\n    if (color) {\n      if (!opts.MK) {\n        opts.MK = {};\n      }\n      opts.MK.BC = color;\n    }\n    delete opts.backgroundColor;\n    delete opts.borderColor;\n    return opts;\n  },\n  _resolveFlags(options) {\n    let result = 0;\n    Object.keys(options).forEach(key => {\n      if (FIELD_FLAGS[key]) {\n        if (options[key]) {\n          result |= FIELD_FLAGS[key];\n        }\n        delete options[key];\n      }\n    });\n    if (result !== 0) {\n      options.Ff = options.Ff ? options.Ff : 0;\n      options.Ff |= result;\n    }\n    return options;\n  },\n  _resolveJustify(options) {\n    let result = 0;\n    if (options.align !== undefined) {\n      if (typeof FIELD_JUSTIFY[options.align] === 'number') {\n        result = FIELD_JUSTIFY[options.align];\n      }\n      delete options.align;\n    }\n    if (result !== 0) {\n      options.Q = result; // default\n    }\n    return options;\n  },\n  _resolveFont(options) {\n    // add current font to document-level AcroForm dict if necessary\n    if (this._acroform.fonts[this._font.id] === null) {\n      this._acroform.fonts[this._font.id] = this._font.ref();\n    }\n\n    // add current font to field's resource dict (RD) if not the default acroform font\n    if (this._acroform.defaultFont !== this._font.name) {\n      options.DR = {\n        Font: {}\n      };\n\n      // Get the fontSize option. If not set use auto sizing\n      const fontSize = options.fontSize || 0;\n      options.DR.Font[this._font.id] = this._font.ref();\n      options.DA = new String(`/${this._font.id} ${fontSize} Tf 0 g`);\n    }\n    return options;\n  },\n  _resolveStrings(options) {\n    let select = [];\n    function appendChoices(a) {\n      if (Array.isArray(a)) {\n        for (let idx = 0; idx < a.length; idx++) {\n          if (typeof a[idx] === 'string') {\n            select.push(new String(a[idx]));\n          } else {\n            select.push(a[idx]);\n          }\n        }\n      }\n    }\n    appendChoices(options.Opt);\n    if (options.select) {\n      appendChoices(options.select);\n      delete options.select;\n    }\n    if (select.length) {\n      options.Opt = select;\n    }\n    Object.keys(VALUE_MAP).forEach(key => {\n      if (options[key] !== undefined) {\n        options[VALUE_MAP[key]] = options[key];\n        delete options[key];\n      }\n    });\n    ['V', 'DV'].forEach(key => {\n      if (typeof options[key] === 'string') {\n        options[key] = new String(options[key]);\n      }\n    });\n    if (options.MK && options.MK.CA) {\n      options.MK.CA = new String(options.MK.CA);\n    }\n    if (options.label) {\n      options.MK = options.MK ? options.MK : {};\n      options.MK.CA = new String(options.label);\n      delete options.label;\n    }\n    return options;\n  }\n};\nvar AttachmentsMixin = {\n  /**\r\n   * Embed contents of `src` in PDF\r\n   * @param {Buffer | ArrayBuffer | string} src input Buffer, ArrayBuffer, base64 encoded string or path to file\r\n   * @param {object} options\r\n   *  * options.name: filename to be shown in PDF, will use `src` if none set\r\n   *  * options.type: filetype to be shown in PDF\r\n   *  * options.description: description to be shown in PDF\r\n   *  * options.hidden: if true, do not add attachment to EmbeddedFiles dictionary. Useful for file attachment annotations\r\n   *  * options.creationDate: override creation date\r\n   *  * options.modifiedDate: override modified date\r\n   * @returns filespec reference\r\n   */\n  file(src) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    options.name = options.name || src;\n    const refBody = {\n      Type: 'EmbeddedFile',\n      Params: {}\n    };\n    let data;\n    if (!src) {\n      throw new Error('No src specified');\n    }\n    if (Buffer.isBuffer(src)) {\n      data = src;\n    } else if (src instanceof ArrayBuffer) {\n      data = Buffer.from(new Uint8Array(src));\n    } else {\n      let match;\n      if (match = /^data:(.*?);base64,(.*)$/.exec(src)) {\n        if (match[1]) {\n          refBody.Subtype = match[1].replace('/', '#2F');\n        }\n        data = Buffer.from(match[2], 'base64');\n      } else {\n        data = fs.readFileSync(src);\n        if (!data) {\n          throw new Error(`Could not read contents of file at filepath ${src}`);\n        }\n\n        // update CreationDate and ModDate\n        const {\n          birthtime,\n          ctime\n        } = fs.statSync(src);\n        refBody.Params.CreationDate = birthtime;\n        refBody.Params.ModDate = ctime;\n      }\n    }\n\n    // override creation date and modified date\n    if (options.creationDate instanceof Date) {\n      refBody.Params.CreationDate = options.creationDate;\n    }\n    if (options.modifiedDate instanceof Date) {\n      refBody.Params.ModDate = options.modifiedDate;\n    }\n    // add optional subtype\n    if (options.type) {\n      refBody.Subtype = options.type.replace('/', '#2F');\n    }\n\n    // add checksum and size information\n    const checksum = CryptoJS.MD5(CryptoJS.lib.WordArray.create(new Uint8Array(data)));\n    refBody.Params.CheckSum = new String(checksum);\n    refBody.Params.Size = data.byteLength;\n\n    // save some space when embedding the same file again\n    // if a file with the same name and metadata exists, reuse its reference\n    let ref;\n    if (!this._fileRegistry) this._fileRegistry = {};\n    let file = this._fileRegistry[options.name];\n    if (file && isEqual(refBody, file)) {\n      ref = file.ref;\n    } else {\n      ref = this.ref(refBody);\n      ref.end(data);\n      this._fileRegistry[options.name] = {\n        ...refBody,\n        ref\n      };\n    }\n    // add filespec for embedded file\n    const fileSpecBody = {\n      Type: 'Filespec',\n      F: new String(options.name),\n      EF: {\n        F: ref\n      },\n      UF: new String(options.name)\n    };\n    if (options.description) {\n      fileSpecBody.Desc = new String(options.description);\n    }\n    const filespec = this.ref(fileSpecBody);\n    filespec.end();\n    if (!options.hidden) {\n      this.addNamedEmbeddedFile(options.name, filespec);\n    }\n    return filespec;\n  }\n};\n\n/** check two embedded file metadata objects for equality */\nfunction isEqual(a, b) {\n  return a.Subtype === b.Subtype && a.Params.CheckSum.toString() === b.Params.CheckSum.toString() && a.Params.Size === b.Params.Size && a.Params.CreationDate === b.Params.CreationDate && a.Params.ModDate === b.Params.ModDate;\n}\nvar PDFA = {\n  initPDFA(pSubset) {\n    if (pSubset.charAt(pSubset.length - 3) === '-') {\n      this.subset_conformance = pSubset.charAt(pSubset.length - 1).toUpperCase();\n      this.subset = parseInt(pSubset.charAt(pSubset.length - 2));\n    } else {\n      // Default to Basic conformance when user doesn't specify\n      this.subset_conformance = 'B';\n      this.subset = parseInt(pSubset.charAt(pSubset.length - 1));\n    }\n  },\n  endSubset() {\n    this._addPdfaMetadata();\n    this._addColorOutputIntent(`${__dirname}/data/sRGB_IEC61966_2_1.icc`);\n  },\n  _addColorOutputIntent(pICCPath) {\n    const iccProfile = fs.readFileSync(pICCPath);\n    const colorProfileRef = this.ref({\n      Length: iccProfile.length,\n      N: 3\n    });\n    colorProfileRef.write(iccProfile);\n    colorProfileRef.end();\n    const intentRef = this.ref({\n      Type: 'OutputIntent',\n      S: 'GTS_PDFA1',\n      Info: new String('sRGB IEC61966-2.1'),\n      OutputConditionIdentifier: new String('sRGB IEC61966-2.1'),\n      DestOutputProfile: colorProfileRef\n    });\n    intentRef.end();\n    this._root.data.OutputIntents = [intentRef];\n  },\n  _getPdfaid() {\n    return `\n        <rdf:Description xmlns:pdfaid=\"http://www.aiim.org/pdfa/ns/id/\" rdf:about=\"\">\n            <pdfaid:part>${this.subset}</pdfaid:part>\n            <pdfaid:conformance>${this.subset_conformance}</pdfaid:conformance>\n        </rdf:Description>\n        `;\n  },\n  _addPdfaMetadata() {\n    this.appendXML(this._getPdfaid());\n  }\n};\nvar PDFUA = {\n  initPDFUA() {\n    this.subset = 1;\n  },\n  endSubset() {\n    this._addPdfuaMetadata();\n  },\n  _addPdfuaMetadata() {\n    this.appendXML(this._getPdfuaid());\n  },\n  _getPdfuaid() {\n    return `\n        <rdf:Description xmlns:pdfuaid=\"http://www.aiim.org/pdfua/ns/id/\" rdf:about=\"\">\n            <pdfuaid:part>${this.subset}</pdfuaid:part>\n        </rdf:Description>\n        `;\n  }\n};\nvar SubsetMixin = {\n  _importSubset(subset) {\n    Object.assign(this, subset);\n  },\n  initSubset(options) {\n    switch (options.subset) {\n      case 'PDF/A-1':\n      case 'PDF/A-1a':\n      case 'PDF/A-1b':\n      case 'PDF/A-2':\n      case 'PDF/A-2a':\n      case 'PDF/A-2b':\n      case 'PDF/A-3':\n      case 'PDF/A-3a':\n      case 'PDF/A-3b':\n        this._importSubset(PDFA);\n        this.initPDFA(options.subset);\n        break;\n      case 'PDF/UA':\n        this._importSubset(PDFUA);\n        this.initPDFUA();\n        break;\n    }\n  }\n};\nclass PDFMetadata {\n  constructor() {\n    this._metadata = `\n        <?xpacket begin=\"\\ufeff\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?>\n            <x:xmpmeta xmlns:x=\"adobe:ns:meta/\">\n                <rdf:RDF xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\">\n        `;\n  }\n  _closeTags() {\n    this._metadata = this._metadata.concat(`\n                </rdf:RDF>\n            </x:xmpmeta>\n        <?xpacket end=\"w\"?>\n        `);\n  }\n  append(xml) {\n    let newline = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    this._metadata = this._metadata.concat(xml);\n    if (newline) this._metadata = this._metadata.concat('\\n');\n  }\n  getXML() {\n    return this._metadata;\n  }\n  getLength() {\n    return this._metadata.length;\n  }\n  end() {\n    this._closeTags();\n    this._metadata = this._metadata.trim();\n  }\n}\nvar MetadataMixin = {\n  initMetadata() {\n    this.metadata = new PDFMetadata();\n  },\n  appendXML(xml) {\n    let newline = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    this.metadata.append(xml, newline);\n  },\n  _addInfo() {\n    this.appendXML(`\n        <rdf:Description rdf:about=\"\" xmlns:xmp=\"http://ns.adobe.com/xap/1.0/\">\n            <xmp:CreateDate>${this.info.CreationDate.toISOString().split('.')[0] + \"Z\"}</xmp:CreateDate>\n            <xmp:CreatorTool>${this.info.Creator}</xmp:CreatorTool>\n        </rdf:Description>\n        `);\n    if (this.info.Title || this.info.Author || this.info.Subject) {\n      this.appendXML(`\n            <rdf:Description rdf:about=\"\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\">\n            `);\n      if (this.info.Title) {\n        this.appendXML(`\n                <dc:title>\n                    <rdf:Alt>\n                        <rdf:li xml:lang=\"x-default\">${this.info.Title}</rdf:li>\n                    </rdf:Alt>\n                </dc:title>\n                `);\n      }\n      if (this.info.Author) {\n        this.appendXML(`\n                <dc:creator>\n                    <rdf:Seq>\n                        <rdf:li>${this.info.Author}</rdf:li>\n                    </rdf:Seq>\n                </dc:creator>\n                `);\n      }\n      if (this.info.Subject) {\n        this.appendXML(`\n                <dc:description>\n                    <rdf:Alt>\n                        <rdf:li xml:lang=\"x-default\">${this.info.Subject}</rdf:li>\n                    </rdf:Alt>\n                </dc:description>\n                `);\n      }\n      this.appendXML(`\n            </rdf:Description>\n            `);\n    }\n    this.appendXML(`\n        <rdf:Description rdf:about=\"\" xmlns:pdf=\"http://ns.adobe.com/pdf/1.3/\">\n            <pdf:Producer>${this.info.Creator}</pdf:Producer>`, false);\n    if (this.info.Keywords) {\n      this.appendXML(`\n            <pdf:Keywords>${this.info.Keywords}</pdf:Keywords>`, false);\n    }\n    this.appendXML(`\n        </rdf:Description>\n        `);\n  },\n  endMetadata() {\n    this._addInfo();\n    this.metadata.end();\n\n    /*\r\n    Metadata was introduced in PDF 1.4, so adding it to 1.3 \r\n    will likely only take up more space.\r\n    */\n    if (this.version != 1.3) {\n      this.metadataRef = this.ref({\n        length: this.metadata.getLength(),\n        Type: 'Metadata',\n        Subtype: 'XML'\n      });\n      this.metadataRef.compress = false;\n      this.metadataRef.write(Buffer.from(this.metadata.getXML(), 'utf-8'));\n      this.metadataRef.end();\n      this._root.data.Metadata = this.metadataRef;\n    }\n  }\n};\n\n/*\r\nPDFDocument - represents an entire PDF document\r\nBy Devon Govett\r\n*/\nclass PDFDocument extends stream.Readable {\n  constructor() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    super(options);\n    this.options = options;\n\n    // PDF version\n    switch (options.pdfVersion) {\n      case '1.4':\n        this.version = 1.4;\n        break;\n      case '1.5':\n        this.version = 1.5;\n        break;\n      case '1.6':\n        this.version = 1.6;\n        break;\n      case '1.7':\n      case '1.7ext3':\n        this.version = 1.7;\n        break;\n      default:\n        this.version = 1.3;\n        break;\n    }\n\n    // Whether streams should be compressed\n    this.compress = this.options.compress != null ? this.options.compress : true;\n    this._pageBuffer = [];\n    this._pageBufferStart = 0;\n\n    // The PDF object store\n    this._offsets = [];\n    this._waiting = 0;\n    this._ended = false;\n    this._offset = 0;\n    const Pages = this.ref({\n      Type: 'Pages',\n      Count: 0,\n      Kids: []\n    });\n    const Names = this.ref({\n      Dests: new PDFNameTree()\n    });\n    this._root = this.ref({\n      Type: 'Catalog',\n      Pages,\n      Names\n    });\n    if (this.options.lang) {\n      this._root.data.Lang = new String(this.options.lang);\n    }\n\n    // The current page\n    this.page = null;\n\n    // Initialize mixins\n    this.initMetadata();\n    this.initColor();\n    this.initVector();\n    this.initFonts(options.font);\n    this.initText();\n    this.initImages();\n    this.initOutline();\n    this.initMarkings(options);\n    this.initSubset(options);\n\n    // Initialize the metadata\n    this.info = {\n      Producer: 'PDFKit',\n      Creator: 'PDFKit',\n      CreationDate: new Date()\n    };\n    if (this.options.info) {\n      for (let key in this.options.info) {\n        const val = this.options.info[key];\n        this.info[key] = val;\n      }\n    }\n    if (this.options.displayTitle) {\n      this._root.data.ViewerPreferences = this.ref({\n        DisplayDocTitle: true\n      });\n    }\n\n    // Generate file ID\n    this._id = PDFSecurity.generateFileID(this.info);\n\n    // Initialize security settings\n    this._security = PDFSecurity.create(this, options);\n\n    // Write the header\n    // PDF version\n    this._write(`%PDF-${this.version}`);\n\n    // 4 binary chars, as recommended by the spec\n    this._write('%\\xFF\\xFF\\xFF\\xFF');\n\n    // Add the first page\n    if (this.options.autoFirstPage !== false) {\n      this.addPage();\n    }\n  }\n  addPage(options) {\n    if (options == null) {\n      ({\n        options\n      } = this);\n    }\n\n    // end the current page if needed\n    if (!this.options.bufferPages) {\n      this.flushPages();\n    }\n\n    // create a page object\n    this.page = new PDFPage(this, options);\n    this._pageBuffer.push(this.page);\n\n    // add the page to the object store\n    const pages = this._root.data.Pages.data;\n    pages.Kids.push(this.page.dictionary);\n    pages.Count++;\n\n    // reset x and y coordinates\n    this.x = this.page.margins.left;\n    this.y = this.page.margins.top;\n\n    // flip PDF coordinate system so that the origin is in\n    // the top left rather than the bottom left\n    this._ctm = [1, 0, 0, 1, 0, 0];\n    this.transform(1, 0, 0, -1, 0, this.page.height);\n    this.emit('pageAdded');\n    return this;\n  }\n  continueOnNewPage(options) {\n    const pageMarkings = this.endPageMarkings(this.page);\n    this.addPage(options);\n    this.initPageMarkings(pageMarkings);\n    return this;\n  }\n  bufferedPageRange() {\n    return {\n      start: this._pageBufferStart,\n      count: this._pageBuffer.length\n    };\n  }\n  switchToPage(n) {\n    let page;\n    if (!(page = this._pageBuffer[n - this._pageBufferStart])) {\n      throw new Error(`switchToPage(${n}) out of bounds, current buffer covers pages ${this._pageBufferStart} to ${this._pageBufferStart + this._pageBuffer.length - 1}`);\n    }\n    return this.page = page;\n  }\n  flushPages() {\n    // this local variable exists so we're future-proof against\n    // reentrant calls to flushPages.\n    const pages = this._pageBuffer;\n    this._pageBuffer = [];\n    this._pageBufferStart += pages.length;\n    for (let page of pages) {\n      this.endPageMarkings(page);\n      page.end();\n    }\n  }\n  addNamedDestination(name) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n    if (args.length === 0) {\n      args = ['XYZ', null, null, null];\n    }\n    if (args[0] === 'XYZ' && args[2] !== null) {\n      args[2] = this.page.height - args[2];\n    }\n    args.unshift(this.page.dictionary);\n    this._root.data.Names.data.Dests.add(name, args);\n  }\n  addNamedEmbeddedFile(name, ref) {\n    if (!this._root.data.Names.data.EmbeddedFiles) {\n      // disabling /Limits for this tree fixes attachments not showing in Adobe Reader\n      this._root.data.Names.data.EmbeddedFiles = new PDFNameTree({\n        limits: false\n      });\n    }\n\n    // add filespec to EmbeddedFiles\n    this._root.data.Names.data.EmbeddedFiles.add(name, ref);\n  }\n  addNamedJavaScript(name, js) {\n    if (!this._root.data.Names.data.JavaScript) {\n      this._root.data.Names.data.JavaScript = new PDFNameTree();\n    }\n    let data = {\n      JS: new String(js),\n      S: 'JavaScript'\n    };\n    this._root.data.Names.data.JavaScript.add(name, data);\n  }\n  ref(data) {\n    const ref = new PDFReference(this, this._offsets.length + 1, data);\n    this._offsets.push(null); // placeholder for this object's offset once it is finalized\n    this._waiting++;\n    return ref;\n  }\n  _read() {}\n  // do nothing, but this method is required by node\n\n  _write(data) {\n    if (!Buffer.isBuffer(data)) {\n      data = Buffer.from(data + '\\n', 'binary');\n    }\n    this.push(data);\n    return this._offset += data.length;\n  }\n  addContent(data) {\n    this.page.write(data);\n    return this;\n  }\n  _refEnd(ref) {\n    this._offsets[ref.id - 1] = ref.offset;\n    if (--this._waiting === 0 && this._ended) {\n      this._finalize();\n      return this._ended = false;\n    }\n  }\n  end() {\n    this.flushPages();\n    this._info = this.ref();\n    for (let key in this.info) {\n      let val = this.info[key];\n      if (typeof val === 'string') {\n        val = new String(val);\n      }\n      let entry = this.ref(val);\n      entry.end();\n      this._info.data[key] = entry;\n    }\n    this._info.end();\n    for (let name in this._fontFamilies) {\n      const font = this._fontFamilies[name];\n      font.finalize();\n    }\n    this.endOutline();\n    this.endMarkings();\n    if (this.subset) {\n      this.endSubset();\n    }\n    this.endMetadata();\n    this._root.end();\n    this._root.data.Pages.end();\n    this._root.data.Names.end();\n    this.endAcroForm();\n    if (this._root.data.ViewerPreferences) {\n      this._root.data.ViewerPreferences.end();\n    }\n    if (this._security) {\n      this._security.end();\n    }\n    if (this._waiting === 0) {\n      return this._finalize();\n    } else {\n      return this._ended = true;\n    }\n  }\n  _finalize() {\n    // generate xref\n    const xRefOffset = this._offset;\n    this._write('xref');\n    this._write(`0 ${this._offsets.length + 1}`);\n    this._write('0000000000 65535 f ');\n    for (let offset of this._offsets) {\n      offset = `0000000000${offset}`.slice(-10);\n      this._write(offset + ' 00000 n ');\n    }\n\n    // trailer\n    const trailer = {\n      Size: this._offsets.length + 1,\n      Root: this._root,\n      Info: this._info,\n      ID: [this._id, this._id]\n    };\n    if (this._security) {\n      trailer.Encrypt = this._security.dictionary;\n    }\n    this._write('trailer');\n    this._write(PDFObject.convert(trailer));\n    this._write('startxref');\n    this._write(`${xRefOffset}`);\n    this._write('%%EOF');\n\n    // end the stream\n    return this.push(null);\n  }\n  toString() {\n    return '[object PDFDocument]';\n  }\n}\nconst mixin = methods => {\n  Object.assign(PDFDocument.prototype, methods);\n};\nmixin(MetadataMixin);\nmixin(ColorMixin);\nmixin(VectorMixin);\nmixin(FontsMixin);\nmixin(TextMixin);\nmixin(ImagesMixin);\nmixin(AnnotationsMixin);\nmixin(OutlineMixin);\nmixin(MarkingsMixin);\nmixin(AcroFormMixin);\nmixin(AttachmentsMixin);\nmixin(SubsetMixin);\nPDFDocument.LineWrapper = LineWrapper;\nexport default PDFDocument;","map":{"version":3,"names":["PDFAbstractReference","toString","Error","PDFTree","constructor","options","arguments","length","undefined","_items","limits","add","key","val","get","sortedKeys","Object","keys","sort","a","b","_compareKeys","out","first","last","push","PDFObject","convert","_dataForKey","_keysName","join","pad","str","Array","slice","escapableRe","escapable","swapBytes","buff","l","i","end","object","encryptFn","String","string","isUnicode","charCodeAt","stringBuffer","Buffer","from","valueOf","replace","c","isBuffer","Date","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","isArray","items","map","e","call","number","n","Math","round","PDFReference","document","id","data","gen","compress","Filter","uncompressedLength","buffer","write","chunk","Length","finalize","offset","_offset","_security","getEncryptFn","concat","zlib","deflateSync","_write","_refEnd","DEFAULT_MARGINS","top","left","bottom","right","SIZES","A0","A1","A2","A3","A4","A5","A6","A7","A8","A9","A10","B0","B1","B2","B3","B4","B5","B6","B7","B8","B9","B10","C0","C1","C2","C3","C4","C5","C6","C7","C8","C9","C10","RA0","RA1","RA2","RA3","RA4","SRA0","SRA1","SRA2","SRA3","SRA4","EXECUTIVE","FOLIO","LEGAL","LETTER","TABLOID","PDFPage","size","layout","margin","margins","dimensions","toUpperCase","width","height","content","ref","resources","ProcSet","dictionary","Type","Parent","_root","Pages","MediaBox","Contents","Resources","markings","fonts","Font","xobjects","XObject","ext_gstates","ExtGState","patterns","Pattern","colorSpaces","ColorSpace","annotations","Annots","structParentTreeKey","StructParents","createStructParentTreeNextKey","maxY","PDFNameTree","localeCompare","k","inRange","value","rangeGroup","startRange","endRange","middleRange","floor","arrayIndex","unassigned_code_points","isUnassignedCodePoint","character","commonly_mapped_to_nothing","isCommonlyMappedToNothing","non_ASCII_space_characters","isNonASCIISpaceCharacter","non_ASCII_controls_characters","non_character_codepoints","prohibited_characters","isProhibitedCharacter","bidirectional_r_al","isBidirectionalRAL","bidirectional_l","isBidirectionalL","mapping2space","mapping2nothing","getCodePoint","codePointAt","x","toCodePoints","input","codepoints","before","next","saslprep","opts","TypeError","mapped_input","filter","normalized_input","fromCodePoint","apply","normalize","normalized_map","hasProhibited","some","allowUnassigned","hasUnassigned","hasBidiRAL","hasBidiL","isFirstBidiRAL","isLastBidiRAL","PDFSecurity","generateFileID","info","infoStr","CreationDate","getTime","hasOwnProperty","wordArrayToBuffer","CryptoJS","MD5","generateRandomWordArray","bytes","lib","WordArray","random","create","ownerPassword","userPassword","_setupEncryption","pdfVersion","version","encDict","_setupEncryptionV1V2V4","_setupEncryptionV5","v","r","permissions","keyBits","getPermissionsR2","getPermissionsR3","paddedUserPassword","processPasswordR2R3R4","paddedOwnerPassword","ownerPasswordEntry","getOwnerPasswordR2R3R4","encryptionKey","getEncryptionKeyR2R3R4","_id","userPasswordEntry","getUserPasswordR2","getUserPasswordR3R4","V","CF","StdCF","AuthEvent","CFM","StmF","StrF","R","O","U","P","processedUserPassword","processPasswordR5","processedOwnerPassword","getEncryptionKeyR5","getUserPasswordR5","userKeySalt","words","userEncryptionKeyEntry","getUserEncryptionKeyR5","getOwnerPasswordR5","ownerKeySalt","ownerEncryptionKeyEntry","getOwnerEncryptionKeyR5","permsEntry","getEncryptedPermissionsR5","OE","UE","Perms","obj","digest","clone","sigBytes","min","RC4","encrypt","ciphertext","iv","mode","CBC","padding","Pkcs7","AES","permissionObject","printing","modifying","copying","annotating","fillingForms","contentAccessibility","documentAssembly","documentId","cipher","xorRound","ceil","j","lsbFirstWord","validationSalt","keySalt","SHA256","NoPadding","ECB","password","alloc","index","code","PASSWORD_PADDING","unescape","encodeURIComponent","wordArray","byteArray","PDFGradient","doc","stops","embedded","transform","stop","pos","color","opacity","_normalizeColor","_colorSpace","max","setTransform","m11","m12","m21","m22","dx","dy","embed","m","fn","stopsLength","matrix","bounds","encode","FunctionType","Domain","N","Functions","Bounds","Encode","_gradCount","shader","pattern","PatternType","Shading","Matrix","grad","opacityGradient","pageBBox","page","form","Subtype","FormType","BBox","Group","S","CS","Sh1","gstate","SMask","G","opacityPattern","PaintType","TilingType","XStep","YStep","Gs1","stroke","m0","m1","m2","m3","m4","m5","_ctm","_setColorSpace","op","addContent","PDFLinearGradient","x1","y1","x2","y2","ShadingType","Coords","Function","Extend","PDFRadialGradient","r1","r2","Gradient","underlyingColorSpaces","PDFTilingPattern","bBox","xStep","yStep","stream","createPattern","toFixed","embedPatternColorSpaces","forEach","csName","csId","getPatternColorSpaceId","cs","underlyingColorspace","_patternCount","patternColor","normalizedColor","_getColorSpace","PDFGradient$1","PDFLinearGradient$1","PDFRadialGradient$1","PDFTilingPattern$1","ColorMixin","initColor","_opacityRegistry","_opacityCount","charAt","hex","parseInt","namedColors","part","_setColor","_setColorCore","space","fillColor","set","fillOpacity","_fillColor","strokeColor","strokeOpacity","_doOpacity","name","ca","CA","linearGradient","radialGradient","bbox","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","cx","cy","px","py","sx","sy","parameters","A","C","H","h","L","M","Q","q","s","T","t","Z","z","parse","path","cmd","ret","args","curArg","foundDecimal","params","includes","commands","runners","moveTo","bezierCurveTo","quadraticCurveTo","solveArc","lineTo","closePath","y","coords","rx","ry","rot","large","sweep","ex","ey","segs","arcToSegments","seg","bez","segmentToBezier","rotateX","ox","oy","th","PI","sin_th","sin","cos_th","cos","abs","pl","sqrt","a00","a01","a10","a11","x0","y0","d","sfactor_sq","sfactor","xc","yc","th0","atan2","th1","th_arc","segments","result","th2","th3","th_half","x3","y3","SVGPath","number$1","KAPPA","VectorMixin","initVector","_ctmStack","save","restore","pop","lineWidth","w","_CAP_STYLES","BUTT","ROUND","SQUARE","lineCap","_JOIN_STYLES","MITER","BEVEL","lineJoin","miterLimit","dash","originalLength","valid","every","Number","isFinite","JSON","stringify","phase","undash","cp1x","cp1y","cp2x","cp2y","cpx","cpy","rect","roundedRect","ellipse","xe","ye","xm","ym","circle","radius","arc","startAngle","endAngle","anticlockwise","TWO_PI","HALF_PI","deltaAng","dir","numSegs","segAng","handleLen","curAng","deltaCx","deltaCy","ax","ay","segIdx","polygon","_len","points","_key","shift","point","_windingRule","rule","test","fill","fillAndStroke","isFillRule","clip","values","translate","rotate","angle","rad","origin","scale","xFactor","yFactor","WIN_ANSI_MAP","characters","split","AFMFont","open","filename","fs","readFileSync","contents","attributes","glyphWidths","boundingBoxes","kernPairs","charWidths","char","ascender","descender","xHeight","capHeight","lineGap","section","line","match","encodeText","text","res","len","glyphsForString","glyphs","charCode","characterToGlyph","widthOfGlyph","glyph","getKernPair","advancesForGlyphs","advances","PDFFont","widthOfString","lineHeight","includeGap","gap","STANDARD_FONTS","Courier","__dirname","Courier-Bold","Courier-Oblique","Courier-BoldOblique","Helvetica","Helvetica-Bold","Helvetica-Oblique","Helvetica-BoldOblique","Times-Roman","Times-Bold","Times-Italic","Times-BoldItalic","Symbol","ZapfDingbats","StandardFont","font","BaseFont","Encoding","encoded","positions","xAdvance","yAdvance","xOffset","yOffset","advanceWidth","advance","isStandardFont","toHex","num","EmbeddedFont","subset","createSubset","unicode","widths","getGlyph","postscriptName","unitsPerEm","ascent","descent","fontLayoutCache","layoutCache","layoutRun","features","run","position","layoutCached","cached","onlyWidth","needle","gid","includeGlyph","codePoints","isCFF","cff","fontFile","encodeStream","on","familyClass","sFamilyClass","flags","post","isFixedPitch","head","macStyle","italic","tag","fromCharCode","descriptor","FontName","Flags","FontBBox","minX","minY","maxX","ItalicAngle","italicAngle","Ascent","Descent","CapHeight","XHeight","StemV","FontFile3","FontFile2","CIDSet","CIDSetRef","descendantFontData","CIDSystemInfo","Registry","Ordering","Supplement","FontDescriptor","W","CIDToGIDMap","descendantFont","DescendantFonts","ToUnicode","toUnicodeCmap","cmap","entries","chunkSize","chunks","ranges","start","PDFFontFactory","src","family","fontkit","Uint8Array","ArrayBuffer","FontsMixin","initFonts","defaultFont","_fontFamilies","_fontCount","_fontSize","_font","_registeredFonts","cacheKey","fontSize","currentLineHeight","registerFont","SOFT_HYPHEN","HYPHEN","LineWrapper","EventEmitter","indent","characterSpacing","wordSpacing","columns","columnGap","spaceLeft","startX","startY","column","ellipsis","continuedX","once","continued","align","lastLine","paragraphGap","wordWidth","word","canFit","eachWord","bk","breaker","LineBreaker","wordWidths","nextBreak","shouldContinue","lbk","fbk","mightGrow","mustShrink","required","wrap","nextY","nextSection","textWidth","wc","lc","emitLine","wordCount","emit","lh","continueOnNewPage","number$2","TextMixin","initText","_line","bind","_lineGap","moveDown","lines","moveUp","_text","lineCallback","_initOptions","addStructure","structParent","struct","structType","markStructureContent","wrapper","_wrapper","_textOptions","heightOfString","Infinity","list","listType","unit","midLine","bulletRadius","textIndent","itemIndent","bulletIndent","level","levels","numbers","flatten","item","label","letter","times","drawListItem","listItem","itemType","labelType","bodyType","structTypes","diff","_fragment","assign","lineBreak","trim","spaceWidth","baseline","renderedWidth","link","goTo","destination","addNamedDestination","underline","lineY","strike","oblique","skew","encodedWord","positionsWord","hadOffset","addSegment","cur","flush","MARKERS","COLOR_SPACE_MAP","JPEG","marker","readUInt16BE","orientation","exif","fromBuffer","Orientation","bits","channels","colorSpace","BitsPerComponent","Width","Height","PNGImage","image","PNG","imgData","dataDecoded","hasAlphaChannel","isInterlaced","interlaceMethod","Predictor","Colors","colors","Columns","palette","transparency","grayscale","rgb","mask","indexed","loadIndexedAlphaChannel","splitAlphaChannel","decodeData","alphaChannel","sMask","Decode","decodePixels","pixels","p","colorCount","pixelCount","skipByteCount","colorIndex","PDFImage","exec","ImagesMixin","initImages","_imageRegistry","_imageCount","bh","bp","bw","ip","left1","rotateAngle","originX","originY","ignoreOrientation","openImage","wp","hp","fit","cover","valign","AnnotationsMixin","annotate","Rect","_convertRect","Border","F","Dest","note","Name","D","url","pages","Kids","URI","_markup","QuadPoints","highlight","lineAnnotation","rectAnnotation","ellipseAnnotation","textAnnotation","DA","fileAnnotation","file","filespec","hidden","FS","Desc","PDFOutline","parent","title","dest","expanded","outlineData","children","addItem","endOutline","Count","First","Last","child","Prev","Next","OutlineMixin","initOutline","outline","Outlines","PageMode","PDFStructureContent","pageRef","mcid","refs","structContent","PDFStructureElement","type","_attached","_ended","_flushed","_isValidChild","lang","Lang","alt","Alt","E","actual","ActualText","_children","setParent","setAttached","_addContentToParentTree","_contentForClosure","_ref","pageStructParents","getStructParentTree","parentRef","_flush","closure","endMarkedContent","_isFlushable","K","_flushChild","_ref2","Pg","MCID","PDFNumberTree","MarkingsMixin","initMarkings","structChildren","tagged","getMarkInfoDictionary","Marked","getStructTreeRoot","markContent","toClose","marking","attached","Attached","structElem","structTreeRoot","initPageMarkings","pageMarkings","newStructContent","endPageMarkings","MarkInfo","StructTreeRoot","ParentTree","ParentTreeNextKey","endMarkings","FIELD_FLAGS","readOnly","noExport","multiline","toggleToOffButton","radioButton","pushButton","combo","edit","multiSelect","noSpell","FIELD_JUSTIFY","center","VALUE_MAP","defaultValue","FORMAT_SPECIAL","zip","zipPlus4","zip4","phone","ssn","FORMAT_DEFAULT","nDec","sepComma","negStyle","currency","currencyPrepend","percent","AcroFormMixin","initForm","_acroform","Fields","NeedAppearances","DR","AcroForm","endAcroForm","fontDict","fieldRef","_endChild","childRef","formField","fieldDict","_fieldDict","_addToParent","formAnnotation","annotRef","formText","formPushButton","formCombo","formList","formRadioButton","formCheckbox","_resolveType","_resolveFlags","_resolveJustify","_resolveFont","_resolveStrings","_resolveColors","_resolveFormat","FT","f","format","fnKeystroke","fnFormat","param","AA","JS","backgroundColor","MK","BG","borderColor","BC","Ff","select","appendChoices","idx","Opt","AttachmentsMixin","refBody","Params","birthtime","ctime","statSync","ModDate","creationDate","modifiedDate","checksum","CheckSum","Size","byteLength","_fileRegistry","isEqual","fileSpecBody","EF","UF","description","addNamedEmbeddedFile","PDFA","initPDFA","pSubset","subset_conformance","endSubset","_addPdfaMetadata","_addColorOutputIntent","pICCPath","iccProfile","colorProfileRef","intentRef","Info","OutputConditionIdentifier","DestOutputProfile","OutputIntents","_getPdfaid","appendXML","PDFUA","initPDFUA","_addPdfuaMetadata","_getPdfuaid","SubsetMixin","_importSubset","initSubset","PDFMetadata","_metadata","_closeTags","append","xml","newline","getXML","getLength","MetadataMixin","initMetadata","metadata","_addInfo","toISOString","Creator","Title","Author","Subject","Keywords","endMetadata","metadataRef","Metadata","PDFDocument","Readable","_pageBuffer","_pageBufferStart","_offsets","_waiting","Names","Dests","Producer","displayTitle","ViewerPreferences","DisplayDocTitle","autoFirstPage","addPage","bufferPages","flushPages","bufferedPageRange","count","switchToPage","unshift","EmbeddedFiles","addNamedJavaScript","js","JavaScript","_read","_finalize","_info","entry","xRefOffset","trailer","Root","ID","Encrypt","mixin","methods","prototype"],"sources":["/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/abstract_reference.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/tree.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/object.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/reference.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/page.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/name_tree.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/saslprep/lib/util.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/saslprep/lib/code-points.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/saslprep/index.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/security.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/gradient.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/pattern.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/mixins/color.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/path.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/mixins/vector.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/font/afm.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/font.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/font/standard.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/font/embedded.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/font_factory.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/mixins/fonts.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/line_wrapper.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/mixins/text.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/image/jpeg.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/image/png.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/image.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/mixins/images.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/mixins/annotations.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/outline.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/mixins/outline.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/structure_content.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/structure_element.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/number_tree.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/mixins/markings.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/mixins/acroform.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/mixins/attachments.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/mixins/pdfa.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/mixins/pdfua.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/mixins/subsets.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/metadata.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/mixins/metadata.js","/Users/sathyamurthyt/Documents/Ai-forms/form-wizard/node_modules/pdfkit/lib/document.js"],"sourcesContent":["/*\r\nPDFAbstractReference - abstract class for PDF reference\r\n*/\r\n\r\nclass PDFAbstractReference {\r\n  toString() {\r\n    throw new Error('Must be implemented by subclasses');\r\n  }\r\n}\r\n\r\nexport default PDFAbstractReference;\r\n","/*\r\nPDFTree - abstract base class for name and number tree objects\r\n*/\r\n\r\nimport PDFObject from './object';\r\n\r\nclass PDFTree {\r\n  constructor(options = {}) {\r\n    this._items = {};\r\n    // disable /Limits output for this tree\r\n    this.limits =\r\n      typeof options.limits === 'boolean' ? options.limits : true;\r\n  }\r\n\r\n  add(key, val) {\r\n    return (this._items[key] = val);\r\n  }\r\n\r\n  get(key) {\r\n    return this._items[key];\r\n  }\r\n\r\n  toString() {\r\n    // Needs to be sorted by key\r\n    const sortedKeys = Object.keys(this._items).sort((a, b) =>\r\n      this._compareKeys(a, b)\r\n    );\r\n\r\n    const out = ['<<'];\r\n    if (this.limits && sortedKeys.length > 1) {\r\n      const first = sortedKeys[0],\r\n        last = sortedKeys[sortedKeys.length - 1];\r\n      out.push(\r\n        `  /Limits ${PDFObject.convert([this._dataForKey(first), this._dataForKey(last)])}`\r\n      );\r\n    }\r\n    out.push(`  /${this._keysName()} [`);\r\n    for (let key of sortedKeys) {\r\n      out.push(\r\n        `    ${PDFObject.convert(this._dataForKey(key))} ${PDFObject.convert(\r\n          this._items[key]\r\n        )}`\r\n      );\r\n    }\r\n    out.push(']');\r\n    out.push('>>');\r\n    return out.join('\\n');\r\n  }\r\n\r\n  _compareKeys(/*a, b*/) {\r\n    throw new Error('Must be implemented by subclasses');\r\n  }\r\n\r\n  _keysName() {\r\n    throw new Error('Must be implemented by subclasses');\r\n  }\r\n\r\n  _dataForKey(/*k*/) {\r\n    throw new Error('Must be implemented by subclasses');\r\n  }\r\n}\r\n\r\nexport default PDFTree;\r\n","/*\r\nPDFObject - converts JavaScript types into their corresponding PDF types.\r\nBy Devon Govett\r\n*/\r\n\r\nimport PDFAbstractReference from './abstract_reference';\r\nimport PDFTree from './tree';\r\n\r\nconst pad = (str, length) => (Array(length + 1).join('0') + str).slice(-length);\r\n\r\nconst escapableRe = /[\\n\\r\\t\\b\\f()\\\\]/g;\r\nconst escapable = {\r\n  '\\n': '\\\\n',\r\n  '\\r': '\\\\r',\r\n  '\\t': '\\\\t',\r\n  '\\b': '\\\\b',\r\n  '\\f': '\\\\f',\r\n  '\\\\': '\\\\\\\\',\r\n  '(': '\\\\(',\r\n  ')': '\\\\)'\r\n};\r\n\r\n// Convert little endian UTF-16 to big endian\r\nconst swapBytes = function(buff) {\r\n  const l = buff.length;\r\n  if (l & 0x01) {\r\n    throw new Error('Buffer length must be even');\r\n  } else {\r\n    for (let i = 0, end = l - 1; i < end; i += 2) {\r\n      const a = buff[i];\r\n      buff[i] = buff[i + 1];\r\n      buff[i + 1] = a;\r\n    }\r\n  }\r\n\r\n  return buff;\r\n};\r\n\r\nclass PDFObject {\r\n  static convert(object, encryptFn = null) {\r\n    // String literals are converted to the PDF name type\r\n    if (typeof object === 'string') {\r\n      return `/${object}`;\r\n\r\n      // String objects are converted to PDF strings (UTF-16)\r\n    } else if (object instanceof String) {\r\n      let string = object;\r\n      // Detect if this is a unicode string\r\n      let isUnicode = false;\r\n      for (let i = 0, end = string.length; i < end; i++) {\r\n        if (string.charCodeAt(i) > 0x7f) {\r\n          isUnicode = true;\r\n          break;\r\n        }\r\n      }\r\n\r\n      // If so, encode it as big endian UTF-16\r\n      let stringBuffer;\r\n      if (isUnicode) {\r\n        stringBuffer = swapBytes(Buffer.from(`\\ufeff${string}`, 'utf16le'));\r\n      } else {\r\n        stringBuffer = Buffer.from(string.valueOf(), 'ascii');\r\n      }\r\n\r\n      // Encrypt the string when necessary\r\n      if (encryptFn) {\r\n        string = encryptFn(stringBuffer).toString('binary');\r\n      } else {\r\n        string = stringBuffer.toString('binary');\r\n      }\r\n\r\n      // Escape characters as required by the spec\r\n      string = string.replace(escapableRe, c => escapable[c]);\r\n\r\n      return `(${string})`;\r\n\r\n      // Buffers are converted to PDF hex strings\r\n    } else if (Buffer.isBuffer(object)) {\r\n      return `<${object.toString('hex')}>`;\r\n    } else if (\r\n      object instanceof PDFAbstractReference ||\r\n      object instanceof PDFTree\r\n    ) {\r\n      return object.toString();\r\n    } else if (object instanceof Date) {\r\n      let string =\r\n        `D:${pad(object.getUTCFullYear(), 4)}` +\r\n        pad(object.getUTCMonth() + 1, 2) +\r\n        pad(object.getUTCDate(), 2) +\r\n        pad(object.getUTCHours(), 2) +\r\n        pad(object.getUTCMinutes(), 2) +\r\n        pad(object.getUTCSeconds(), 2) +\r\n        'Z';\r\n\r\n      // Encrypt the string when necessary\r\n      if (encryptFn) {\r\n        string = encryptFn(Buffer.from(string, 'ascii')).toString('binary');\r\n\r\n        // Escape characters as required by the spec\r\n        string = string.replace(escapableRe, c => escapable[c]);\r\n      }\r\n\r\n      return `(${string})`;\r\n    } else if (Array.isArray(object)) {\r\n      const items = object.map(e => PDFObject.convert(e, encryptFn)).join(' ');\r\n      return `[${items}]`;\r\n    } else if ({}.toString.call(object) === '[object Object]') {\r\n      const out = ['<<'];\r\n      for (let key in object) {\r\n        const val = object[key];\r\n        out.push(`/${key} ${PDFObject.convert(val, encryptFn)}`);\r\n      }\r\n\r\n      out.push('>>');\r\n      return out.join('\\n');\r\n    } else if (typeof object === 'number') {\r\n      return PDFObject.number(object);\r\n    } else {\r\n      return `${object}`;\r\n    }\r\n  }\r\n\r\n  static number(n) {\r\n    if (n > -1e21 && n < 1e21) {\r\n      return Math.round(n * 1e6) / 1e6;\r\n    }\r\n\r\n    throw new Error(`unsupported number: ${n}`);\r\n  }\r\n}\r\n\r\nexport default PDFObject;\r\n","/*\r\nPDFReference - represents a reference to another object in the PDF object heirarchy\r\nBy Devon Govett\r\n*/\r\n\r\nimport zlib from 'zlib';\r\nimport PDFAbstractReference from './abstract_reference';\r\nimport PDFObject from './object';\r\n\r\nclass PDFReference extends PDFAbstractReference {\r\n  constructor(document, id, data = {}) {\r\n    super();\r\n    this.document = document;\r\n    this.id = id;\r\n    this.data = data;\r\n    this.gen = 0;\r\n    this.compress = this.document.compress && !this.data.Filter;\r\n    this.uncompressedLength = 0;\r\n    this.buffer = [];\r\n  }\r\n\r\n  write(chunk) {\r\n    if (!Buffer.isBuffer(chunk)) {\r\n      chunk = Buffer.from(chunk + '\\n', 'binary');\r\n    }\r\n\r\n    this.uncompressedLength += chunk.length;\r\n    if (this.data.Length == null) {\r\n      this.data.Length = 0;\r\n    }\r\n    this.buffer.push(chunk);\r\n    this.data.Length += chunk.length;\r\n    if (this.compress) {\r\n      return (this.data.Filter = 'FlateDecode');\r\n    }\r\n  }\r\n\r\n  end(chunk) {\r\n    if (chunk) {\r\n      this.write(chunk);\r\n    }\r\n    return this.finalize();\r\n  }\r\n\r\n  finalize() {\r\n    this.offset = this.document._offset;\r\n\r\n    const encryptFn = this.document._security\r\n      ? this.document._security.getEncryptFn(this.id, this.gen)\r\n      : null;\r\n\r\n    if (this.buffer.length) {\r\n      this.buffer = Buffer.concat(this.buffer);\r\n      if (this.compress) {\r\n        this.buffer = zlib.deflateSync(this.buffer);\r\n      }\r\n\r\n      if (encryptFn) {\r\n        this.buffer = encryptFn(this.buffer);\r\n      }\r\n\r\n      this.data.Length = this.buffer.length;\r\n    }\r\n\r\n    this.document._write(`${this.id} ${this.gen} obj`);\r\n    this.document._write(PDFObject.convert(this.data, encryptFn));\r\n\r\n    if (this.buffer.length) {\r\n      this.document._write('stream');\r\n      this.document._write(this.buffer);\r\n\r\n      this.buffer = []; // free up memory\r\n      this.document._write('\\nendstream');\r\n    }\r\n\r\n    this.document._write('endobj');\r\n    this.document._refEnd(this);\r\n  }\r\n  toString() {\r\n    return `${this.id} ${this.gen} R`;\r\n  }\r\n}\r\n\r\nexport default PDFReference;\r\n","/*\r\nPDFPage - represents a single page in the PDF document\r\nBy Devon Govett\r\n*/\r\n\r\nconst DEFAULT_MARGINS = {\r\n  top: 72,\r\n  left: 72,\r\n  bottom: 72,\r\n  right: 72\r\n};\r\n\r\nconst SIZES = {\r\n  '4A0': [4767.87, 6740.79],\r\n  '2A0': [3370.39, 4767.87],\r\n  A0: [2383.94, 3370.39],\r\n  A1: [1683.78, 2383.94],\r\n  A2: [1190.55, 1683.78],\r\n  A3: [841.89, 1190.55],\r\n  A4: [595.28, 841.89],\r\n  A5: [419.53, 595.28],\r\n  A6: [297.64, 419.53],\r\n  A7: [209.76, 297.64],\r\n  A8: [147.4, 209.76],\r\n  A9: [104.88, 147.4],\r\n  A10: [73.7, 104.88],\r\n  B0: [2834.65, 4008.19],\r\n  B1: [2004.09, 2834.65],\r\n  B2: [1417.32, 2004.09],\r\n  B3: [1000.63, 1417.32],\r\n  B4: [708.66, 1000.63],\r\n  B5: [498.9, 708.66],\r\n  B6: [354.33, 498.9],\r\n  B7: [249.45, 354.33],\r\n  B8: [175.75, 249.45],\r\n  B9: [124.72, 175.75],\r\n  B10: [87.87, 124.72],\r\n  C0: [2599.37, 3676.54],\r\n  C1: [1836.85, 2599.37],\r\n  C2: [1298.27, 1836.85],\r\n  C3: [918.43, 1298.27],\r\n  C4: [649.13, 918.43],\r\n  C5: [459.21, 649.13],\r\n  C6: [323.15, 459.21],\r\n  C7: [229.61, 323.15],\r\n  C8: [161.57, 229.61],\r\n  C9: [113.39, 161.57],\r\n  C10: [79.37, 113.39],\r\n  RA0: [2437.8, 3458.27],\r\n  RA1: [1729.13, 2437.8],\r\n  RA2: [1218.9, 1729.13],\r\n  RA3: [864.57, 1218.9],\r\n  RA4: [609.45, 864.57],\r\n  SRA0: [2551.18, 3628.35],\r\n  SRA1: [1814.17, 2551.18],\r\n  SRA2: [1275.59, 1814.17],\r\n  SRA3: [907.09, 1275.59],\r\n  SRA4: [637.8, 907.09],\r\n  EXECUTIVE: [521.86, 756.0],\r\n  FOLIO: [612.0, 936.0],\r\n  LEGAL: [612.0, 1008.0],\r\n  LETTER: [612.0, 792.0],\r\n  TABLOID: [792.0, 1224.0]\r\n};\r\n\r\nclass PDFPage {\r\n  constructor(document, options = {}) {\r\n    this.document = document;\r\n    this.size = options.size || 'letter';\r\n    this.layout = options.layout || 'portrait';\r\n\r\n    // process margins\r\n    if (typeof options.margin === 'number') {\r\n      this.margins = {\r\n        top: options.margin,\r\n        left: options.margin,\r\n        bottom: options.margin,\r\n        right: options.margin\r\n      };\r\n\r\n      // default to 1 inch margins\r\n    } else {\r\n      this.margins = options.margins || DEFAULT_MARGINS;\r\n    }\r\n\r\n    // calculate page dimensions\r\n    const dimensions = Array.isArray(this.size)\r\n      ? this.size\r\n      : SIZES[this.size.toUpperCase()];\r\n    this.width = dimensions[this.layout === 'portrait' ? 0 : 1];\r\n    this.height = dimensions[this.layout === 'portrait' ? 1 : 0];\r\n\r\n    this.content = this.document.ref();\r\n\r\n    // Initialize the Font, XObject, and ExtGState dictionaries\r\n    this.resources = this.document.ref({\r\n      ProcSet: ['PDF', 'Text', 'ImageB', 'ImageC', 'ImageI']\r\n    });\r\n\r\n    // The page dictionary\r\n    this.dictionary = this.document.ref({\r\n      Type: 'Page',\r\n      Parent: this.document._root.data.Pages,\r\n      MediaBox: [0, 0, this.width, this.height],\r\n      Contents: this.content,\r\n      Resources: this.resources\r\n    });\r\n\r\n    this.markings = [];\r\n  }\r\n\r\n  // Lazily create these objects\r\n  get fonts() {\r\n    const data = this.resources.data;\r\n    return data.Font != null ? data.Font : (data.Font = {});\r\n  }\r\n\r\n  get xobjects() {\r\n    const data = this.resources.data;\r\n    return data.XObject != null ? data.XObject : (data.XObject = {});\r\n  }\r\n\r\n  get ext_gstates() {\r\n    const data = this.resources.data;\r\n    return data.ExtGState != null ? data.ExtGState : (data.ExtGState = {});\r\n  }\r\n\r\n  get patterns() {\r\n    const data = this.resources.data;\r\n    return data.Pattern != null ? data.Pattern : (data.Pattern = {});\r\n  }\r\n\r\n  get colorSpaces() {\r\n    const data = this.resources.data;\r\n    return data.ColorSpace || (data.ColorSpace = {});\r\n  }\r\n\r\n  get annotations() {\r\n    const data = this.dictionary.data;\r\n    return data.Annots != null ? data.Annots : (data.Annots = []);\r\n  }\r\n\r\n  get structParentTreeKey() {\r\n    const data = this.dictionary.data;\r\n    return data.StructParents != null\r\n      ? data.StructParents\r\n      : (data.StructParents = this.document.createStructParentTreeNextKey());\r\n  }\r\n\r\n  maxY() {\r\n    return this.height - this.margins.bottom;\r\n  }\r\n\r\n  write(chunk) {\r\n    return this.content.write(chunk);\r\n  }\r\n\r\n  end() {\r\n    this.dictionary.end();\r\n    this.resources.end();\r\n    return this.content.end();\r\n  }\r\n}\r\n\r\nexport default PDFPage;\r\n","/*\r\nPDFNameTree - represents a name tree object\r\n*/\r\n\r\nimport PDFTree from \"./tree\";\r\n\r\nclass PDFNameTree extends PDFTree {\r\n  _compareKeys(a, b) {\r\n    return a.localeCompare(b);\r\n  }\r\n\r\n  _keysName() {\r\n    return \"Names\";\r\n  }\r\n\r\n  _dataForKey(k) {\r\n    return new String(k);\r\n  }\r\n}\r\n\r\nexport default PDFNameTree;\r\n","/**\r\n * Check if value is in a range group.\r\n * @param {number} value\r\n * @param {number[]} rangeGroup\r\n * @returns {boolean}\r\n */\r\nfunction inRange(value, rangeGroup) {\r\n  if (value < rangeGroup[0]) return false;\r\n  let startRange = 0;\r\n  let endRange = rangeGroup.length / 2;\r\n  while (startRange <= endRange) {\r\n    const middleRange = Math.floor((startRange + endRange) / 2);\r\n\r\n    // actual array index\r\n    const arrayIndex = middleRange * 2;\r\n\r\n    // Check if value is in range pointed by actual index\r\n    if (\r\n      value >= rangeGroup[arrayIndex] &&\r\n      value <= rangeGroup[arrayIndex + 1]\r\n    ) {\r\n      return true;\r\n    }\r\n\r\n    if (value > rangeGroup[arrayIndex + 1]) {\r\n      // Search Right Side Of Array\r\n      startRange = middleRange + 1;\r\n    } else {\r\n      // Search Left Side Of Array\r\n      endRange = middleRange - 1;\r\n    }\r\n  }\r\n  return false;\r\n}\r\n\r\nexport { inRange };\r\n","import { inRange } from './util';\r\n\r\n// prettier-ignore-start\r\n/**\r\n * A.1 Unassigned code points in Unicode 3.2\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-A.1\r\n */\r\nconst unassigned_code_points = [\r\n  0x0221,\r\n  0x0221,\r\n  0x0234,\r\n  0x024f,\r\n  0x02ae,\r\n  0x02af,\r\n  0x02ef,\r\n  0x02ff,\r\n  0x0350,\r\n  0x035f,\r\n  0x0370,\r\n  0x0373,\r\n  0x0376,\r\n  0x0379,\r\n  0x037b,\r\n  0x037d,\r\n  0x037f,\r\n  0x0383,\r\n  0x038b,\r\n  0x038b,\r\n  0x038d,\r\n  0x038d,\r\n  0x03a2,\r\n  0x03a2,\r\n  0x03cf,\r\n  0x03cf,\r\n  0x03f7,\r\n  0x03ff,\r\n  0x0487,\r\n  0x0487,\r\n  0x04cf,\r\n  0x04cf,\r\n  0x04f6,\r\n  0x04f7,\r\n  0x04fa,\r\n  0x04ff,\r\n  0x0510,\r\n  0x0530,\r\n  0x0557,\r\n  0x0558,\r\n  0x0560,\r\n  0x0560,\r\n  0x0588,\r\n  0x0588,\r\n  0x058b,\r\n  0x0590,\r\n  0x05a2,\r\n  0x05a2,\r\n  0x05ba,\r\n  0x05ba,\r\n  0x05c5,\r\n  0x05cf,\r\n  0x05eb,\r\n  0x05ef,\r\n  0x05f5,\r\n  0x060b,\r\n  0x060d,\r\n  0x061a,\r\n  0x061c,\r\n  0x061e,\r\n  0x0620,\r\n  0x0620,\r\n  0x063b,\r\n  0x063f,\r\n  0x0656,\r\n  0x065f,\r\n  0x06ee,\r\n  0x06ef,\r\n  0x06ff,\r\n  0x06ff,\r\n  0x070e,\r\n  0x070e,\r\n  0x072d,\r\n  0x072f,\r\n  0x074b,\r\n  0x077f,\r\n  0x07b2,\r\n  0x0900,\r\n  0x0904,\r\n  0x0904,\r\n  0x093a,\r\n  0x093b,\r\n  0x094e,\r\n  0x094f,\r\n  0x0955,\r\n  0x0957,\r\n  0x0971,\r\n  0x0980,\r\n  0x0984,\r\n  0x0984,\r\n  0x098d,\r\n  0x098e,\r\n  0x0991,\r\n  0x0992,\r\n  0x09a9,\r\n  0x09a9,\r\n  0x09b1,\r\n  0x09b1,\r\n  0x09b3,\r\n  0x09b5,\r\n  0x09ba,\r\n  0x09bb,\r\n  0x09bd,\r\n  0x09bd,\r\n  0x09c5,\r\n  0x09c6,\r\n  0x09c9,\r\n  0x09ca,\r\n  0x09ce,\r\n  0x09d6,\r\n  0x09d8,\r\n  0x09db,\r\n  0x09de,\r\n  0x09de,\r\n  0x09e4,\r\n  0x09e5,\r\n  0x09fb,\r\n  0x0a01,\r\n  0x0a03,\r\n  0x0a04,\r\n  0x0a0b,\r\n  0x0a0e,\r\n  0x0a11,\r\n  0x0a12,\r\n  0x0a29,\r\n  0x0a29,\r\n  0x0a31,\r\n  0x0a31,\r\n  0x0a34,\r\n  0x0a34,\r\n  0x0a37,\r\n  0x0a37,\r\n  0x0a3a,\r\n  0x0a3b,\r\n  0x0a3d,\r\n  0x0a3d,\r\n  0x0a43,\r\n  0x0a46,\r\n  0x0a49,\r\n  0x0a4a,\r\n  0x0a4e,\r\n  0x0a58,\r\n  0x0a5d,\r\n  0x0a5d,\r\n  0x0a5f,\r\n  0x0a65,\r\n  0x0a75,\r\n  0x0a80,\r\n  0x0a84,\r\n  0x0a84,\r\n  0x0a8c,\r\n  0x0a8c,\r\n  0x0a8e,\r\n  0x0a8e,\r\n  0x0a92,\r\n  0x0a92,\r\n  0x0aa9,\r\n  0x0aa9,\r\n  0x0ab1,\r\n  0x0ab1,\r\n  0x0ab4,\r\n  0x0ab4,\r\n  0x0aba,\r\n  0x0abb,\r\n  0x0ac6,\r\n  0x0ac6,\r\n  0x0aca,\r\n  0x0aca,\r\n  0x0ace,\r\n  0x0acf,\r\n  0x0ad1,\r\n  0x0adf,\r\n  0x0ae1,\r\n  0x0ae5,\r\n  0x0af0,\r\n  0x0b00,\r\n  0x0b04,\r\n  0x0b04,\r\n  0x0b0d,\r\n  0x0b0e,\r\n  0x0b11,\r\n  0x0b12,\r\n  0x0b29,\r\n  0x0b29,\r\n  0x0b31,\r\n  0x0b31,\r\n  0x0b34,\r\n  0x0b35,\r\n  0x0b3a,\r\n  0x0b3b,\r\n  0x0b44,\r\n  0x0b46,\r\n  0x0b49,\r\n  0x0b4a,\r\n  0x0b4e,\r\n  0x0b55,\r\n  0x0b58,\r\n  0x0b5b,\r\n  0x0b5e,\r\n  0x0b5e,\r\n  0x0b62,\r\n  0x0b65,\r\n  0x0b71,\r\n  0x0b81,\r\n  0x0b84,\r\n  0x0b84,\r\n  0x0b8b,\r\n  0x0b8d,\r\n  0x0b91,\r\n  0x0b91,\r\n  0x0b96,\r\n  0x0b98,\r\n  0x0b9b,\r\n  0x0b9b,\r\n  0x0b9d,\r\n  0x0b9d,\r\n  0x0ba0,\r\n  0x0ba2,\r\n  0x0ba5,\r\n  0x0ba7,\r\n  0x0bab,\r\n  0x0bad,\r\n  0x0bb6,\r\n  0x0bb6,\r\n  0x0bba,\r\n  0x0bbd,\r\n  0x0bc3,\r\n  0x0bc5,\r\n  0x0bc9,\r\n  0x0bc9,\r\n  0x0bce,\r\n  0x0bd6,\r\n  0x0bd8,\r\n  0x0be6,\r\n  0x0bf3,\r\n  0x0c00,\r\n  0x0c04,\r\n  0x0c04,\r\n  0x0c0d,\r\n  0x0c0d,\r\n  0x0c11,\r\n  0x0c11,\r\n  0x0c29,\r\n  0x0c29,\r\n  0x0c34,\r\n  0x0c34,\r\n  0x0c3a,\r\n  0x0c3d,\r\n  0x0c45,\r\n  0x0c45,\r\n  0x0c49,\r\n  0x0c49,\r\n  0x0c4e,\r\n  0x0c54,\r\n  0x0c57,\r\n  0x0c5f,\r\n  0x0c62,\r\n  0x0c65,\r\n  0x0c70,\r\n  0x0c81,\r\n  0x0c84,\r\n  0x0c84,\r\n  0x0c8d,\r\n  0x0c8d,\r\n  0x0c91,\r\n  0x0c91,\r\n  0x0ca9,\r\n  0x0ca9,\r\n  0x0cb4,\r\n  0x0cb4,\r\n  0x0cba,\r\n  0x0cbd,\r\n  0x0cc5,\r\n  0x0cc5,\r\n  0x0cc9,\r\n  0x0cc9,\r\n  0x0cce,\r\n  0x0cd4,\r\n  0x0cd7,\r\n  0x0cdd,\r\n  0x0cdf,\r\n  0x0cdf,\r\n  0x0ce2,\r\n  0x0ce5,\r\n  0x0cf0,\r\n  0x0d01,\r\n  0x0d04,\r\n  0x0d04,\r\n  0x0d0d,\r\n  0x0d0d,\r\n  0x0d11,\r\n  0x0d11,\r\n  0x0d29,\r\n  0x0d29,\r\n  0x0d3a,\r\n  0x0d3d,\r\n  0x0d44,\r\n  0x0d45,\r\n  0x0d49,\r\n  0x0d49,\r\n  0x0d4e,\r\n  0x0d56,\r\n  0x0d58,\r\n  0x0d5f,\r\n  0x0d62,\r\n  0x0d65,\r\n  0x0d70,\r\n  0x0d81,\r\n  0x0d84,\r\n  0x0d84,\r\n  0x0d97,\r\n  0x0d99,\r\n  0x0db2,\r\n  0x0db2,\r\n  0x0dbc,\r\n  0x0dbc,\r\n  0x0dbe,\r\n  0x0dbf,\r\n  0x0dc7,\r\n  0x0dc9,\r\n  0x0dcb,\r\n  0x0dce,\r\n  0x0dd5,\r\n  0x0dd5,\r\n  0x0dd7,\r\n  0x0dd7,\r\n  0x0de0,\r\n  0x0df1,\r\n  0x0df5,\r\n  0x0e00,\r\n  0x0e3b,\r\n  0x0e3e,\r\n  0x0e5c,\r\n  0x0e80,\r\n  0x0e83,\r\n  0x0e83,\r\n  0x0e85,\r\n  0x0e86,\r\n  0x0e89,\r\n  0x0e89,\r\n  0x0e8b,\r\n  0x0e8c,\r\n  0x0e8e,\r\n  0x0e93,\r\n  0x0e98,\r\n  0x0e98,\r\n  0x0ea0,\r\n  0x0ea0,\r\n  0x0ea4,\r\n  0x0ea4,\r\n  0x0ea6,\r\n  0x0ea6,\r\n  0x0ea8,\r\n  0x0ea9,\r\n  0x0eac,\r\n  0x0eac,\r\n  0x0eba,\r\n  0x0eba,\r\n  0x0ebe,\r\n  0x0ebf,\r\n  0x0ec5,\r\n  0x0ec5,\r\n  0x0ec7,\r\n  0x0ec7,\r\n  0x0ece,\r\n  0x0ecf,\r\n  0x0eda,\r\n  0x0edb,\r\n  0x0ede,\r\n  0x0eff,\r\n  0x0f48,\r\n  0x0f48,\r\n  0x0f6b,\r\n  0x0f70,\r\n  0x0f8c,\r\n  0x0f8f,\r\n  0x0f98,\r\n  0x0f98,\r\n  0x0fbd,\r\n  0x0fbd,\r\n  0x0fcd,\r\n  0x0fce,\r\n  0x0fd0,\r\n  0x0fff,\r\n  0x1022,\r\n  0x1022,\r\n  0x1028,\r\n  0x1028,\r\n  0x102b,\r\n  0x102b,\r\n  0x1033,\r\n  0x1035,\r\n  0x103a,\r\n  0x103f,\r\n  0x105a,\r\n  0x109f,\r\n  0x10c6,\r\n  0x10cf,\r\n  0x10f9,\r\n  0x10fa,\r\n  0x10fc,\r\n  0x10ff,\r\n  0x115a,\r\n  0x115e,\r\n  0x11a3,\r\n  0x11a7,\r\n  0x11fa,\r\n  0x11ff,\r\n  0x1207,\r\n  0x1207,\r\n  0x1247,\r\n  0x1247,\r\n  0x1249,\r\n  0x1249,\r\n  0x124e,\r\n  0x124f,\r\n  0x1257,\r\n  0x1257,\r\n  0x1259,\r\n  0x1259,\r\n  0x125e,\r\n  0x125f,\r\n  0x1287,\r\n  0x1287,\r\n  0x1289,\r\n  0x1289,\r\n  0x128e,\r\n  0x128f,\r\n  0x12af,\r\n  0x12af,\r\n  0x12b1,\r\n  0x12b1,\r\n  0x12b6,\r\n  0x12b7,\r\n  0x12bf,\r\n  0x12bf,\r\n  0x12c1,\r\n  0x12c1,\r\n  0x12c6,\r\n  0x12c7,\r\n  0x12cf,\r\n  0x12cf,\r\n  0x12d7,\r\n  0x12d7,\r\n  0x12ef,\r\n  0x12ef,\r\n  0x130f,\r\n  0x130f,\r\n  0x1311,\r\n  0x1311,\r\n  0x1316,\r\n  0x1317,\r\n  0x131f,\r\n  0x131f,\r\n  0x1347,\r\n  0x1347,\r\n  0x135b,\r\n  0x1360,\r\n  0x137d,\r\n  0x139f,\r\n  0x13f5,\r\n  0x1400,\r\n  0x1677,\r\n  0x167f,\r\n  0x169d,\r\n  0x169f,\r\n  0x16f1,\r\n  0x16ff,\r\n  0x170d,\r\n  0x170d,\r\n  0x1715,\r\n  0x171f,\r\n  0x1737,\r\n  0x173f,\r\n  0x1754,\r\n  0x175f,\r\n  0x176d,\r\n  0x176d,\r\n  0x1771,\r\n  0x1771,\r\n  0x1774,\r\n  0x177f,\r\n  0x17dd,\r\n  0x17df,\r\n  0x17ea,\r\n  0x17ff,\r\n  0x180f,\r\n  0x180f,\r\n  0x181a,\r\n  0x181f,\r\n  0x1878,\r\n  0x187f,\r\n  0x18aa,\r\n  0x1dff,\r\n  0x1e9c,\r\n  0x1e9f,\r\n  0x1efa,\r\n  0x1eff,\r\n  0x1f16,\r\n  0x1f17,\r\n  0x1f1e,\r\n  0x1f1f,\r\n  0x1f46,\r\n  0x1f47,\r\n  0x1f4e,\r\n  0x1f4f,\r\n  0x1f58,\r\n  0x1f58,\r\n  0x1f5a,\r\n  0x1f5a,\r\n  0x1f5c,\r\n  0x1f5c,\r\n  0x1f5e,\r\n  0x1f5e,\r\n  0x1f7e,\r\n  0x1f7f,\r\n  0x1fb5,\r\n  0x1fb5,\r\n  0x1fc5,\r\n  0x1fc5,\r\n  0x1fd4,\r\n  0x1fd5,\r\n  0x1fdc,\r\n  0x1fdc,\r\n  0x1ff0,\r\n  0x1ff1,\r\n  0x1ff5,\r\n  0x1ff5,\r\n  0x1fff,\r\n  0x1fff,\r\n  0x2053,\r\n  0x2056,\r\n  0x2058,\r\n  0x205e,\r\n  0x2064,\r\n  0x2069,\r\n  0x2072,\r\n  0x2073,\r\n  0x208f,\r\n  0x209f,\r\n  0x20b2,\r\n  0x20cf,\r\n  0x20eb,\r\n  0x20ff,\r\n  0x213b,\r\n  0x213c,\r\n  0x214c,\r\n  0x2152,\r\n  0x2184,\r\n  0x218f,\r\n  0x23cf,\r\n  0x23ff,\r\n  0x2427,\r\n  0x243f,\r\n  0x244b,\r\n  0x245f,\r\n  0x24ff,\r\n  0x24ff,\r\n  0x2614,\r\n  0x2615,\r\n  0x2618,\r\n  0x2618,\r\n  0x267e,\r\n  0x267f,\r\n  0x268a,\r\n  0x2700,\r\n  0x2705,\r\n  0x2705,\r\n  0x270a,\r\n  0x270b,\r\n  0x2728,\r\n  0x2728,\r\n  0x274c,\r\n  0x274c,\r\n  0x274e,\r\n  0x274e,\r\n  0x2753,\r\n  0x2755,\r\n  0x2757,\r\n  0x2757,\r\n  0x275f,\r\n  0x2760,\r\n  0x2795,\r\n  0x2797,\r\n  0x27b0,\r\n  0x27b0,\r\n  0x27bf,\r\n  0x27cf,\r\n  0x27ec,\r\n  0x27ef,\r\n  0x2b00,\r\n  0x2e7f,\r\n  0x2e9a,\r\n  0x2e9a,\r\n  0x2ef4,\r\n  0x2eff,\r\n  0x2fd6,\r\n  0x2fef,\r\n  0x2ffc,\r\n  0x2fff,\r\n  0x3040,\r\n  0x3040,\r\n  0x3097,\r\n  0x3098,\r\n  0x3100,\r\n  0x3104,\r\n  0x312d,\r\n  0x3130,\r\n  0x318f,\r\n  0x318f,\r\n  0x31b8,\r\n  0x31ef,\r\n  0x321d,\r\n  0x321f,\r\n  0x3244,\r\n  0x3250,\r\n  0x327c,\r\n  0x327e,\r\n  0x32cc,\r\n  0x32cf,\r\n  0x32ff,\r\n  0x32ff,\r\n  0x3377,\r\n  0x337a,\r\n  0x33de,\r\n  0x33df,\r\n  0x33ff,\r\n  0x33ff,\r\n  0x4db6,\r\n  0x4dff,\r\n  0x9fa6,\r\n  0x9fff,\r\n  0xa48d,\r\n  0xa48f,\r\n  0xa4c7,\r\n  0xabff,\r\n  0xd7a4,\r\n  0xd7ff,\r\n  0xfa2e,\r\n  0xfa2f,\r\n  0xfa6b,\r\n  0xfaff,\r\n  0xfb07,\r\n  0xfb12,\r\n  0xfb18,\r\n  0xfb1c,\r\n  0xfb37,\r\n  0xfb37,\r\n  0xfb3d,\r\n  0xfb3d,\r\n  0xfb3f,\r\n  0xfb3f,\r\n  0xfb42,\r\n  0xfb42,\r\n  0xfb45,\r\n  0xfb45,\r\n  0xfbb2,\r\n  0xfbd2,\r\n  0xfd40,\r\n  0xfd4f,\r\n  0xfd90,\r\n  0xfd91,\r\n  0xfdc8,\r\n  0xfdcf,\r\n  0xfdfd,\r\n  0xfdff,\r\n  0xfe10,\r\n  0xfe1f,\r\n  0xfe24,\r\n  0xfe2f,\r\n  0xfe47,\r\n  0xfe48,\r\n  0xfe53,\r\n  0xfe53,\r\n  0xfe67,\r\n  0xfe67,\r\n  0xfe6c,\r\n  0xfe6f,\r\n  0xfe75,\r\n  0xfe75,\r\n  0xfefd,\r\n  0xfefe,\r\n  0xff00,\r\n  0xff00,\r\n  0xffbf,\r\n  0xffc1,\r\n  0xffc8,\r\n  0xffc9,\r\n  0xffd0,\r\n  0xffd1,\r\n  0xffd8,\r\n  0xffd9,\r\n  0xffdd,\r\n  0xffdf,\r\n  0xffe7,\r\n  0xffe7,\r\n  0xffef,\r\n  0xfff8,\r\n  0x10000,\r\n  0x102ff,\r\n  0x1031f,\r\n  0x1031f,\r\n  0x10324,\r\n  0x1032f,\r\n  0x1034b,\r\n  0x103ff,\r\n  0x10426,\r\n  0x10427,\r\n  0x1044e,\r\n  0x1cfff,\r\n  0x1d0f6,\r\n  0x1d0ff,\r\n  0x1d127,\r\n  0x1d129,\r\n  0x1d1de,\r\n  0x1d3ff,\r\n  0x1d455,\r\n  0x1d455,\r\n  0x1d49d,\r\n  0x1d49d,\r\n  0x1d4a0,\r\n  0x1d4a1,\r\n  0x1d4a3,\r\n  0x1d4a4,\r\n  0x1d4a7,\r\n  0x1d4a8,\r\n  0x1d4ad,\r\n  0x1d4ad,\r\n  0x1d4ba,\r\n  0x1d4ba,\r\n  0x1d4bc,\r\n  0x1d4bc,\r\n  0x1d4c1,\r\n  0x1d4c1,\r\n  0x1d4c4,\r\n  0x1d4c4,\r\n  0x1d506,\r\n  0x1d506,\r\n  0x1d50b,\r\n  0x1d50c,\r\n  0x1d515,\r\n  0x1d515,\r\n  0x1d51d,\r\n  0x1d51d,\r\n  0x1d53a,\r\n  0x1d53a,\r\n  0x1d53f,\r\n  0x1d53f,\r\n  0x1d545,\r\n  0x1d545,\r\n  0x1d547,\r\n  0x1d549,\r\n  0x1d551,\r\n  0x1d551,\r\n  0x1d6a4,\r\n  0x1d6a7,\r\n  0x1d7ca,\r\n  0x1d7cd,\r\n  0x1d800,\r\n  0x1fffd,\r\n  0x2a6d7,\r\n  0x2f7ff,\r\n  0x2fa1e,\r\n  0x2fffd,\r\n  0x30000,\r\n  0x3fffd,\r\n  0x40000,\r\n  0x4fffd,\r\n  0x50000,\r\n  0x5fffd,\r\n  0x60000,\r\n  0x6fffd,\r\n  0x70000,\r\n  0x7fffd,\r\n  0x80000,\r\n  0x8fffd,\r\n  0x90000,\r\n  0x9fffd,\r\n  0xa0000,\r\n  0xafffd,\r\n  0xb0000,\r\n  0xbfffd,\r\n  0xc0000,\r\n  0xcfffd,\r\n  0xd0000,\r\n  0xdfffd,\r\n  0xe0000,\r\n  0xe0000,\r\n  0xe0002,\r\n  0xe001f,\r\n  0xe0080,\r\n  0xefffd\r\n];\r\n// prettier-ignore-end\r\n\r\nconst isUnassignedCodePoint = character =>\r\n  inRange(character, unassigned_code_points);\r\n\r\n// prettier-ignore-start\r\n/**\r\n * B.1 Commonly mapped to nothing\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-B.1\r\n */\r\nconst commonly_mapped_to_nothing = [\r\n  0x00ad,\r\n  0x00ad,\r\n  0x034f,\r\n  0x034f,\r\n  0x1806,\r\n  0x1806,\r\n  0x180b,\r\n  0x180b,\r\n  0x180c,\r\n  0x180c,\r\n  0x180d,\r\n  0x180d,\r\n  0x200b,\r\n  0x200b,\r\n  0x200c,\r\n  0x200c,\r\n  0x200d,\r\n  0x200d,\r\n  0x2060,\r\n  0x2060,\r\n  0xfe00,\r\n  0xfe00,\r\n  0xfe01,\r\n  0xfe01,\r\n  0xfe02,\r\n  0xfe02,\r\n  0xfe03,\r\n  0xfe03,\r\n  0xfe04,\r\n  0xfe04,\r\n  0xfe05,\r\n  0xfe05,\r\n  0xfe06,\r\n  0xfe06,\r\n  0xfe07,\r\n  0xfe07,\r\n  0xfe08,\r\n  0xfe08,\r\n  0xfe09,\r\n  0xfe09,\r\n  0xfe0a,\r\n  0xfe0a,\r\n  0xfe0b,\r\n  0xfe0b,\r\n  0xfe0c,\r\n  0xfe0c,\r\n  0xfe0d,\r\n  0xfe0d,\r\n  0xfe0e,\r\n  0xfe0e,\r\n  0xfe0f,\r\n  0xfe0f,\r\n  0xfeff,\r\n  0xfeff\r\n];\r\n// prettier-ignore-end\r\n\r\nconst isCommonlyMappedToNothing = character =>\r\n  inRange(character, commonly_mapped_to_nothing);\r\n\r\n// prettier-ignore-start\r\n/**\r\n * C.1.2 Non-ASCII space characters\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-C.1.2\r\n */\r\nconst non_ASCII_space_characters = [\r\n  0x00a0,\r\n  0x00a0 /* NO-BREAK SPACE */,\r\n  0x1680,\r\n  0x1680 /* OGHAM SPACE MARK */,\r\n  0x2000,\r\n  0x2000 /* EN QUAD */,\r\n  0x2001,\r\n  0x2001 /* EM QUAD */,\r\n  0x2002,\r\n  0x2002 /* EN SPACE */,\r\n  0x2003,\r\n  0x2003 /* EM SPACE */,\r\n  0x2004,\r\n  0x2004 /* THREE-PER-EM SPACE */,\r\n  0x2005,\r\n  0x2005 /* FOUR-PER-EM SPACE */,\r\n  0x2006,\r\n  0x2006 /* SIX-PER-EM SPACE */,\r\n  0x2007,\r\n  0x2007 /* FIGURE SPACE */,\r\n  0x2008,\r\n  0x2008 /* PUNCTUATION SPACE */,\r\n  0x2009,\r\n  0x2009 /* THIN SPACE */,\r\n  0x200a,\r\n  0x200a /* HAIR SPACE */,\r\n  0x200b,\r\n  0x200b /* ZERO WIDTH SPACE */,\r\n  0x202f,\r\n  0x202f /* NARROW NO-BREAK SPACE */,\r\n  0x205f,\r\n  0x205f /* MEDIUM MATHEMATICAL SPACE */,\r\n  0x3000,\r\n  0x3000 /* IDEOGRAPHIC SPACE */\r\n];\r\n// prettier-ignore-end\r\n\r\nconst isNonASCIISpaceCharacter = character =>\r\n  inRange(character, non_ASCII_space_characters);\r\n\r\n// prettier-ignore-start\r\nconst non_ASCII_controls_characters = [\r\n  /**\r\n   * C.2.2 Non-ASCII control characters\r\n   * @link https://tools.ietf.org/html/rfc3454#appendix-C.2.2\r\n   */\r\n  0x0080,\r\n  0x009f /* [CONTROL CHARACTERS] */,\r\n  0x06dd,\r\n  0x06dd /* ARABIC END OF AYAH */,\r\n  0x070f,\r\n  0x070f /* SYRIAC ABBREVIATION MARK */,\r\n  0x180e,\r\n  0x180e /* MONGOLIAN VOWEL SEPARATOR */,\r\n  0x200c,\r\n  0x200c /* ZERO WIDTH NON-JOINER */,\r\n  0x200d,\r\n  0x200d /* ZERO WIDTH JOINER */,\r\n  0x2028,\r\n  0x2028 /* LINE SEPARATOR */,\r\n  0x2029,\r\n  0x2029 /* PARAGRAPH SEPARATOR */,\r\n  0x2060,\r\n  0x2060 /* WORD JOINER */,\r\n  0x2061,\r\n  0x2061 /* FUNCTION APPLICATION */,\r\n  0x2062,\r\n  0x2062 /* INVISIBLE TIMES */,\r\n  0x2063,\r\n  0x2063 /* INVISIBLE SEPARATOR */,\r\n  0x206a,\r\n  0x206f /* [CONTROL CHARACTERS] */,\r\n  0xfeff,\r\n  0xfeff /* ZERO WIDTH NO-BREAK SPACE */,\r\n  0xfff9,\r\n  0xfffc /* [CONTROL CHARACTERS] */,\r\n  0x1d173,\r\n  0x1d17a /* [MUSICAL CONTROL CHARACTERS] */\r\n];\r\n\r\nconst non_character_codepoints = [\r\n  /**\r\n   * C.4 Non-character code points\r\n   * @link https://tools.ietf.org/html/rfc3454#appendix-C.4\r\n   */\r\n  0xfdd0,\r\n  0xfdef /* [NONCHARACTER CODE POINTS] */,\r\n  0xfffe,\r\n  0xffff /* [NONCHARACTER CODE POINTS] */,\r\n  0x1fffe,\r\n  0x1ffff /* [NONCHARACTER CODE POINTS] */,\r\n  0x2fffe,\r\n  0x2ffff /* [NONCHARACTER CODE POINTS] */,\r\n  0x3fffe,\r\n  0x3ffff /* [NONCHARACTER CODE POINTS] */,\r\n  0x4fffe,\r\n  0x4ffff /* [NONCHARACTER CODE POINTS] */,\r\n  0x5fffe,\r\n  0x5ffff /* [NONCHARACTER CODE POINTS] */,\r\n  0x6fffe,\r\n  0x6ffff /* [NONCHARACTER CODE POINTS] */,\r\n  0x7fffe,\r\n  0x7ffff /* [NONCHARACTER CODE POINTS] */,\r\n  0x8fffe,\r\n  0x8ffff /* [NONCHARACTER CODE POINTS] */,\r\n  0x9fffe,\r\n  0x9ffff /* [NONCHARACTER CODE POINTS] */,\r\n  0xafffe,\r\n  0xaffff /* [NONCHARACTER CODE POINTS] */,\r\n  0xbfffe,\r\n  0xbffff /* [NONCHARACTER CODE POINTS] */,\r\n  0xcfffe,\r\n  0xcffff /* [NONCHARACTER CODE POINTS] */,\r\n  0xdfffe,\r\n  0xdffff /* [NONCHARACTER CODE POINTS] */,\r\n  0xefffe,\r\n  0xeffff /* [NONCHARACTER CODE POINTS] */,\r\n  0x10fffe,\r\n  0x10ffff /* [NONCHARACTER CODE POINTS] */\r\n];\r\n\r\n/**\r\n * 2.3.  Prohibited Output\r\n */\r\nconst prohibited_characters = [\r\n  /**\r\n   * C.2.1 ASCII control characters\r\n   * @link https://tools.ietf.org/html/rfc3454#appendix-C.2.1\r\n   */\r\n  0,\r\n  0x001f /* [CONTROL CHARACTERS] */,\r\n  0x007f,\r\n  0x007f /* DELETE */,\r\n\r\n  /**\r\n   * C.8 Change display properties or are deprecated\r\n   * @link https://tools.ietf.org/html/rfc3454#appendix-C.8\r\n   */\r\n  0x0340,\r\n  0x0340 /* COMBINING GRAVE TONE MARK */,\r\n  0x0341,\r\n  0x0341 /* COMBINING ACUTE TONE MARK */,\r\n  0x200e,\r\n  0x200e /* LEFT-TO-RIGHT MARK */,\r\n  0x200f,\r\n  0x200f /* RIGHT-TO-LEFT MARK */,\r\n  0x202a,\r\n  0x202a /* LEFT-TO-RIGHT EMBEDDING */,\r\n  0x202b,\r\n  0x202b /* RIGHT-TO-LEFT EMBEDDING */,\r\n  0x202c,\r\n  0x202c /* POP DIRECTIONAL FORMATTING */,\r\n  0x202d,\r\n  0x202d /* LEFT-TO-RIGHT OVERRIDE */,\r\n  0x202e,\r\n  0x202e /* RIGHT-TO-LEFT OVERRIDE */,\r\n  0x206a,\r\n  0x206a /* INHIBIT SYMMETRIC SWAPPING */,\r\n  0x206b,\r\n  0x206b /* ACTIVATE SYMMETRIC SWAPPING */,\r\n  0x206c,\r\n  0x206c /* INHIBIT ARABIC FORM SHAPING */,\r\n  0x206d,\r\n  0x206d /* ACTIVATE ARABIC FORM SHAPING */,\r\n  0x206e,\r\n  0x206e /* NATIONAL DIGIT SHAPES */,\r\n  0x206f,\r\n  0x206f /* NOMINAL DIGIT SHAPES */,\r\n\r\n  /**\r\n   * C.7 Inappropriate for canonical representation\r\n   * @link https://tools.ietf.org/html/rfc3454#appendix-C.7\r\n   */\r\n  0x2ff0,\r\n  0x2ffb /* [IDEOGRAPHIC DESCRIPTION CHARACTERS] */,\r\n\r\n  /**\r\n   * C.5 Surrogate codes\r\n   * @link https://tools.ietf.org/html/rfc3454#appendix-C.5\r\n   */\r\n  0xd800,\r\n  0xdfff,\r\n\r\n  /**\r\n   * C.3 Private use\r\n   * @link https://tools.ietf.org/html/rfc3454#appendix-C.3\r\n   */\r\n  0xe000,\r\n  0xf8ff /* [PRIVATE USE, PLANE 0] */,\r\n\r\n  /**\r\n   * C.6 Inappropriate for plain text\r\n   * @link https://tools.ietf.org/html/rfc3454#appendix-C.6\r\n   */\r\n  0xfff9,\r\n  0xfff9 /* INTERLINEAR ANNOTATION ANCHOR */,\r\n  0xfffa,\r\n  0xfffa /* INTERLINEAR ANNOTATION SEPARATOR */,\r\n  0xfffb,\r\n  0xfffb /* INTERLINEAR ANNOTATION TERMINATOR */,\r\n  0xfffc,\r\n  0xfffc /* OBJECT REPLACEMENT CHARACTER */,\r\n  0xfffd,\r\n  0xfffd /* REPLACEMENT CHARACTER */,\r\n\r\n  /**\r\n   * C.9 Tagging characters\r\n   * @link https://tools.ietf.org/html/rfc3454#appendix-C.9\r\n   */\r\n  0xe0001,\r\n  0xe0001 /* LANGUAGE TAG */,\r\n  0xe0020,\r\n  0xe007f /* [TAGGING CHARACTERS] */,\r\n\r\n  /**\r\n   * C.3 Private use\r\n   * @link https://tools.ietf.org/html/rfc3454#appendix-C.3\r\n   */\r\n\r\n  0xf0000,\r\n  0xffffd /* [PRIVATE USE, PLANE 15] */,\r\n  0x100000,\r\n  0x10fffd /* [PRIVATE USE, PLANE 16] */\r\n];\r\n// prettier-ignore-end\r\n\r\nconst isProhibitedCharacter = character =>\r\n  inRange(character, non_ASCII_space_characters) ||\r\n  inRange(character, prohibited_characters) ||\r\n  inRange(character, non_ASCII_controls_characters) ||\r\n  inRange(character, non_character_codepoints);\r\n\r\n// prettier-ignore-start\r\n/**\r\n * D.1 Characters with bidirectional property \"R\" or \"AL\"\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-D.1\r\n */\r\nconst bidirectional_r_al = [\r\n  0x05be,\r\n  0x05be,\r\n  0x05c0,\r\n  0x05c0,\r\n  0x05c3,\r\n  0x05c3,\r\n  0x05d0,\r\n  0x05ea,\r\n  0x05f0,\r\n  0x05f4,\r\n  0x061b,\r\n  0x061b,\r\n  0x061f,\r\n  0x061f,\r\n  0x0621,\r\n  0x063a,\r\n  0x0640,\r\n  0x064a,\r\n  0x066d,\r\n  0x066f,\r\n  0x0671,\r\n  0x06d5,\r\n  0x06dd,\r\n  0x06dd,\r\n  0x06e5,\r\n  0x06e6,\r\n  0x06fa,\r\n  0x06fe,\r\n  0x0700,\r\n  0x070d,\r\n  0x0710,\r\n  0x0710,\r\n  0x0712,\r\n  0x072c,\r\n  0x0780,\r\n  0x07a5,\r\n  0x07b1,\r\n  0x07b1,\r\n  0x200f,\r\n  0x200f,\r\n  0xfb1d,\r\n  0xfb1d,\r\n  0xfb1f,\r\n  0xfb28,\r\n  0xfb2a,\r\n  0xfb36,\r\n  0xfb38,\r\n  0xfb3c,\r\n  0xfb3e,\r\n  0xfb3e,\r\n  0xfb40,\r\n  0xfb41,\r\n  0xfb43,\r\n  0xfb44,\r\n  0xfb46,\r\n  0xfbb1,\r\n  0xfbd3,\r\n  0xfd3d,\r\n  0xfd50,\r\n  0xfd8f,\r\n  0xfd92,\r\n  0xfdc7,\r\n  0xfdf0,\r\n  0xfdfc,\r\n  0xfe70,\r\n  0xfe74,\r\n  0xfe76,\r\n  0xfefc\r\n];\r\n// prettier-ignore-end\r\n\r\nconst isBidirectionalRAL = character => inRange(character, bidirectional_r_al);\r\n\r\n// prettier-ignore-start\r\n/**\r\n * D.2 Characters with bidirectional property \"L\"\r\n * @link https://tools.ietf.org/html/rfc3454#appendix-D.2\r\n */\r\nconst bidirectional_l = [\r\n  0x0041,\r\n  0x005a,\r\n  0x0061,\r\n  0x007a,\r\n  0x00aa,\r\n  0x00aa,\r\n  0x00b5,\r\n  0x00b5,\r\n  0x00ba,\r\n  0x00ba,\r\n  0x00c0,\r\n  0x00d6,\r\n  0x00d8,\r\n  0x00f6,\r\n  0x00f8,\r\n  0x0220,\r\n  0x0222,\r\n  0x0233,\r\n  0x0250,\r\n  0x02ad,\r\n  0x02b0,\r\n  0x02b8,\r\n  0x02bb,\r\n  0x02c1,\r\n  0x02d0,\r\n  0x02d1,\r\n  0x02e0,\r\n  0x02e4,\r\n  0x02ee,\r\n  0x02ee,\r\n  0x037a,\r\n  0x037a,\r\n  0x0386,\r\n  0x0386,\r\n  0x0388,\r\n  0x038a,\r\n  0x038c,\r\n  0x038c,\r\n  0x038e,\r\n  0x03a1,\r\n  0x03a3,\r\n  0x03ce,\r\n  0x03d0,\r\n  0x03f5,\r\n  0x0400,\r\n  0x0482,\r\n  0x048a,\r\n  0x04ce,\r\n  0x04d0,\r\n  0x04f5,\r\n  0x04f8,\r\n  0x04f9,\r\n  0x0500,\r\n  0x050f,\r\n  0x0531,\r\n  0x0556,\r\n  0x0559,\r\n  0x055f,\r\n  0x0561,\r\n  0x0587,\r\n  0x0589,\r\n  0x0589,\r\n  0x0903,\r\n  0x0903,\r\n  0x0905,\r\n  0x0939,\r\n  0x093d,\r\n  0x0940,\r\n  0x0949,\r\n  0x094c,\r\n  0x0950,\r\n  0x0950,\r\n  0x0958,\r\n  0x0961,\r\n  0x0964,\r\n  0x0970,\r\n  0x0982,\r\n  0x0983,\r\n  0x0985,\r\n  0x098c,\r\n  0x098f,\r\n  0x0990,\r\n  0x0993,\r\n  0x09a8,\r\n  0x09aa,\r\n  0x09b0,\r\n  0x09b2,\r\n  0x09b2,\r\n  0x09b6,\r\n  0x09b9,\r\n  0x09be,\r\n  0x09c0,\r\n  0x09c7,\r\n  0x09c8,\r\n  0x09cb,\r\n  0x09cc,\r\n  0x09d7,\r\n  0x09d7,\r\n  0x09dc,\r\n  0x09dd,\r\n  0x09df,\r\n  0x09e1,\r\n  0x09e6,\r\n  0x09f1,\r\n  0x09f4,\r\n  0x09fa,\r\n  0x0a05,\r\n  0x0a0a,\r\n  0x0a0f,\r\n  0x0a10,\r\n  0x0a13,\r\n  0x0a28,\r\n  0x0a2a,\r\n  0x0a30,\r\n  0x0a32,\r\n  0x0a33,\r\n  0x0a35,\r\n  0x0a36,\r\n  0x0a38,\r\n  0x0a39,\r\n  0x0a3e,\r\n  0x0a40,\r\n  0x0a59,\r\n  0x0a5c,\r\n  0x0a5e,\r\n  0x0a5e,\r\n  0x0a66,\r\n  0x0a6f,\r\n  0x0a72,\r\n  0x0a74,\r\n  0x0a83,\r\n  0x0a83,\r\n  0x0a85,\r\n  0x0a8b,\r\n  0x0a8d,\r\n  0x0a8d,\r\n  0x0a8f,\r\n  0x0a91,\r\n  0x0a93,\r\n  0x0aa8,\r\n  0x0aaa,\r\n  0x0ab0,\r\n  0x0ab2,\r\n  0x0ab3,\r\n  0x0ab5,\r\n  0x0ab9,\r\n  0x0abd,\r\n  0x0ac0,\r\n  0x0ac9,\r\n  0x0ac9,\r\n  0x0acb,\r\n  0x0acc,\r\n  0x0ad0,\r\n  0x0ad0,\r\n  0x0ae0,\r\n  0x0ae0,\r\n  0x0ae6,\r\n  0x0aef,\r\n  0x0b02,\r\n  0x0b03,\r\n  0x0b05,\r\n  0x0b0c,\r\n  0x0b0f,\r\n  0x0b10,\r\n  0x0b13,\r\n  0x0b28,\r\n  0x0b2a,\r\n  0x0b30,\r\n  0x0b32,\r\n  0x0b33,\r\n  0x0b36,\r\n  0x0b39,\r\n  0x0b3d,\r\n  0x0b3e,\r\n  0x0b40,\r\n  0x0b40,\r\n  0x0b47,\r\n  0x0b48,\r\n  0x0b4b,\r\n  0x0b4c,\r\n  0x0b57,\r\n  0x0b57,\r\n  0x0b5c,\r\n  0x0b5d,\r\n  0x0b5f,\r\n  0x0b61,\r\n  0x0b66,\r\n  0x0b70,\r\n  0x0b83,\r\n  0x0b83,\r\n  0x0b85,\r\n  0x0b8a,\r\n  0x0b8e,\r\n  0x0b90,\r\n  0x0b92,\r\n  0x0b95,\r\n  0x0b99,\r\n  0x0b9a,\r\n  0x0b9c,\r\n  0x0b9c,\r\n  0x0b9e,\r\n  0x0b9f,\r\n  0x0ba3,\r\n  0x0ba4,\r\n  0x0ba8,\r\n  0x0baa,\r\n  0x0bae,\r\n  0x0bb5,\r\n  0x0bb7,\r\n  0x0bb9,\r\n  0x0bbe,\r\n  0x0bbf,\r\n  0x0bc1,\r\n  0x0bc2,\r\n  0x0bc6,\r\n  0x0bc8,\r\n  0x0bca,\r\n  0x0bcc,\r\n  0x0bd7,\r\n  0x0bd7,\r\n  0x0be7,\r\n  0x0bf2,\r\n  0x0c01,\r\n  0x0c03,\r\n  0x0c05,\r\n  0x0c0c,\r\n  0x0c0e,\r\n  0x0c10,\r\n  0x0c12,\r\n  0x0c28,\r\n  0x0c2a,\r\n  0x0c33,\r\n  0x0c35,\r\n  0x0c39,\r\n  0x0c41,\r\n  0x0c44,\r\n  0x0c60,\r\n  0x0c61,\r\n  0x0c66,\r\n  0x0c6f,\r\n  0x0c82,\r\n  0x0c83,\r\n  0x0c85,\r\n  0x0c8c,\r\n  0x0c8e,\r\n  0x0c90,\r\n  0x0c92,\r\n  0x0ca8,\r\n  0x0caa,\r\n  0x0cb3,\r\n  0x0cb5,\r\n  0x0cb9,\r\n  0x0cbe,\r\n  0x0cbe,\r\n  0x0cc0,\r\n  0x0cc4,\r\n  0x0cc7,\r\n  0x0cc8,\r\n  0x0cca,\r\n  0x0ccb,\r\n  0x0cd5,\r\n  0x0cd6,\r\n  0x0cde,\r\n  0x0cde,\r\n  0x0ce0,\r\n  0x0ce1,\r\n  0x0ce6,\r\n  0x0cef,\r\n  0x0d02,\r\n  0x0d03,\r\n  0x0d05,\r\n  0x0d0c,\r\n  0x0d0e,\r\n  0x0d10,\r\n  0x0d12,\r\n  0x0d28,\r\n  0x0d2a,\r\n  0x0d39,\r\n  0x0d3e,\r\n  0x0d40,\r\n  0x0d46,\r\n  0x0d48,\r\n  0x0d4a,\r\n  0x0d4c,\r\n  0x0d57,\r\n  0x0d57,\r\n  0x0d60,\r\n  0x0d61,\r\n  0x0d66,\r\n  0x0d6f,\r\n  0x0d82,\r\n  0x0d83,\r\n  0x0d85,\r\n  0x0d96,\r\n  0x0d9a,\r\n  0x0db1,\r\n  0x0db3,\r\n  0x0dbb,\r\n  0x0dbd,\r\n  0x0dbd,\r\n  0x0dc0,\r\n  0x0dc6,\r\n  0x0dcf,\r\n  0x0dd1,\r\n  0x0dd8,\r\n  0x0ddf,\r\n  0x0df2,\r\n  0x0df4,\r\n  0x0e01,\r\n  0x0e30,\r\n  0x0e32,\r\n  0x0e33,\r\n  0x0e40,\r\n  0x0e46,\r\n  0x0e4f,\r\n  0x0e5b,\r\n  0x0e81,\r\n  0x0e82,\r\n  0x0e84,\r\n  0x0e84,\r\n  0x0e87,\r\n  0x0e88,\r\n  0x0e8a,\r\n  0x0e8a,\r\n  0x0e8d,\r\n  0x0e8d,\r\n  0x0e94,\r\n  0x0e97,\r\n  0x0e99,\r\n  0x0e9f,\r\n  0x0ea1,\r\n  0x0ea3,\r\n  0x0ea5,\r\n  0x0ea5,\r\n  0x0ea7,\r\n  0x0ea7,\r\n  0x0eaa,\r\n  0x0eab,\r\n  0x0ead,\r\n  0x0eb0,\r\n  0x0eb2,\r\n  0x0eb3,\r\n  0x0ebd,\r\n  0x0ebd,\r\n  0x0ec0,\r\n  0x0ec4,\r\n  0x0ec6,\r\n  0x0ec6,\r\n  0x0ed0,\r\n  0x0ed9,\r\n  0x0edc,\r\n  0x0edd,\r\n  0x0f00,\r\n  0x0f17,\r\n  0x0f1a,\r\n  0x0f34,\r\n  0x0f36,\r\n  0x0f36,\r\n  0x0f38,\r\n  0x0f38,\r\n  0x0f3e,\r\n  0x0f47,\r\n  0x0f49,\r\n  0x0f6a,\r\n  0x0f7f,\r\n  0x0f7f,\r\n  0x0f85,\r\n  0x0f85,\r\n  0x0f88,\r\n  0x0f8b,\r\n  0x0fbe,\r\n  0x0fc5,\r\n  0x0fc7,\r\n  0x0fcc,\r\n  0x0fcf,\r\n  0x0fcf,\r\n  0x1000,\r\n  0x1021,\r\n  0x1023,\r\n  0x1027,\r\n  0x1029,\r\n  0x102a,\r\n  0x102c,\r\n  0x102c,\r\n  0x1031,\r\n  0x1031,\r\n  0x1038,\r\n  0x1038,\r\n  0x1040,\r\n  0x1057,\r\n  0x10a0,\r\n  0x10c5,\r\n  0x10d0,\r\n  0x10f8,\r\n  0x10fb,\r\n  0x10fb,\r\n  0x1100,\r\n  0x1159,\r\n  0x115f,\r\n  0x11a2,\r\n  0x11a8,\r\n  0x11f9,\r\n  0x1200,\r\n  0x1206,\r\n  0x1208,\r\n  0x1246,\r\n  0x1248,\r\n  0x1248,\r\n  0x124a,\r\n  0x124d,\r\n  0x1250,\r\n  0x1256,\r\n  0x1258,\r\n  0x1258,\r\n  0x125a,\r\n  0x125d,\r\n  0x1260,\r\n  0x1286,\r\n  0x1288,\r\n  0x1288,\r\n  0x128a,\r\n  0x128d,\r\n  0x1290,\r\n  0x12ae,\r\n  0x12b0,\r\n  0x12b0,\r\n  0x12b2,\r\n  0x12b5,\r\n  0x12b8,\r\n  0x12be,\r\n  0x12c0,\r\n  0x12c0,\r\n  0x12c2,\r\n  0x12c5,\r\n  0x12c8,\r\n  0x12ce,\r\n  0x12d0,\r\n  0x12d6,\r\n  0x12d8,\r\n  0x12ee,\r\n  0x12f0,\r\n  0x130e,\r\n  0x1310,\r\n  0x1310,\r\n  0x1312,\r\n  0x1315,\r\n  0x1318,\r\n  0x131e,\r\n  0x1320,\r\n  0x1346,\r\n  0x1348,\r\n  0x135a,\r\n  0x1361,\r\n  0x137c,\r\n  0x13a0,\r\n  0x13f4,\r\n  0x1401,\r\n  0x1676,\r\n  0x1681,\r\n  0x169a,\r\n  0x16a0,\r\n  0x16f0,\r\n  0x1700,\r\n  0x170c,\r\n  0x170e,\r\n  0x1711,\r\n  0x1720,\r\n  0x1731,\r\n  0x1735,\r\n  0x1736,\r\n  0x1740,\r\n  0x1751,\r\n  0x1760,\r\n  0x176c,\r\n  0x176e,\r\n  0x1770,\r\n  0x1780,\r\n  0x17b6,\r\n  0x17be,\r\n  0x17c5,\r\n  0x17c7,\r\n  0x17c8,\r\n  0x17d4,\r\n  0x17da,\r\n  0x17dc,\r\n  0x17dc,\r\n  0x17e0,\r\n  0x17e9,\r\n  0x1810,\r\n  0x1819,\r\n  0x1820,\r\n  0x1877,\r\n  0x1880,\r\n  0x18a8,\r\n  0x1e00,\r\n  0x1e9b,\r\n  0x1ea0,\r\n  0x1ef9,\r\n  0x1f00,\r\n  0x1f15,\r\n  0x1f18,\r\n  0x1f1d,\r\n  0x1f20,\r\n  0x1f45,\r\n  0x1f48,\r\n  0x1f4d,\r\n  0x1f50,\r\n  0x1f57,\r\n  0x1f59,\r\n  0x1f59,\r\n  0x1f5b,\r\n  0x1f5b,\r\n  0x1f5d,\r\n  0x1f5d,\r\n  0x1f5f,\r\n  0x1f7d,\r\n  0x1f80,\r\n  0x1fb4,\r\n  0x1fb6,\r\n  0x1fbc,\r\n  0x1fbe,\r\n  0x1fbe,\r\n  0x1fc2,\r\n  0x1fc4,\r\n  0x1fc6,\r\n  0x1fcc,\r\n  0x1fd0,\r\n  0x1fd3,\r\n  0x1fd6,\r\n  0x1fdb,\r\n  0x1fe0,\r\n  0x1fec,\r\n  0x1ff2,\r\n  0x1ff4,\r\n  0x1ff6,\r\n  0x1ffc,\r\n  0x200e,\r\n  0x200e,\r\n  0x2071,\r\n  0x2071,\r\n  0x207f,\r\n  0x207f,\r\n  0x2102,\r\n  0x2102,\r\n  0x2107,\r\n  0x2107,\r\n  0x210a,\r\n  0x2113,\r\n  0x2115,\r\n  0x2115,\r\n  0x2119,\r\n  0x211d,\r\n  0x2124,\r\n  0x2124,\r\n  0x2126,\r\n  0x2126,\r\n  0x2128,\r\n  0x2128,\r\n  0x212a,\r\n  0x212d,\r\n  0x212f,\r\n  0x2131,\r\n  0x2133,\r\n  0x2139,\r\n  0x213d,\r\n  0x213f,\r\n  0x2145,\r\n  0x2149,\r\n  0x2160,\r\n  0x2183,\r\n  0x2336,\r\n  0x237a,\r\n  0x2395,\r\n  0x2395,\r\n  0x249c,\r\n  0x24e9,\r\n  0x3005,\r\n  0x3007,\r\n  0x3021,\r\n  0x3029,\r\n  0x3031,\r\n  0x3035,\r\n  0x3038,\r\n  0x303c,\r\n  0x3041,\r\n  0x3096,\r\n  0x309d,\r\n  0x309f,\r\n  0x30a1,\r\n  0x30fa,\r\n  0x30fc,\r\n  0x30ff,\r\n  0x3105,\r\n  0x312c,\r\n  0x3131,\r\n  0x318e,\r\n  0x3190,\r\n  0x31b7,\r\n  0x31f0,\r\n  0x321c,\r\n  0x3220,\r\n  0x3243,\r\n  0x3260,\r\n  0x327b,\r\n  0x327f,\r\n  0x32b0,\r\n  0x32c0,\r\n  0x32cb,\r\n  0x32d0,\r\n  0x32fe,\r\n  0x3300,\r\n  0x3376,\r\n  0x337b,\r\n  0x33dd,\r\n  0x33e0,\r\n  0x33fe,\r\n  0x3400,\r\n  0x4db5,\r\n  0x4e00,\r\n  0x9fa5,\r\n  0xa000,\r\n  0xa48c,\r\n  0xac00,\r\n  0xd7a3,\r\n  0xd800,\r\n  0xfa2d,\r\n  0xfa30,\r\n  0xfa6a,\r\n  0xfb00,\r\n  0xfb06,\r\n  0xfb13,\r\n  0xfb17,\r\n  0xff21,\r\n  0xff3a,\r\n  0xff41,\r\n  0xff5a,\r\n  0xff66,\r\n  0xffbe,\r\n  0xffc2,\r\n  0xffc7,\r\n  0xffca,\r\n  0xffcf,\r\n  0xffd2,\r\n  0xffd7,\r\n  0xffda,\r\n  0xffdc,\r\n  0x10300,\r\n  0x1031e,\r\n  0x10320,\r\n  0x10323,\r\n  0x10330,\r\n  0x1034a,\r\n  0x10400,\r\n  0x10425,\r\n  0x10428,\r\n  0x1044d,\r\n  0x1d000,\r\n  0x1d0f5,\r\n  0x1d100,\r\n  0x1d126,\r\n  0x1d12a,\r\n  0x1d166,\r\n  0x1d16a,\r\n  0x1d172,\r\n  0x1d183,\r\n  0x1d184,\r\n  0x1d18c,\r\n  0x1d1a9,\r\n  0x1d1ae,\r\n  0x1d1dd,\r\n  0x1d400,\r\n  0x1d454,\r\n  0x1d456,\r\n  0x1d49c,\r\n  0x1d49e,\r\n  0x1d49f,\r\n  0x1d4a2,\r\n  0x1d4a2,\r\n  0x1d4a5,\r\n  0x1d4a6,\r\n  0x1d4a9,\r\n  0x1d4ac,\r\n  0x1d4ae,\r\n  0x1d4b9,\r\n  0x1d4bb,\r\n  0x1d4bb,\r\n  0x1d4bd,\r\n  0x1d4c0,\r\n  0x1d4c2,\r\n  0x1d4c3,\r\n  0x1d4c5,\r\n  0x1d505,\r\n  0x1d507,\r\n  0x1d50a,\r\n  0x1d50d,\r\n  0x1d514,\r\n  0x1d516,\r\n  0x1d51c,\r\n  0x1d51e,\r\n  0x1d539,\r\n  0x1d53b,\r\n  0x1d53e,\r\n  0x1d540,\r\n  0x1d544,\r\n  0x1d546,\r\n  0x1d546,\r\n  0x1d54a,\r\n  0x1d550,\r\n  0x1d552,\r\n  0x1d6a3,\r\n  0x1d6a8,\r\n  0x1d7c9,\r\n  0x20000,\r\n  0x2a6d6,\r\n  0x2f800,\r\n  0x2fa1d,\r\n  0xf0000,\r\n  0xffffd,\r\n  0x100000,\r\n  0x10fffd\r\n];\r\n// prettier-ignore-end\r\n\r\nconst isBidirectionalL = character => inRange(character, bidirectional_l);\r\n\r\nexport {\r\n  isUnassignedCodePoint,\r\n  isCommonlyMappedToNothing,\r\n  isNonASCIISpaceCharacter,\r\n  isProhibitedCharacter,\r\n  isBidirectionalRAL,\r\n  isBidirectionalL\r\n};\r\n","import {\r\n  isUnassignedCodePoint,\r\n  isCommonlyMappedToNothing,\r\n  isNonASCIISpaceCharacter,\r\n  isProhibitedCharacter,\r\n  isBidirectionalRAL,\r\n  isBidirectionalL\r\n} from './lib/code-points';\r\n\r\n// 2.1.  Mapping\r\n\r\n/**\r\n * non-ASCII space characters [StringPrep, C.1.2] that can be\r\n * mapped to SPACE (U+0020)\r\n */\r\nconst mapping2space = isNonASCIISpaceCharacter;\r\n\r\n/**\r\n * the \"commonly mapped to nothing\" characters [StringPrep, B.1]\r\n * that can be mapped to nothing.\r\n */\r\nconst mapping2nothing = isCommonlyMappedToNothing;\r\n\r\n// utils\r\nconst getCodePoint = character => character.codePointAt(0);\r\nconst first = x => x[0];\r\nconst last = x => x[x.length - 1];\r\n\r\n/**\r\n * Convert provided string into an array of Unicode Code Points.\r\n * Based on https://stackoverflow.com/a/21409165/1556249\r\n * and https://www.npmjs.com/package/code-point-at.\r\n * @param {string} input\r\n * @returns {number[]}\r\n */\r\nfunction toCodePoints(input) {\r\n  const codepoints = [];\r\n  const size = input.length;\r\n\r\n  for (let i = 0; i < size; i += 1) {\r\n    const before = input.charCodeAt(i);\r\n\r\n    if (before >= 0xd800 && before <= 0xdbff && size > i + 1) {\r\n      const next = input.charCodeAt(i + 1);\r\n\r\n      if (next >= 0xdc00 && next <= 0xdfff) {\r\n        codepoints.push((before - 0xd800) * 0x400 + next - 0xdc00 + 0x10000);\r\n        i += 1;\r\n        continue;\r\n      }\r\n    }\r\n\r\n    codepoints.push(before);\r\n  }\r\n\r\n  return codepoints;\r\n}\r\n\r\n/**\r\n * SASLprep.\r\n * @param {string} input\r\n * @param {Object} opts\r\n * @param {boolean} opts.allowUnassigned\r\n * @returns {string}\r\n */\r\nfunction saslprep(input, opts = {}) {\r\n  if (typeof input !== 'string') {\r\n    throw new TypeError('Expected string.');\r\n  }\r\n\r\n  if (input.length === 0) {\r\n    return '';\r\n  }\r\n\r\n  // 1. Map\r\n  const mapped_input = toCodePoints(input)\r\n    // 1.1 mapping to space\r\n    .map(character => (mapping2space(character) ? 0x20 : character))\r\n    // 1.2 mapping to nothing\r\n    .filter(character => !mapping2nothing(character));\r\n\r\n  // 2. Normalize\r\n  const normalized_input = String.fromCodePoint\r\n    .apply(null, mapped_input)\r\n    .normalize('NFKC');\r\n\r\n  const normalized_map = toCodePoints(normalized_input);\r\n\r\n  // 3. Prohibit\r\n  const hasProhibited = normalized_map.some(isProhibitedCharacter);\r\n\r\n  if (hasProhibited) {\r\n    throw new Error(\r\n      'Prohibited character, see https://tools.ietf.org/html/rfc4013#section-2.3'\r\n    );\r\n  }\r\n\r\n  // Unassigned Code Points\r\n  if (opts.allowUnassigned !== true) {\r\n    const hasUnassigned = normalized_map.some(isUnassignedCodePoint);\r\n\r\n    if (hasUnassigned) {\r\n      throw new Error(\r\n        'Unassigned code point, see https://tools.ietf.org/html/rfc4013#section-2.5'\r\n      );\r\n    }\r\n  }\r\n\r\n  // 4. check bidi\r\n\r\n  const hasBidiRAL = normalized_map.some(isBidirectionalRAL);\r\n\r\n  const hasBidiL = normalized_map.some(isBidirectionalL);\r\n\r\n  // 4.1 If a string contains any RandALCat character, the string MUST NOT\r\n  // contain any LCat character.\r\n  if (hasBidiRAL && hasBidiL) {\r\n    throw new Error(\r\n      'String must not contain RandALCat and LCat at the same time,' +\r\n        ' see https://tools.ietf.org/html/rfc3454#section-6'\r\n    );\r\n  }\r\n\r\n  /**\r\n   * 4.2 If a string contains any RandALCat character, a RandALCat\r\n   * character MUST be the first character of the string, and a\r\n   * RandALCat character MUST be the last character of the string.\r\n   */\r\n\r\n  const isFirstBidiRAL = isBidirectionalRAL(\r\n    getCodePoint(first(normalized_input))\r\n  );\r\n  const isLastBidiRAL = isBidirectionalRAL(\r\n    getCodePoint(last(normalized_input))\r\n  );\r\n\r\n  if (hasBidiRAL && !(isFirstBidiRAL && isLastBidiRAL)) {\r\n    throw new Error(\r\n      'Bidirectional RandALCat character must be the first and the last' +\r\n        ' character of the string, see https://tools.ietf.org/html/rfc3454#section-6'\r\n    );\r\n  }\r\n\r\n  return normalized_input;\r\n}\r\n\r\nexport default saslprep;\r\n","/*\r\n   PDFSecurity - represents PDF security settings\r\n   By Yang Liu <hi@zesik.com>\r\n */\r\n\r\nimport CryptoJS from 'crypto-js';\r\nimport saslprep from './saslprep/index';\r\n\r\nclass PDFSecurity {\r\n  static generateFileID(info = {}) {\r\n    let infoStr = `${info.CreationDate.getTime()}\\n`;\r\n\r\n    for (let key in info) {\r\n      // eslint-disable-next-line no-prototype-builtins\r\n      if (!info.hasOwnProperty(key)) {\r\n        continue;\r\n      }\r\n      infoStr += `${key}: ${info[key].valueOf()}\\n`;\r\n    }\r\n\r\n    return wordArrayToBuffer(CryptoJS.MD5(infoStr));\r\n  }\r\n\r\n  static generateRandomWordArray(bytes) {\r\n    return CryptoJS.lib.WordArray.random(bytes);\r\n  }\r\n\r\n  static create(document, options = {}) {\r\n    if (!options.ownerPassword && !options.userPassword) {\r\n      return null;\r\n    }\r\n    return new PDFSecurity(document, options);\r\n  }\r\n\r\n  constructor(document, options = {}) {\r\n    if (!options.ownerPassword && !options.userPassword) {\r\n      throw new Error('None of owner password and user password is defined.');\r\n    }\r\n\r\n    this.document = document;\r\n    this._setupEncryption(options);\r\n  }\r\n\r\n  _setupEncryption(options) {\r\n    switch (options.pdfVersion) {\r\n      case '1.4':\r\n      case '1.5':\r\n        this.version = 2;\r\n        break;\r\n      case '1.6':\r\n      case '1.7':\r\n        this.version = 4;\r\n        break;\r\n      case '1.7ext3':\r\n        this.version = 5;\r\n        break;\r\n      default:\r\n        this.version = 1;\r\n        break;\r\n    }\r\n\r\n    const encDict = {\r\n      Filter: 'Standard'\r\n    };\r\n\r\n    switch (this.version) {\r\n      case 1:\r\n      case 2:\r\n      case 4:\r\n        this._setupEncryptionV1V2V4(this.version, encDict, options);\r\n        break;\r\n      case 5:\r\n        this._setupEncryptionV5(encDict, options);\r\n        break;\r\n    }\r\n\r\n    this.dictionary = this.document.ref(encDict);\r\n  }\r\n\r\n  _setupEncryptionV1V2V4(v, encDict, options) {\r\n    let r, permissions;\r\n    switch (v) {\r\n      case 1:\r\n        r = 2;\r\n        this.keyBits = 40;\r\n        permissions = getPermissionsR2(options.permissions);\r\n        break;\r\n      case 2:\r\n        r = 3;\r\n        this.keyBits = 128;\r\n        permissions = getPermissionsR3(options.permissions);\r\n        break;\r\n      case 4:\r\n        r = 4;\r\n        this.keyBits = 128;\r\n        permissions = getPermissionsR3(options.permissions);\r\n        break;\r\n    }\r\n\r\n    const paddedUserPassword = processPasswordR2R3R4(options.userPassword);\r\n    const paddedOwnerPassword = options.ownerPassword\r\n      ? processPasswordR2R3R4(options.ownerPassword)\r\n      : paddedUserPassword;\r\n\r\n    const ownerPasswordEntry = getOwnerPasswordR2R3R4(\r\n      r,\r\n      this.keyBits,\r\n      paddedUserPassword,\r\n      paddedOwnerPassword\r\n    );\r\n    this.encryptionKey = getEncryptionKeyR2R3R4(\r\n      r,\r\n      this.keyBits,\r\n      this.document._id,\r\n      paddedUserPassword,\r\n      ownerPasswordEntry,\r\n      permissions\r\n    );\r\n    let userPasswordEntry;\r\n    if (r === 2) {\r\n      userPasswordEntry = getUserPasswordR2(this.encryptionKey);\r\n    } else {\r\n      userPasswordEntry = getUserPasswordR3R4(\r\n        this.document._id,\r\n        this.encryptionKey\r\n      );\r\n    }\r\n\r\n    encDict.V = v;\r\n    if (v >= 2) {\r\n      encDict.Length = this.keyBits;\r\n    }\r\n    if (v === 4) {\r\n      encDict.CF = {\r\n        StdCF: {\r\n          AuthEvent: 'DocOpen',\r\n          CFM: 'AESV2',\r\n          Length: this.keyBits / 8\r\n        }\r\n      };\r\n      encDict.StmF = 'StdCF';\r\n      encDict.StrF = 'StdCF';\r\n    }\r\n    encDict.R = r;\r\n    encDict.O = wordArrayToBuffer(ownerPasswordEntry);\r\n    encDict.U = wordArrayToBuffer(userPasswordEntry);\r\n    encDict.P = permissions;\r\n  }\r\n\r\n  _setupEncryptionV5(encDict, options) {\r\n    this.keyBits = 256;\r\n    const permissions = getPermissionsR3(options.permissions);\r\n\r\n    const processedUserPassword = processPasswordR5(options.userPassword);\r\n    const processedOwnerPassword = options.ownerPassword\r\n      ? processPasswordR5(options.ownerPassword)\r\n      : processedUserPassword;\r\n\r\n    this.encryptionKey = getEncryptionKeyR5(\r\n      PDFSecurity.generateRandomWordArray\r\n    );\r\n    const userPasswordEntry = getUserPasswordR5(\r\n      processedUserPassword,\r\n      PDFSecurity.generateRandomWordArray\r\n    );\r\n    const userKeySalt = CryptoJS.lib.WordArray.create(\r\n      userPasswordEntry.words.slice(10, 12),\r\n      8\r\n    );\r\n    const userEncryptionKeyEntry = getUserEncryptionKeyR5(\r\n      processedUserPassword,\r\n      userKeySalt,\r\n      this.encryptionKey\r\n    );\r\n    const ownerPasswordEntry = getOwnerPasswordR5(\r\n      processedOwnerPassword,\r\n      userPasswordEntry,\r\n      PDFSecurity.generateRandomWordArray\r\n    );\r\n    const ownerKeySalt = CryptoJS.lib.WordArray.create(\r\n      ownerPasswordEntry.words.slice(10, 12),\r\n      8\r\n    );\r\n    const ownerEncryptionKeyEntry = getOwnerEncryptionKeyR5(\r\n      processedOwnerPassword,\r\n      ownerKeySalt,\r\n      userPasswordEntry,\r\n      this.encryptionKey\r\n    );\r\n    const permsEntry = getEncryptedPermissionsR5(\r\n      permissions,\r\n      this.encryptionKey,\r\n      PDFSecurity.generateRandomWordArray\r\n    );\r\n\r\n    encDict.V = 5;\r\n    encDict.Length = this.keyBits;\r\n    encDict.CF = {\r\n      StdCF: {\r\n        AuthEvent: 'DocOpen',\r\n        CFM: 'AESV3',\r\n        Length: this.keyBits / 8\r\n      }\r\n    };\r\n    encDict.StmF = 'StdCF';\r\n    encDict.StrF = 'StdCF';\r\n    encDict.R = 5;\r\n    encDict.O = wordArrayToBuffer(ownerPasswordEntry);\r\n    encDict.OE = wordArrayToBuffer(ownerEncryptionKeyEntry);\r\n    encDict.U = wordArrayToBuffer(userPasswordEntry);\r\n    encDict.UE = wordArrayToBuffer(userEncryptionKeyEntry);\r\n    encDict.P = permissions;\r\n    encDict.Perms = wordArrayToBuffer(permsEntry);\r\n  }\r\n\r\n  getEncryptFn(obj, gen) {\r\n    let digest;\r\n    if (this.version < 5) {\r\n      digest = this.encryptionKey\r\n        .clone()\r\n        .concat(\r\n          CryptoJS.lib.WordArray.create(\r\n            [\r\n              ((obj & 0xff) << 24) |\r\n                ((obj & 0xff00) << 8) |\r\n                ((obj >> 8) & 0xff00) |\r\n                (gen & 0xff),\r\n              (gen & 0xff00) << 16\r\n            ],\r\n            5\r\n          )\r\n        );\r\n    }\r\n\r\n    if (this.version === 1 || this.version === 2) {\r\n      let key = CryptoJS.MD5(digest);\r\n      key.sigBytes = Math.min(16, this.keyBits / 8 + 5);\r\n      return buffer =>\r\n        wordArrayToBuffer(\r\n          CryptoJS.RC4.encrypt(CryptoJS.lib.WordArray.create(buffer), key)\r\n            .ciphertext\r\n        );\r\n    }\r\n\r\n    let key;\r\n    if (this.version === 4) {\r\n      key = CryptoJS.MD5(\r\n        digest.concat(CryptoJS.lib.WordArray.create([0x73416c54], 4))\r\n      );\r\n    } else {\r\n      key = this.encryptionKey;\r\n    }\r\n\r\n    const iv = PDFSecurity.generateRandomWordArray(16);\r\n    const options = {\r\n      mode: CryptoJS.mode.CBC,\r\n      padding: CryptoJS.pad.Pkcs7,\r\n      iv\r\n    };\r\n\r\n    return buffer =>\r\n      wordArrayToBuffer(\r\n        iv\r\n          .clone()\r\n          .concat(\r\n            CryptoJS.AES.encrypt(\r\n              CryptoJS.lib.WordArray.create(buffer),\r\n              key,\r\n              options\r\n            ).ciphertext\r\n          )\r\n      );\r\n  }\r\n\r\n  end() {\r\n    this.dictionary.end();\r\n  }\r\n}\r\n\r\nfunction getPermissionsR2(permissionObject = {}) {\r\n  let permissions = 0xffffffc0 >> 0;\r\n  if (permissionObject.printing) {\r\n    permissions |= 0b000000000100;\r\n  }\r\n  if (permissionObject.modifying) {\r\n    permissions |= 0b000000001000;\r\n  }\r\n  if (permissionObject.copying) {\r\n    permissions |= 0b000000010000;\r\n  }\r\n  if (permissionObject.annotating) {\r\n    permissions |= 0b000000100000;\r\n  }\r\n  return permissions;\r\n}\r\n\r\nfunction getPermissionsR3(permissionObject = {}) {\r\n  let permissions = 0xfffff0c0 >> 0;\r\n  if (permissionObject.printing === 'lowResolution') {\r\n    permissions |= 0b000000000100;\r\n  }\r\n  if (permissionObject.printing === 'highResolution') {\r\n    permissions |= 0b100000000100;\r\n  }\r\n  if (permissionObject.modifying) {\r\n    permissions |= 0b000000001000;\r\n  }\r\n  if (permissionObject.copying) {\r\n    permissions |= 0b000000010000;\r\n  }\r\n  if (permissionObject.annotating) {\r\n    permissions |= 0b000000100000;\r\n  }\r\n  if (permissionObject.fillingForms) {\r\n    permissions |= 0b000100000000;\r\n  }\r\n  if (permissionObject.contentAccessibility) {\r\n    permissions |= 0b001000000000;\r\n  }\r\n  if (permissionObject.documentAssembly) {\r\n    permissions |= 0b010000000000;\r\n  }\r\n  return permissions;\r\n}\r\n\r\nfunction getUserPasswordR2(encryptionKey) {\r\n  return CryptoJS.RC4.encrypt(processPasswordR2R3R4(), encryptionKey)\r\n    .ciphertext;\r\n}\r\n\r\nfunction getUserPasswordR3R4(documentId, encryptionKey) {\r\n  const key = encryptionKey.clone();\r\n  let cipher = CryptoJS.MD5(\r\n    processPasswordR2R3R4().concat(CryptoJS.lib.WordArray.create(documentId))\r\n  );\r\n  for (let i = 0; i < 20; i++) {\r\n    const xorRound = Math.ceil(key.sigBytes / 4);\r\n    for (let j = 0; j < xorRound; j++) {\r\n      key.words[j] =\r\n        encryptionKey.words[j] ^ (i | (i << 8) | (i << 16) | (i << 24));\r\n    }\r\n    cipher = CryptoJS.RC4.encrypt(cipher, key).ciphertext;\r\n  }\r\n  return cipher.concat(CryptoJS.lib.WordArray.create(null, 16));\r\n}\r\n\r\nfunction getOwnerPasswordR2R3R4(\r\n  r,\r\n  keyBits,\r\n  paddedUserPassword,\r\n  paddedOwnerPassword\r\n) {\r\n  let digest = paddedOwnerPassword;\r\n  let round = r >= 3 ? 51 : 1;\r\n  for (let i = 0; i < round; i++) {\r\n    digest = CryptoJS.MD5(digest);\r\n  }\r\n\r\n  const key = digest.clone();\r\n  key.sigBytes = keyBits / 8;\r\n  let cipher = paddedUserPassword;\r\n  round = r >= 3 ? 20 : 1;\r\n  for (let i = 0; i < round; i++) {\r\n    const xorRound = Math.ceil(key.sigBytes / 4);\r\n    for (let j = 0; j < xorRound; j++) {\r\n      key.words[j] = digest.words[j] ^ (i | (i << 8) | (i << 16) | (i << 24));\r\n    }\r\n    cipher = CryptoJS.RC4.encrypt(cipher, key).ciphertext;\r\n  }\r\n  return cipher;\r\n}\r\n\r\nfunction getEncryptionKeyR2R3R4(\r\n  r,\r\n  keyBits,\r\n  documentId,\r\n  paddedUserPassword,\r\n  ownerPasswordEntry,\r\n  permissions\r\n) {\r\n  let key = paddedUserPassword\r\n    .clone()\r\n    .concat(ownerPasswordEntry)\r\n    .concat(CryptoJS.lib.WordArray.create([lsbFirstWord(permissions)], 4))\r\n    .concat(CryptoJS.lib.WordArray.create(documentId));\r\n  const round = r >= 3 ? 51 : 1;\r\n  for (let i = 0; i < round; i++) {\r\n    key = CryptoJS.MD5(key);\r\n    key.sigBytes = keyBits / 8;\r\n  }\r\n  return key;\r\n}\r\n\r\nfunction getUserPasswordR5(processedUserPassword, generateRandomWordArray) {\r\n  const validationSalt = generateRandomWordArray(8);\r\n  const keySalt = generateRandomWordArray(8);\r\n  return CryptoJS.SHA256(processedUserPassword.clone().concat(validationSalt))\r\n    .concat(validationSalt)\r\n    .concat(keySalt);\r\n}\r\n\r\nfunction getUserEncryptionKeyR5(\r\n  processedUserPassword,\r\n  userKeySalt,\r\n  encryptionKey\r\n) {\r\n  const key = CryptoJS.SHA256(\r\n    processedUserPassword.clone().concat(userKeySalt)\r\n  );\r\n  const options = {\r\n    mode: CryptoJS.mode.CBC,\r\n    padding: CryptoJS.pad.NoPadding,\r\n    iv: CryptoJS.lib.WordArray.create(null, 16)\r\n  };\r\n  return CryptoJS.AES.encrypt(encryptionKey, key, options).ciphertext;\r\n}\r\n\r\nfunction getOwnerPasswordR5(\r\n  processedOwnerPassword,\r\n  userPasswordEntry,\r\n  generateRandomWordArray\r\n) {\r\n  const validationSalt = generateRandomWordArray(8);\r\n  const keySalt = generateRandomWordArray(8);\r\n  return CryptoJS.SHA256(\r\n    processedOwnerPassword\r\n      .clone()\r\n      .concat(validationSalt)\r\n      .concat(userPasswordEntry)\r\n  )\r\n    .concat(validationSalt)\r\n    .concat(keySalt);\r\n}\r\n\r\nfunction getOwnerEncryptionKeyR5(\r\n  processedOwnerPassword,\r\n  ownerKeySalt,\r\n  userPasswordEntry,\r\n  encryptionKey\r\n) {\r\n  const key = CryptoJS.SHA256(\r\n    processedOwnerPassword\r\n      .clone()\r\n      .concat(ownerKeySalt)\r\n      .concat(userPasswordEntry)\r\n  );\r\n  const options = {\r\n    mode: CryptoJS.mode.CBC,\r\n    padding: CryptoJS.pad.NoPadding,\r\n    iv: CryptoJS.lib.WordArray.create(null, 16)\r\n  };\r\n  return CryptoJS.AES.encrypt(encryptionKey, key, options).ciphertext;\r\n}\r\n\r\nfunction getEncryptionKeyR5(generateRandomWordArray) {\r\n  return generateRandomWordArray(32);\r\n}\r\n\r\nfunction getEncryptedPermissionsR5(\r\n  permissions,\r\n  encryptionKey,\r\n  generateRandomWordArray\r\n) {\r\n  const cipher = CryptoJS.lib.WordArray.create(\r\n    [lsbFirstWord(permissions), 0xffffffff, 0x54616462],\r\n    12\r\n  ).concat(generateRandomWordArray(4));\r\n  const options = {\r\n    mode: CryptoJS.mode.ECB,\r\n    padding: CryptoJS.pad.NoPadding\r\n  };\r\n  return CryptoJS.AES.encrypt(cipher, encryptionKey, options).ciphertext;\r\n}\r\n\r\nfunction processPasswordR2R3R4(password = '') {\r\n  const out = Buffer.alloc(32);\r\n  const length = password.length;\r\n  let index = 0;\r\n  while (index < length && index < 32) {\r\n    const code = password.charCodeAt(index);\r\n    if (code > 0xff) {\r\n      throw new Error('Password contains one or more invalid characters.');\r\n    }\r\n    out[index] = code;\r\n    index++;\r\n  }\r\n  while (index < 32) {\r\n    out[index] = PASSWORD_PADDING[index - length];\r\n    index++;\r\n  }\r\n  return CryptoJS.lib.WordArray.create(out);\r\n}\r\n\r\nfunction processPasswordR5(password = '') {\r\n  password = unescape(encodeURIComponent(saslprep(password)));\r\n  const length = Math.min(127, password.length);\r\n  const out = Buffer.alloc(length);\r\n\r\n  for (let i = 0; i < length; i++) {\r\n    out[i] = password.charCodeAt(i);\r\n  }\r\n\r\n  return CryptoJS.lib.WordArray.create(out);\r\n}\r\n\r\nfunction lsbFirstWord(data) {\r\n  return (\r\n    ((data & 0xff) << 24) |\r\n    ((data & 0xff00) << 8) |\r\n    ((data >> 8) & 0xff00) |\r\n    ((data >> 24) & 0xff)\r\n  );\r\n}\r\n\r\nfunction wordArrayToBuffer(wordArray) {\r\n  const byteArray = [];\r\n  for (let i = 0; i < wordArray.sigBytes; i++) {\r\n    byteArray.push(\r\n      (wordArray.words[Math.floor(i / 4)] >> (8 * (3 - (i % 4)))) & 0xff\r\n    );\r\n  }\r\n  return Buffer.from(byteArray);\r\n}\r\n\r\nconst PASSWORD_PADDING = [\r\n  0x28,\r\n  0xbf,\r\n  0x4e,\r\n  0x5e,\r\n  0x4e,\r\n  0x75,\r\n  0x8a,\r\n  0x41,\r\n  0x64,\r\n  0x00,\r\n  0x4e,\r\n  0x56,\r\n  0xff,\r\n  0xfa,\r\n  0x01,\r\n  0x08,\r\n  0x2e,\r\n  0x2e,\r\n  0x00,\r\n  0xb6,\r\n  0xd0,\r\n  0x68,\r\n  0x3e,\r\n  0x80,\r\n  0x2f,\r\n  0x0c,\r\n  0xa9,\r\n  0xfe,\r\n  0x64,\r\n  0x53,\r\n  0x69,\r\n  0x7a\r\n];\r\n\r\nexport default PDFSecurity;\r\n","import PDFObject from './object';\r\n\r\nconst { number } = PDFObject;\r\n\r\nclass PDFGradient {\r\n  constructor(doc) {\r\n    this.doc = doc;\r\n    this.stops = [];\r\n    this.embedded = false;\r\n    this.transform = [1, 0, 0, 1, 0, 0];\r\n  }\r\n\r\n  stop(pos, color, opacity) {\r\n    if (opacity == null) {\r\n      opacity = 1;\r\n    }\r\n    color = this.doc._normalizeColor(color);\r\n\r\n    if (this.stops.length === 0) {\r\n      if (color.length === 3) {\r\n        this._colorSpace = 'DeviceRGB';\r\n      } else if (color.length === 4) {\r\n        this._colorSpace = 'DeviceCMYK';\r\n      } else if (color.length === 1) {\r\n        this._colorSpace = 'DeviceGray';\r\n      } else {\r\n        throw new Error('Unknown color space');\r\n      }\r\n    } else if (\r\n      (this._colorSpace === 'DeviceRGB' && color.length !== 3) ||\r\n      (this._colorSpace === 'DeviceCMYK' && color.length !== 4) ||\r\n      (this._colorSpace === 'DeviceGray' && color.length !== 1)\r\n    ) {\r\n      throw new Error('All gradient stops must use the same color space');\r\n    }\r\n\r\n    opacity = Math.max(0, Math.min(1, opacity));\r\n    this.stops.push([pos, color, opacity]);\r\n    return this;\r\n  }\r\n\r\n  setTransform(m11, m12, m21, m22, dx, dy) {\r\n    this.transform = [m11, m12, m21, m22, dx, dy];\r\n    return this;\r\n  }\r\n\r\n  embed(m) {\r\n    let fn;\r\n    const stopsLength = this.stops.length;\r\n    if (stopsLength === 0) {\r\n      return;\r\n    }\r\n    this.embedded = true;\r\n    this.matrix = m;\r\n\r\n    // if the last stop comes before 100%, add a copy at 100%\r\n    const last = this.stops[stopsLength - 1];\r\n    if (last[0] < 1) {\r\n      this.stops.push([1, last[1], last[2]]);\r\n    }\r\n\r\n    const bounds = [];\r\n    const encode = [];\r\n    const stops = [];\r\n\r\n    for (let i = 0; i < stopsLength - 1; i++) {\r\n      encode.push(0, 1);\r\n      if (i + 2 !== stopsLength) {\r\n        bounds.push(this.stops[i + 1][0]);\r\n      }\r\n\r\n      fn = this.doc.ref({\r\n        FunctionType: 2,\r\n        Domain: [0, 1],\r\n        C0: this.stops[i + 0][1],\r\n        C1: this.stops[i + 1][1],\r\n        N: 1\r\n      });\r\n\r\n      stops.push(fn);\r\n      fn.end();\r\n    }\r\n\r\n    // if there are only two stops, we don't need a stitching function\r\n    if (stopsLength === 1) {\r\n      fn = stops[0];\r\n    } else {\r\n      fn = this.doc.ref({\r\n        FunctionType: 3, // stitching function\r\n        Domain: [0, 1],\r\n        Functions: stops,\r\n        Bounds: bounds,\r\n        Encode: encode\r\n      });\r\n\r\n      fn.end();\r\n    }\r\n\r\n    this.id = `Sh${++this.doc._gradCount}`;\r\n\r\n    const shader = this.shader(fn);\r\n    shader.end();\r\n\r\n    const pattern = this.doc.ref({\r\n      Type: 'Pattern',\r\n      PatternType: 2,\r\n      Shading: shader,\r\n      Matrix: this.matrix.map(number)\r\n    });\r\n\r\n    pattern.end();\r\n\r\n    if (this.stops.some(stop => stop[2] < 1)) {\r\n      let grad = this.opacityGradient();\r\n      grad._colorSpace = 'DeviceGray';\r\n\r\n      for (let stop of this.stops) {\r\n        grad.stop(stop[0], [stop[2]]);\r\n      }\r\n\r\n      grad = grad.embed(this.matrix);\r\n\r\n      const pageBBox = [0, 0, this.doc.page.width, this.doc.page.height];\r\n\r\n      const form = this.doc.ref({\r\n        Type: 'XObject',\r\n        Subtype: 'Form',\r\n        FormType: 1,\r\n        BBox: pageBBox,\r\n        Group: {\r\n          Type: 'Group',\r\n          S: 'Transparency',\r\n          CS: 'DeviceGray'\r\n        },\r\n        Resources: {\r\n          ProcSet: ['PDF', 'Text', 'ImageB', 'ImageC', 'ImageI'],\r\n          Pattern: {\r\n            Sh1: grad\r\n          }\r\n        }\r\n      });\r\n\r\n      form.write('/Pattern cs /Sh1 scn');\r\n      form.end(`${pageBBox.join(' ')} re f`);\r\n\r\n      const gstate = this.doc.ref({\r\n        Type: 'ExtGState',\r\n        SMask: {\r\n          Type: 'Mask',\r\n          S: 'Luminosity',\r\n          G: form\r\n        }\r\n      });\r\n\r\n      gstate.end();\r\n\r\n      const opacityPattern = this.doc.ref({\r\n        Type: 'Pattern',\r\n        PatternType: 1,\r\n        PaintType: 1,\r\n        TilingType: 2,\r\n        BBox: pageBBox,\r\n        XStep: pageBBox[2],\r\n        YStep: pageBBox[3],\r\n        Resources: {\r\n          ProcSet: ['PDF', 'Text', 'ImageB', 'ImageC', 'ImageI'],\r\n          Pattern: {\r\n            Sh1: pattern\r\n          },\r\n          ExtGState: {\r\n            Gs1: gstate\r\n          }\r\n        }\r\n      });\r\n\r\n      opacityPattern.write('/Gs1 gs /Pattern cs /Sh1 scn');\r\n      opacityPattern.end(`${pageBBox.join(' ')} re f`);\r\n\r\n      this.doc.page.patterns[this.id] = opacityPattern;\r\n    } else {\r\n      this.doc.page.patterns[this.id] = pattern;\r\n    }\r\n\r\n    return pattern;\r\n  }\r\n\r\n  apply(stroke) {\r\n    // apply gradient transform to existing document ctm\r\n    const [m0, m1, m2, m3, m4, m5] = this.doc._ctm;\r\n    const [m11, m12, m21, m22, dx, dy] = this.transform;\r\n    const m = [\r\n      m0 * m11 + m2 * m12,\r\n      m1 * m11 + m3 * m12,\r\n      m0 * m21 + m2 * m22,\r\n      m1 * m21 + m3 * m22,\r\n      m0 * dx + m2 * dy + m4,\r\n      m1 * dx + m3 * dy + m5\r\n    ];\r\n\r\n    if (!this.embedded || m.join(' ') !== this.matrix.join(' ')) {\r\n      this.embed(m);\r\n    }\r\n    this.doc._setColorSpace('Pattern', stroke);\r\n    const op = stroke ? 'SCN' : 'scn';\r\n    return this.doc.addContent(`/${this.id} ${op}`);\r\n  }\r\n}\r\n\r\nclass PDFLinearGradient extends PDFGradient {\r\n  constructor(doc, x1, y1, x2, y2) {\r\n    super(doc);\r\n    this.x1 = x1;\r\n    this.y1 = y1;\r\n    this.x2 = x2;\r\n    this.y2 = y2;\r\n  }\r\n\r\n  shader(fn) {\r\n    return this.doc.ref({\r\n      ShadingType: 2,\r\n      ColorSpace: this._colorSpace,\r\n      Coords: [this.x1, this.y1, this.x2, this.y2],\r\n      Function: fn,\r\n      Extend: [true, true]\r\n    });\r\n  }\r\n\r\n  opacityGradient() {\r\n    return new PDFLinearGradient(this.doc, this.x1, this.y1, this.x2, this.y2);\r\n  }\r\n}\r\n\r\nclass PDFRadialGradient extends PDFGradient {\r\n  constructor(doc, x1, y1, r1, x2, y2, r2) {\r\n    super(doc);\r\n    this.doc = doc;\r\n    this.x1 = x1;\r\n    this.y1 = y1;\r\n    this.r1 = r1;\r\n    this.x2 = x2;\r\n    this.y2 = y2;\r\n    this.r2 = r2;\r\n  }\r\n\r\n  shader(fn) {\r\n    return this.doc.ref({\r\n      ShadingType: 3,\r\n      ColorSpace: this._colorSpace,\r\n      Coords: [this.x1, this.y1, this.r1, this.x2, this.y2, this.r2],\r\n      Function: fn,\r\n      Extend: [true, true]\r\n    });\r\n  }\r\n\r\n  opacityGradient() {\r\n    return new PDFRadialGradient(\r\n      this.doc,\r\n      this.x1,\r\n      this.y1,\r\n      this.r1,\r\n      this.x2,\r\n      this.y2,\r\n      this.r2\r\n    );\r\n  }\r\n}\r\n\r\nexport default { PDFGradient, PDFLinearGradient, PDFRadialGradient };\r\n","/*\r\nPDF tiling pattern support. Uncolored only.\r\n */\r\n\r\nconst underlyingColorSpaces = ['DeviceCMYK', 'DeviceRGB'];\r\n\r\nclass PDFTilingPattern {\r\n  constructor(doc, bBox, xStep, yStep, stream) {\r\n    this.doc = doc;\r\n    this.bBox = bBox;\r\n    this.xStep = xStep;\r\n    this.yStep = yStep;\r\n    this.stream = stream;\r\n  }\r\n\r\n  createPattern() {\r\n    // no resources needed for our current usage\r\n    // required entry\r\n    const resources = this.doc.ref();\r\n    resources.end();\r\n    // apply default transform matrix (flipped in the default doc._ctm)\r\n    // see document.js & gradient.js\r\n    const [m0, m1, m2, m3, m4, m5] = this.doc._ctm;\r\n    const [m11, m12, m21, m22, dx, dy] = [1, 0, 0, 1, 0, 0];\r\n    const m = [\r\n      m0 * m11 + m2 * m12,\r\n      m1 * m11 + m3 * m12,\r\n      m0 * m21 + m2 * m22,\r\n      m1 * m21 + m3 * m22,\r\n      m0 * dx + m2 * dy + m4,\r\n      m1 * dx + m3 * dy + m5\r\n    ];\r\n    const pattern = this.doc.ref({\r\n      Type: 'Pattern',\r\n      PatternType: 1, // tiling\r\n      PaintType: 2, // 1-colored, 2-uncolored\r\n      TilingType: 2, // 2-no distortion\r\n      BBox: this.bBox,\r\n      XStep: this.xStep,\r\n      YStep: this.yStep,\r\n      Matrix: m.map(v => +v.toFixed(5)),\r\n      Resources: resources\r\n    });\r\n    pattern.end(this.stream);\r\n    return pattern;\r\n  }\r\n\r\n  embedPatternColorSpaces() {\r\n    // map each pattern to an underlying color space\r\n    // and embed on each page\r\n    underlyingColorSpaces.forEach(csName => {\r\n      const csId = this.getPatternColorSpaceId(csName);\r\n\r\n      if (this.doc.page.colorSpaces[csId]) return;\r\n      const cs = this.doc.ref(['Pattern', csName]);\r\n      cs.end();\r\n      this.doc.page.colorSpaces[csId] = cs;\r\n    });\r\n  }\r\n\r\n  getPatternColorSpaceId(underlyingColorspace) {\r\n    return `CsP${underlyingColorspace}`;\r\n  }\r\n\r\n  embed() {\r\n    if (!this.id) {\r\n      this.doc._patternCount = this.doc._patternCount + 1;\r\n      this.id = 'P' + this.doc._patternCount;\r\n      this.pattern = this.createPattern();\r\n    }\r\n\r\n    // patterns are embedded in each page\r\n    if (!this.doc.page.patterns[this.id]) {\r\n      this.doc.page.patterns[this.id] = this.pattern;\r\n    }\r\n  }\r\n\r\n  apply(stroke, patternColor) {\r\n    // do any embedding/creating that might be needed\r\n    this.embedPatternColorSpaces();\r\n    this.embed();\r\n\r\n    const normalizedColor = this.doc._normalizeColor(patternColor);\r\n    if (!normalizedColor)\r\n      throw Error(`invalid pattern color. (value: ${patternColor})`);\r\n\r\n    // select one of the pattern color spaces\r\n    const csId = this.getPatternColorSpaceId(\r\n      this.doc._getColorSpace(normalizedColor)\r\n    );\r\n    this.doc._setColorSpace(csId, stroke);\r\n\r\n    // stroke/fill using the pattern and color (in the above underlying color space)\r\n    const op = stroke ? 'SCN' : 'scn';\r\n    return this.doc.addContent(\r\n      `${normalizedColor.join(' ')} /${this.id} ${op}`\r\n    );\r\n  }\r\n}\r\n\r\nexport default { PDFTilingPattern };\r\n","import Gradient from '../gradient';\r\nimport pattern from '../pattern';\r\n\r\nconst { PDFGradient, PDFLinearGradient, PDFRadialGradient } = Gradient;\r\nconst { PDFTilingPattern } = pattern;\r\n\r\nexport default {\r\n  initColor() {\r\n    // The opacity dictionaries\r\n    this._opacityRegistry = {};\r\n    this._opacityCount = 0;\r\n    this._patternCount = 0;\r\n    return (this._gradCount = 0);\r\n  },\r\n\r\n  _normalizeColor(color) {\r\n    if (typeof color === 'string') {\r\n      if (color.charAt(0) === '#') {\r\n        if (color.length === 4) {\r\n          color = color.replace(\r\n            /#([0-9A-F])([0-9A-F])([0-9A-F])/i,\r\n            '#$1$1$2$2$3$3'\r\n          );\r\n        }\r\n        const hex = parseInt(color.slice(1), 16);\r\n        color = [hex >> 16, (hex >> 8) & 0xff, hex & 0xff];\r\n      } else if (namedColors[color]) {\r\n        color = namedColors[color];\r\n      }\r\n    }\r\n\r\n    if (Array.isArray(color)) {\r\n      // RGB\r\n      if (color.length === 3) {\r\n        color = color.map(part => part / 255);\r\n        // CMYK\r\n      } else if (color.length === 4) {\r\n        color = color.map(part => part / 100);\r\n      }\r\n      return color;\r\n    }\r\n\r\n    return null;\r\n  },\r\n\r\n  _setColor(color, stroke) {\r\n    if (color instanceof PDFGradient) {\r\n      color.apply(stroke);\r\n      return true;\r\n      // see if tiling pattern, decode & apply it it\r\n    } else if (Array.isArray(color) && color[0] instanceof PDFTilingPattern) {\r\n      color[0].apply(stroke, color[1]);\r\n      return true;\r\n    }\r\n    // any other case should be a normal color and not a pattern\r\n    return this._setColorCore(color, stroke);\r\n  },\r\n\r\n  _setColorCore(color, stroke) {\r\n    color = this._normalizeColor(color);\r\n    if (!color) {\r\n      return false;\r\n    }\r\n\r\n    const op = stroke ? 'SCN' : 'scn';\r\n    const space = this._getColorSpace(color);\r\n    this._setColorSpace(space, stroke);\r\n\r\n    color = color.join(' ');\r\n    this.addContent(`${color} ${op}`);\r\n\r\n    return true;\r\n  },\r\n\r\n  _setColorSpace(space, stroke) {\r\n    const op = stroke ? 'CS' : 'cs';\r\n    return this.addContent(`/${space} ${op}`);\r\n  },\r\n\r\n  _getColorSpace(color) {\r\n    return color.length === 4 ? 'DeviceCMYK' : 'DeviceRGB';\r\n  },\r\n\r\n  fillColor(color, opacity) {\r\n    const set = this._setColor(color, false);\r\n    if (set) {\r\n      this.fillOpacity(opacity);\r\n    }\r\n\r\n    // save this for text wrapper, which needs to reset\r\n    // the fill color on new pages\r\n    this._fillColor = [color, opacity];\r\n    return this;\r\n  },\r\n\r\n  strokeColor(color, opacity) {\r\n    const set = this._setColor(color, true);\r\n    if (set) {\r\n      this.strokeOpacity(opacity);\r\n    }\r\n    return this;\r\n  },\r\n\r\n  opacity(opacity) {\r\n    this._doOpacity(opacity, opacity);\r\n    return this;\r\n  },\r\n\r\n  fillOpacity(opacity) {\r\n    this._doOpacity(opacity, null);\r\n    return this;\r\n  },\r\n\r\n  strokeOpacity(opacity) {\r\n    this._doOpacity(null, opacity);\r\n    return this;\r\n  },\r\n\r\n  _doOpacity(fillOpacity, strokeOpacity) {\r\n    let dictionary, name;\r\n    if (fillOpacity == null && strokeOpacity == null) {\r\n      return;\r\n    }\r\n\r\n    if (fillOpacity != null) {\r\n      fillOpacity = Math.max(0, Math.min(1, fillOpacity));\r\n    }\r\n    if (strokeOpacity != null) {\r\n      strokeOpacity = Math.max(0, Math.min(1, strokeOpacity));\r\n    }\r\n    const key = `${fillOpacity}_${strokeOpacity}`;\r\n\r\n    if (this._opacityRegistry[key]) {\r\n      [dictionary, name] = this._opacityRegistry[key];\r\n    } else {\r\n      dictionary = { Type: 'ExtGState' };\r\n\r\n      if (fillOpacity != null) {\r\n        dictionary.ca = fillOpacity;\r\n      }\r\n      if (strokeOpacity != null) {\r\n        dictionary.CA = strokeOpacity;\r\n      }\r\n\r\n      dictionary = this.ref(dictionary);\r\n      dictionary.end();\r\n      const id = ++this._opacityCount;\r\n      name = `Gs${id}`;\r\n      this._opacityRegistry[key] = [dictionary, name];\r\n    }\r\n\r\n    this.page.ext_gstates[name] = dictionary;\r\n    return this.addContent(`/${name} gs`);\r\n  },\r\n\r\n  linearGradient(x1, y1, x2, y2) {\r\n    return new PDFLinearGradient(this, x1, y1, x2, y2);\r\n  },\r\n\r\n  radialGradient(x1, y1, r1, x2, y2, r2) {\r\n    return new PDFRadialGradient(this, x1, y1, r1, x2, y2, r2);\r\n  },\r\n\r\n  pattern(bbox, xStep, yStep, stream) {\r\n    return new PDFTilingPattern(this, bbox, xStep, yStep, stream);\r\n  }\r\n};\r\n\r\nvar namedColors = {\r\n  aliceblue: [240, 248, 255],\r\n  antiquewhite: [250, 235, 215],\r\n  aqua: [0, 255, 255],\r\n  aquamarine: [127, 255, 212],\r\n  azure: [240, 255, 255],\r\n  beige: [245, 245, 220],\r\n  bisque: [255, 228, 196],\r\n  black: [0, 0, 0],\r\n  blanchedalmond: [255, 235, 205],\r\n  blue: [0, 0, 255],\r\n  blueviolet: [138, 43, 226],\r\n  brown: [165, 42, 42],\r\n  burlywood: [222, 184, 135],\r\n  cadetblue: [95, 158, 160],\r\n  chartreuse: [127, 255, 0],\r\n  chocolate: [210, 105, 30],\r\n  coral: [255, 127, 80],\r\n  cornflowerblue: [100, 149, 237],\r\n  cornsilk: [255, 248, 220],\r\n  crimson: [220, 20, 60],\r\n  cyan: [0, 255, 255],\r\n  darkblue: [0, 0, 139],\r\n  darkcyan: [0, 139, 139],\r\n  darkgoldenrod: [184, 134, 11],\r\n  darkgray: [169, 169, 169],\r\n  darkgreen: [0, 100, 0],\r\n  darkgrey: [169, 169, 169],\r\n  darkkhaki: [189, 183, 107],\r\n  darkmagenta: [139, 0, 139],\r\n  darkolivegreen: [85, 107, 47],\r\n  darkorange: [255, 140, 0],\r\n  darkorchid: [153, 50, 204],\r\n  darkred: [139, 0, 0],\r\n  darksalmon: [233, 150, 122],\r\n  darkseagreen: [143, 188, 143],\r\n  darkslateblue: [72, 61, 139],\r\n  darkslategray: [47, 79, 79],\r\n  darkslategrey: [47, 79, 79],\r\n  darkturquoise: [0, 206, 209],\r\n  darkviolet: [148, 0, 211],\r\n  deeppink: [255, 20, 147],\r\n  deepskyblue: [0, 191, 255],\r\n  dimgray: [105, 105, 105],\r\n  dimgrey: [105, 105, 105],\r\n  dodgerblue: [30, 144, 255],\r\n  firebrick: [178, 34, 34],\r\n  floralwhite: [255, 250, 240],\r\n  forestgreen: [34, 139, 34],\r\n  fuchsia: [255, 0, 255],\r\n  gainsboro: [220, 220, 220],\r\n  ghostwhite: [248, 248, 255],\r\n  gold: [255, 215, 0],\r\n  goldenrod: [218, 165, 32],\r\n  gray: [128, 128, 128],\r\n  grey: [128, 128, 128],\r\n  green: [0, 128, 0],\r\n  greenyellow: [173, 255, 47],\r\n  honeydew: [240, 255, 240],\r\n  hotpink: [255, 105, 180],\r\n  indianred: [205, 92, 92],\r\n  indigo: [75, 0, 130],\r\n  ivory: [255, 255, 240],\r\n  khaki: [240, 230, 140],\r\n  lavender: [230, 230, 250],\r\n  lavenderblush: [255, 240, 245],\r\n  lawngreen: [124, 252, 0],\r\n  lemonchiffon: [255, 250, 205],\r\n  lightblue: [173, 216, 230],\r\n  lightcoral: [240, 128, 128],\r\n  lightcyan: [224, 255, 255],\r\n  lightgoldenrodyellow: [250, 250, 210],\r\n  lightgray: [211, 211, 211],\r\n  lightgreen: [144, 238, 144],\r\n  lightgrey: [211, 211, 211],\r\n  lightpink: [255, 182, 193],\r\n  lightsalmon: [255, 160, 122],\r\n  lightseagreen: [32, 178, 170],\r\n  lightskyblue: [135, 206, 250],\r\n  lightslategray: [119, 136, 153],\r\n  lightslategrey: [119, 136, 153],\r\n  lightsteelblue: [176, 196, 222],\r\n  lightyellow: [255, 255, 224],\r\n  lime: [0, 255, 0],\r\n  limegreen: [50, 205, 50],\r\n  linen: [250, 240, 230],\r\n  magenta: [255, 0, 255],\r\n  maroon: [128, 0, 0],\r\n  mediumaquamarine: [102, 205, 170],\r\n  mediumblue: [0, 0, 205],\r\n  mediumorchid: [186, 85, 211],\r\n  mediumpurple: [147, 112, 219],\r\n  mediumseagreen: [60, 179, 113],\r\n  mediumslateblue: [123, 104, 238],\r\n  mediumspringgreen: [0, 250, 154],\r\n  mediumturquoise: [72, 209, 204],\r\n  mediumvioletred: [199, 21, 133],\r\n  midnightblue: [25, 25, 112],\r\n  mintcream: [245, 255, 250],\r\n  mistyrose: [255, 228, 225],\r\n  moccasin: [255, 228, 181],\r\n  navajowhite: [255, 222, 173],\r\n  navy: [0, 0, 128],\r\n  oldlace: [253, 245, 230],\r\n  olive: [128, 128, 0],\r\n  olivedrab: [107, 142, 35],\r\n  orange: [255, 165, 0],\r\n  orangered: [255, 69, 0],\r\n  orchid: [218, 112, 214],\r\n  palegoldenrod: [238, 232, 170],\r\n  palegreen: [152, 251, 152],\r\n  paleturquoise: [175, 238, 238],\r\n  palevioletred: [219, 112, 147],\r\n  papayawhip: [255, 239, 213],\r\n  peachpuff: [255, 218, 185],\r\n  peru: [205, 133, 63],\r\n  pink: [255, 192, 203],\r\n  plum: [221, 160, 221],\r\n  powderblue: [176, 224, 230],\r\n  purple: [128, 0, 128],\r\n  red: [255, 0, 0],\r\n  rosybrown: [188, 143, 143],\r\n  royalblue: [65, 105, 225],\r\n  saddlebrown: [139, 69, 19],\r\n  salmon: [250, 128, 114],\r\n  sandybrown: [244, 164, 96],\r\n  seagreen: [46, 139, 87],\r\n  seashell: [255, 245, 238],\r\n  sienna: [160, 82, 45],\r\n  silver: [192, 192, 192],\r\n  skyblue: [135, 206, 235],\r\n  slateblue: [106, 90, 205],\r\n  slategray: [112, 128, 144],\r\n  slategrey: [112, 128, 144],\r\n  snow: [255, 250, 250],\r\n  springgreen: [0, 255, 127],\r\n  steelblue: [70, 130, 180],\r\n  tan: [210, 180, 140],\r\n  teal: [0, 128, 128],\r\n  thistle: [216, 191, 216],\r\n  tomato: [255, 99, 71],\r\n  turquoise: [64, 224, 208],\r\n  violet: [238, 130, 238],\r\n  wheat: [245, 222, 179],\r\n  white: [255, 255, 255],\r\n  whitesmoke: [245, 245, 245],\r\n  yellow: [255, 255, 0],\r\n  yellowgreen: [154, 205, 50]\r\n};\r\n","let cx, cy, px, py, sx, sy;\r\n\r\ncx = cy = px = py = sx = sy = 0;\r\n\r\nconst parameters = {\r\n  A: 7,\r\n  a: 7,\r\n  C: 6,\r\n  c: 6,\r\n  H: 1,\r\n  h: 1,\r\n  L: 2,\r\n  l: 2,\r\n  M: 2,\r\n  m: 2,\r\n  Q: 4,\r\n  q: 4,\r\n  S: 4,\r\n  s: 4,\r\n  T: 2,\r\n  t: 2,\r\n  V: 1,\r\n  v: 1,\r\n  Z: 0,\r\n  z: 0\r\n};\r\n\r\nconst parse = function(path) {\r\n  let cmd;\r\n  const ret = [];\r\n  let args = [];\r\n  let curArg = '';\r\n  let foundDecimal = false;\r\n  let params = 0;\r\n\r\n  for (let c of path) {\r\n    if (parameters[c] != null) {\r\n      params = parameters[c];\r\n      if (cmd) {\r\n        // save existing command\r\n        if (curArg.length > 0) {\r\n          args[args.length] = +curArg;\r\n        }\r\n        ret[ret.length] = { cmd, args };\r\n\r\n        args = [];\r\n        curArg = '';\r\n        foundDecimal = false;\r\n      }\r\n\r\n      cmd = c;\r\n    } else if (\r\n      [' ', ','].includes(c) ||\r\n      (c === '-' && curArg.length > 0 && curArg[curArg.length - 1] !== 'e') ||\r\n      (c === '.' && foundDecimal)\r\n    ) {\r\n      if (curArg.length === 0) {\r\n        continue;\r\n      }\r\n\r\n      if (args.length === params) {\r\n        // handle reused commands\r\n        ret[ret.length] = { cmd, args };\r\n        args = [+curArg];\r\n\r\n        // handle assumed commands\r\n        if (cmd === 'M') {\r\n          cmd = 'L';\r\n        }\r\n        if (cmd === 'm') {\r\n          cmd = 'l';\r\n        }\r\n      } else {\r\n        args[args.length] = +curArg;\r\n      }\r\n\r\n      foundDecimal = c === '.';\r\n\r\n      // fix for negative numbers or repeated decimals with no delimeter between commands\r\n      curArg = ['-', '.'].includes(c) ? c : '';\r\n    } else {\r\n      curArg += c;\r\n      if (c === '.') {\r\n        foundDecimal = true;\r\n      }\r\n    }\r\n  }\r\n\r\n  // add the last command\r\n  if (curArg.length > 0) {\r\n    if (args.length === params) {\r\n      // handle reused commands\r\n      ret[ret.length] = { cmd, args };\r\n      args = [+curArg];\r\n\r\n      // handle assumed commands\r\n      if (cmd === 'M') {\r\n        cmd = 'L';\r\n      }\r\n      if (cmd === 'm') {\r\n        cmd = 'l';\r\n      }\r\n    } else {\r\n      args[args.length] = +curArg;\r\n    }\r\n  }\r\n\r\n  ret[ret.length] = { cmd, args };\r\n\r\n  return ret;\r\n};\r\n\r\nconst apply = function(commands, doc) {\r\n  // current point, control point, and subpath starting point\r\n  cx = cy = px = py = sx = sy = 0;\r\n\r\n  // run the commands\r\n  for (let i = 0; i < commands.length; i++) {\r\n    const c = commands[i];\r\n    if (typeof runners[c.cmd] === 'function') {\r\n      runners[c.cmd](doc, c.args);\r\n    }\r\n  }\r\n};\r\n\r\nconst runners = {\r\n  M(doc, a) {\r\n    cx = a[0];\r\n    cy = a[1];\r\n    px = py = null;\r\n    sx = cx;\r\n    sy = cy;\r\n    return doc.moveTo(cx, cy);\r\n  },\r\n\r\n  m(doc, a) {\r\n    cx += a[0];\r\n    cy += a[1];\r\n    px = py = null;\r\n    sx = cx;\r\n    sy = cy;\r\n    return doc.moveTo(cx, cy);\r\n  },\r\n\r\n  C(doc, a) {\r\n    cx = a[4];\r\n    cy = a[5];\r\n    px = a[2];\r\n    py = a[3];\r\n    return doc.bezierCurveTo(...a);\r\n  },\r\n\r\n  c(doc, a) {\r\n    doc.bezierCurveTo(\r\n      a[0] + cx,\r\n      a[1] + cy,\r\n      a[2] + cx,\r\n      a[3] + cy,\r\n      a[4] + cx,\r\n      a[5] + cy\r\n    );\r\n    px = cx + a[2];\r\n    py = cy + a[3];\r\n    cx += a[4];\r\n    return (cy += a[5]);\r\n  },\r\n\r\n  S(doc, a) {\r\n    if (px === null) {\r\n      px = cx;\r\n      py = cy;\r\n    }\r\n\r\n    doc.bezierCurveTo(cx - (px - cx), cy - (py - cy), a[0], a[1], a[2], a[3]);\r\n    px = a[0];\r\n    py = a[1];\r\n    cx = a[2];\r\n    return (cy = a[3]);\r\n  },\r\n\r\n  s(doc, a) {\r\n    if (px === null) {\r\n      px = cx;\r\n      py = cy;\r\n    }\r\n\r\n    doc.bezierCurveTo(\r\n      cx - (px - cx),\r\n      cy - (py - cy),\r\n      cx + a[0],\r\n      cy + a[1],\r\n      cx + a[2],\r\n      cy + a[3]\r\n    );\r\n    px = cx + a[0];\r\n    py = cy + a[1];\r\n    cx += a[2];\r\n    return (cy += a[3]);\r\n  },\r\n\r\n  Q(doc, a) {\r\n    px = a[0];\r\n    py = a[1];\r\n    cx = a[2];\r\n    cy = a[3];\r\n    return doc.quadraticCurveTo(a[0], a[1], cx, cy);\r\n  },\r\n\r\n  q(doc, a) {\r\n    doc.quadraticCurveTo(a[0] + cx, a[1] + cy, a[2] + cx, a[3] + cy);\r\n    px = cx + a[0];\r\n    py = cy + a[1];\r\n    cx += a[2];\r\n    return (cy += a[3]);\r\n  },\r\n\r\n  T(doc, a) {\r\n    if (px === null) {\r\n      px = cx;\r\n      py = cy;\r\n    } else {\r\n      px = cx - (px - cx);\r\n      py = cy - (py - cy);\r\n    }\r\n\r\n    doc.quadraticCurveTo(px, py, a[0], a[1]);\r\n    px = cx - (px - cx);\r\n    py = cy - (py - cy);\r\n    cx = a[0];\r\n    return (cy = a[1]);\r\n  },\r\n\r\n  t(doc, a) {\r\n    if (px === null) {\r\n      px = cx;\r\n      py = cy;\r\n    } else {\r\n      px = cx - (px - cx);\r\n      py = cy - (py - cy);\r\n    }\r\n\r\n    doc.quadraticCurveTo(px, py, cx + a[0], cy + a[1]);\r\n    cx += a[0];\r\n    return (cy += a[1]);\r\n  },\r\n\r\n  A(doc, a) {\r\n    solveArc(doc, cx, cy, a);\r\n    cx = a[5];\r\n    return (cy = a[6]);\r\n  },\r\n\r\n  a(doc, a) {\r\n    a[5] += cx;\r\n    a[6] += cy;\r\n    solveArc(doc, cx, cy, a);\r\n    cx = a[5];\r\n    return (cy = a[6]);\r\n  },\r\n\r\n  L(doc, a) {\r\n    cx = a[0];\r\n    cy = a[1];\r\n    px = py = null;\r\n    return doc.lineTo(cx, cy);\r\n  },\r\n\r\n  l(doc, a) {\r\n    cx += a[0];\r\n    cy += a[1];\r\n    px = py = null;\r\n    return doc.lineTo(cx, cy);\r\n  },\r\n\r\n  H(doc, a) {\r\n    cx = a[0];\r\n    px = py = null;\r\n    return doc.lineTo(cx, cy);\r\n  },\r\n\r\n  h(doc, a) {\r\n    cx += a[0];\r\n    px = py = null;\r\n    return doc.lineTo(cx, cy);\r\n  },\r\n\r\n  V(doc, a) {\r\n    cy = a[0];\r\n    px = py = null;\r\n    return doc.lineTo(cx, cy);\r\n  },\r\n\r\n  v(doc, a) {\r\n    cy += a[0];\r\n    px = py = null;\r\n    return doc.lineTo(cx, cy);\r\n  },\r\n\r\n  Z(doc) {\r\n    doc.closePath();\r\n    cx = sx;\r\n    return (cy = sy);\r\n  },\r\n\r\n  z(doc) {\r\n    doc.closePath();\r\n    cx = sx;\r\n    return (cy = sy);\r\n  }\r\n};\r\n\r\nconst solveArc = function(doc, x, y, coords) {\r\n  const [rx, ry, rot, large, sweep, ex, ey] = coords;\r\n  const segs = arcToSegments(ex, ey, rx, ry, large, sweep, rot, x, y);\r\n\r\n  for (let seg of segs) {\r\n    const bez = segmentToBezier(...seg);\r\n    doc.bezierCurveTo(...bez);\r\n  }\r\n};\r\n\r\n// from Inkscape svgtopdf, thanks!\r\nconst arcToSegments = function(x, y, rx, ry, large, sweep, rotateX, ox, oy) {\r\n  const th = rotateX * (Math.PI / 180);\r\n  const sin_th = Math.sin(th);\r\n  const cos_th = Math.cos(th);\r\n  rx = Math.abs(rx);\r\n  ry = Math.abs(ry);\r\n  px = cos_th * (ox - x) * 0.5 + sin_th * (oy - y) * 0.5;\r\n  py = cos_th * (oy - y) * 0.5 - sin_th * (ox - x) * 0.5;\r\n  let pl = (px * px) / (rx * rx) + (py * py) / (ry * ry);\r\n  if (pl > 1) {\r\n    pl = Math.sqrt(pl);\r\n    rx *= pl;\r\n    ry *= pl;\r\n  }\r\n\r\n  const a00 = cos_th / rx;\r\n  const a01 = sin_th / rx;\r\n  const a10 = -sin_th / ry;\r\n  const a11 = cos_th / ry;\r\n  const x0 = a00 * ox + a01 * oy;\r\n  const y0 = a10 * ox + a11 * oy;\r\n  const x1 = a00 * x + a01 * y;\r\n  const y1 = a10 * x + a11 * y;\r\n\r\n  const d = (x1 - x0) * (x1 - x0) + (y1 - y0) * (y1 - y0);\r\n  let sfactor_sq = 1 / d - 0.25;\r\n  if (sfactor_sq < 0) {\r\n    sfactor_sq = 0;\r\n  }\r\n  let sfactor = Math.sqrt(sfactor_sq);\r\n  if (sweep === large) {\r\n    sfactor = -sfactor;\r\n  }\r\n\r\n  const xc = 0.5 * (x0 + x1) - sfactor * (y1 - y0);\r\n  const yc = 0.5 * (y0 + y1) + sfactor * (x1 - x0);\r\n\r\n  const th0 = Math.atan2(y0 - yc, x0 - xc);\r\n  const th1 = Math.atan2(y1 - yc, x1 - xc);\r\n\r\n  let th_arc = th1 - th0;\r\n  if (th_arc < 0 && sweep === 1) {\r\n    th_arc += 2 * Math.PI;\r\n  } else if (th_arc > 0 && sweep === 0) {\r\n    th_arc -= 2 * Math.PI;\r\n  }\r\n\r\n  const segments = Math.ceil(Math.abs(th_arc / (Math.PI * 0.5 + 0.001)));\r\n  const result = [];\r\n\r\n  for (let i = 0; i < segments; i++) {\r\n    const th2 = th0 + (i * th_arc) / segments;\r\n    const th3 = th0 + ((i + 1) * th_arc) / segments;\r\n    result[i] = [xc, yc, th2, th3, rx, ry, sin_th, cos_th];\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\nconst segmentToBezier = function(cx, cy, th0, th1, rx, ry, sin_th, cos_th) {\r\n  const a00 = cos_th * rx;\r\n  const a01 = -sin_th * ry;\r\n  const a10 = sin_th * rx;\r\n  const a11 = cos_th * ry;\r\n\r\n  const th_half = 0.5 * (th1 - th0);\r\n  const t =\r\n    ((8 / 3) * Math.sin(th_half * 0.5) * Math.sin(th_half * 0.5)) /\r\n    Math.sin(th_half);\r\n  const x1 = cx + Math.cos(th0) - t * Math.sin(th0);\r\n  const y1 = cy + Math.sin(th0) + t * Math.cos(th0);\r\n  const x3 = cx + Math.cos(th1);\r\n  const y3 = cy + Math.sin(th1);\r\n  const x2 = x3 + t * Math.sin(th1);\r\n  const y2 = y3 - t * Math.cos(th1);\r\n\r\n  return [\r\n    a00 * x1 + a01 * y1,\r\n    a10 * x1 + a11 * y1,\r\n    a00 * x2 + a01 * y2,\r\n    a10 * x2 + a11 * y2,\r\n    a00 * x3 + a01 * y3,\r\n    a10 * x3 + a11 * y3\r\n  ];\r\n};\r\n\r\nclass SVGPath {\r\n  static apply(doc, path) {\r\n    const commands = parse(path);\r\n    apply(commands, doc);\r\n  }\r\n}\r\n\r\nexport default SVGPath;\r\n","import SVGPath from '../path';\r\nimport PDFObject from '../object';\r\n\r\nconst { number } = PDFObject;\r\n\r\n// This constant is used to approximate a symmetrical arc using a cubic\r\n// Bezier curve.\r\nconst KAPPA = 4.0 * ((Math.sqrt(2) - 1.0) / 3.0);\r\nexport default {\r\n  initVector() {\r\n    this._ctm = [1, 0, 0, 1, 0, 0]; // current transformation matrix\r\n    return (this._ctmStack = []);\r\n  },\r\n\r\n  save() {\r\n    this._ctmStack.push(this._ctm.slice());\r\n    // TODO: save/restore colorspace and styles so not setting it unnessesarily all the time?\r\n    return this.addContent('q');\r\n  },\r\n\r\n  restore() {\r\n    this._ctm = this._ctmStack.pop() || [1, 0, 0, 1, 0, 0];\r\n    return this.addContent('Q');\r\n  },\r\n\r\n  closePath() {\r\n    return this.addContent('h');\r\n  },\r\n\r\n  lineWidth(w) {\r\n    return this.addContent(`${number(w)} w`);\r\n  },\r\n\r\n  _CAP_STYLES: {\r\n    BUTT: 0,\r\n    ROUND: 1,\r\n    SQUARE: 2\r\n  },\r\n\r\n  lineCap(c) {\r\n    if (typeof c === 'string') {\r\n      c = this._CAP_STYLES[c.toUpperCase()];\r\n    }\r\n    return this.addContent(`${c} J`);\r\n  },\r\n\r\n  _JOIN_STYLES: {\r\n    MITER: 0,\r\n    ROUND: 1,\r\n    BEVEL: 2\r\n  },\r\n\r\n  lineJoin(j) {\r\n    if (typeof j === 'string') {\r\n      j = this._JOIN_STYLES[j.toUpperCase()];\r\n    }\r\n    return this.addContent(`${j} j`);\r\n  },\r\n\r\n  miterLimit(m) {\r\n    return this.addContent(`${number(m)} M`);\r\n  },\r\n\r\n  dash(length, options = {}) {\r\n    const originalLength = length;\r\n    if (!Array.isArray(length)) {\r\n      length = [length, options.space || length];\r\n    }\r\n\r\n    const valid = length.every(x => Number.isFinite(x) && x > 0);\r\n    if (!valid) {\r\n      throw new Error(\r\n        `dash(${JSON.stringify(originalLength)}, ${JSON.stringify(\r\n          options\r\n        )}) invalid, lengths must be numeric and greater than zero`\r\n      );\r\n    }\r\n\r\n    length = length.map(number).join(' ');\r\n    return this.addContent(`[${length}] ${number(options.phase || 0)} d`);\r\n  },\r\n\r\n  undash() {\r\n    return this.addContent('[] 0 d');\r\n  },\r\n\r\n  moveTo(x, y) {\r\n    return this.addContent(`${number(x)} ${number(y)} m`);\r\n  },\r\n\r\n  lineTo(x, y) {\r\n    return this.addContent(`${number(x)} ${number(y)} l`);\r\n  },\r\n\r\n  bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y) {\r\n    return this.addContent(\r\n      `${number(cp1x)} ${number(cp1y)} ${number(cp2x)} ${number(cp2y)} ${number(\r\n        x\r\n      )} ${number(y)} c`\r\n    );\r\n  },\r\n\r\n  quadraticCurveTo(cpx, cpy, x, y) {\r\n    return this.addContent(\r\n      `${number(cpx)} ${number(cpy)} ${number(x)} ${number(y)} v`\r\n    );\r\n  },\r\n\r\n  rect(x, y, w, h) {\r\n    return this.addContent(\r\n      `${number(x)} ${number(y)} ${number(w)} ${number(h)} re`\r\n    );\r\n  },\r\n\r\n  roundedRect(x, y, w, h, r) {\r\n    if (r == null) {\r\n      r = 0;\r\n    }\r\n    r = Math.min(r, 0.5 * w, 0.5 * h);\r\n\r\n    // amount to inset control points from corners (see `ellipse`)\r\n    const c = r * (1.0 - KAPPA);\r\n\r\n    this.moveTo(x + r, y);\r\n    this.lineTo(x + w - r, y);\r\n    this.bezierCurveTo(x + w - c, y, x + w, y + c, x + w, y + r);\r\n    this.lineTo(x + w, y + h - r);\r\n    this.bezierCurveTo(x + w, y + h - c, x + w - c, y + h, x + w - r, y + h);\r\n    this.lineTo(x + r, y + h);\r\n    this.bezierCurveTo(x + c, y + h, x, y + h - c, x, y + h - r);\r\n    this.lineTo(x, y + r);\r\n    this.bezierCurveTo(x, y + c, x + c, y, x + r, y);\r\n    return this.closePath();\r\n  },\r\n\r\n  ellipse(x, y, r1, r2) {\r\n    // based on http://stackoverflow.com/questions/2172798/how-to-draw-an-oval-in-html5-canvas/2173084#2173084\r\n    if (r2 == null) {\r\n      r2 = r1;\r\n    }\r\n    x -= r1;\r\n    y -= r2;\r\n    const ox = r1 * KAPPA;\r\n    const oy = r2 * KAPPA;\r\n    const xe = x + r1 * 2;\r\n    const ye = y + r2 * 2;\r\n    const xm = x + r1;\r\n    const ym = y + r2;\r\n\r\n    this.moveTo(x, ym);\r\n    this.bezierCurveTo(x, ym - oy, xm - ox, y, xm, y);\r\n    this.bezierCurveTo(xm + ox, y, xe, ym - oy, xe, ym);\r\n    this.bezierCurveTo(xe, ym + oy, xm + ox, ye, xm, ye);\r\n    this.bezierCurveTo(xm - ox, ye, x, ym + oy, x, ym);\r\n    return this.closePath();\r\n  },\r\n\r\n  circle(x, y, radius) {\r\n    return this.ellipse(x, y, radius);\r\n  },\r\n\r\n  arc(x, y, radius, startAngle, endAngle, anticlockwise) {\r\n    if (anticlockwise == null) {\r\n      anticlockwise = false;\r\n    }\r\n    const TWO_PI = 2.0 * Math.PI;\r\n    const HALF_PI = 0.5 * Math.PI;\r\n\r\n    let deltaAng = endAngle - startAngle;\r\n\r\n    if (Math.abs(deltaAng) > TWO_PI) {\r\n      // draw only full circle if more than that is specified\r\n      deltaAng = TWO_PI;\r\n    } else if (deltaAng !== 0 && anticlockwise !== deltaAng < 0) {\r\n      // necessary to flip direction of rendering\r\n      const dir = anticlockwise ? -1 : 1;\r\n      deltaAng = dir * TWO_PI + deltaAng;\r\n    }\r\n\r\n    const numSegs = Math.ceil(Math.abs(deltaAng) / HALF_PI);\r\n    const segAng = deltaAng / numSegs;\r\n    const handleLen = (segAng / HALF_PI) * KAPPA * radius;\r\n    let curAng = startAngle;\r\n\r\n    // component distances between anchor point and control point\r\n    let deltaCx = -Math.sin(curAng) * handleLen;\r\n    let deltaCy = Math.cos(curAng) * handleLen;\r\n\r\n    // anchor point\r\n    let ax = x + Math.cos(curAng) * radius;\r\n    let ay = y + Math.sin(curAng) * radius;\r\n\r\n    // calculate and render segments\r\n    this.moveTo(ax, ay);\r\n\r\n    for (let segIdx = 0; segIdx < numSegs; segIdx++) {\r\n      // starting control point\r\n      const cp1x = ax + deltaCx;\r\n      const cp1y = ay + deltaCy;\r\n\r\n      // step angle\r\n      curAng += segAng;\r\n\r\n      // next anchor point\r\n      ax = x + Math.cos(curAng) * radius;\r\n      ay = y + Math.sin(curAng) * radius;\r\n\r\n      // next control point delta\r\n      deltaCx = -Math.sin(curAng) * handleLen;\r\n      deltaCy = Math.cos(curAng) * handleLen;\r\n\r\n      // ending control point\r\n      const cp2x = ax - deltaCx;\r\n      const cp2y = ay - deltaCy;\r\n\r\n      // render segment\r\n      this.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, ax, ay);\r\n    }\r\n\r\n    return this;\r\n  },\r\n\r\n  polygon(...points) {\r\n    this.moveTo(...(points.shift() || []));\r\n    for (let point of points) {\r\n      this.lineTo(...(point || []));\r\n    }\r\n    return this.closePath();\r\n  },\r\n\r\n  path(path) {\r\n    SVGPath.apply(this, path);\r\n    return this;\r\n  },\r\n\r\n  _windingRule(rule) {\r\n    if (/even-?odd/.test(rule)) {\r\n      return '*';\r\n    }\r\n\r\n    return '';\r\n  },\r\n\r\n  fill(color, rule) {\r\n    if (/(even-?odd)|(non-?zero)/.test(color)) {\r\n      rule = color;\r\n      color = null;\r\n    }\r\n\r\n    if (color) {\r\n      this.fillColor(color);\r\n    }\r\n    return this.addContent(`f${this._windingRule(rule)}`);\r\n  },\r\n\r\n  stroke(color) {\r\n    if (color) {\r\n      this.strokeColor(color);\r\n    }\r\n    return this.addContent('S');\r\n  },\r\n\r\n  fillAndStroke(fillColor, strokeColor, rule) {\r\n    if (strokeColor == null) {\r\n      strokeColor = fillColor;\r\n    }\r\n    const isFillRule = /(even-?odd)|(non-?zero)/;\r\n    if (isFillRule.test(fillColor)) {\r\n      rule = fillColor;\r\n      fillColor = null;\r\n    }\r\n\r\n    if (isFillRule.test(strokeColor)) {\r\n      rule = strokeColor;\r\n      strokeColor = fillColor;\r\n    }\r\n\r\n    if (fillColor) {\r\n      this.fillColor(fillColor);\r\n      this.strokeColor(strokeColor);\r\n    }\r\n\r\n    return this.addContent(`B${this._windingRule(rule)}`);\r\n  },\r\n\r\n  clip(rule) {\r\n    return this.addContent(`W${this._windingRule(rule)} n`);\r\n  },\r\n\r\n  transform(m11, m12, m21, m22, dx, dy) {\r\n    // keep track of the current transformation matrix\r\n    if (m11 === 1 && m12 === 0 && m21 === 0 && m22 === 1 && dx === 0 && dy === 0) {\r\n      // Ignore identity transforms\r\n      return this;\r\n    }\r\n    const m = this._ctm;\r\n    const [m0, m1, m2, m3, m4, m5] = m;\r\n    m[0] = m0 * m11 + m2 * m12;\r\n    m[1] = m1 * m11 + m3 * m12;\r\n    m[2] = m0 * m21 + m2 * m22;\r\n    m[3] = m1 * m21 + m3 * m22;\r\n    m[4] = m0 * dx + m2 * dy + m4;\r\n    m[5] = m1 * dx + m3 * dy + m5;\r\n\r\n    const values = [m11, m12, m21, m22, dx, dy].map(v => number(v)).join(' ');\r\n    return this.addContent(`${values} cm`);\r\n  },\r\n\r\n  translate(x, y) {\r\n    return this.transform(1, 0, 0, 1, x, y);\r\n  },\r\n\r\n  rotate(angle, options = {}) {\r\n    let y;\r\n    const rad = (angle * Math.PI) / 180;\r\n    const cos = Math.cos(rad);\r\n    const sin = Math.sin(rad);\r\n    let x = (y = 0);\r\n\r\n    if (options.origin != null) {\r\n      [x, y] = options.origin;\r\n      const x1 = x * cos - y * sin;\r\n      const y1 = x * sin + y * cos;\r\n      x -= x1;\r\n      y -= y1;\r\n    }\r\n\r\n    return this.transform(cos, sin, -sin, cos, x, y);\r\n  },\r\n\r\n  scale(xFactor, yFactor, options = {}) {\r\n    let y;\r\n    if (yFactor == null) {\r\n      yFactor = xFactor;\r\n    }\r\n    if (typeof yFactor === 'object') {\r\n      options = yFactor;\r\n      yFactor = xFactor;\r\n    }\r\n\r\n    let x = (y = 0);\r\n    if (options.origin != null) {\r\n      [x, y] = options.origin;\r\n      x -= xFactor * x;\r\n      y -= yFactor * y;\r\n    }\r\n\r\n    return this.transform(xFactor, 0, 0, yFactor, x, y);\r\n  }\r\n};\r\n","import fs from 'fs';\r\n\r\nconst WIN_ANSI_MAP = {\r\n  402: 131,\r\n  8211: 150,\r\n  8212: 151,\r\n  8216: 145,\r\n  8217: 146,\r\n  8218: 130,\r\n  8220: 147,\r\n  8221: 148,\r\n  8222: 132,\r\n  8224: 134,\r\n  8225: 135,\r\n  8226: 149,\r\n  8230: 133,\r\n  8364: 128,\r\n  8240: 137,\r\n  8249: 139,\r\n  8250: 155,\r\n  710: 136,\r\n  8482: 153,\r\n  338: 140,\r\n  339: 156,\r\n  732: 152,\r\n  352: 138,\r\n  353: 154,\r\n  376: 159,\r\n  381: 142,\r\n  382: 158\r\n};\r\n\r\nconst characters = `\\\r\n.notdef       .notdef        .notdef        .notdef\r\n.notdef       .notdef        .notdef        .notdef\r\n.notdef       .notdef        .notdef        .notdef\r\n.notdef       .notdef        .notdef        .notdef\r\n.notdef       .notdef        .notdef        .notdef\r\n.notdef       .notdef        .notdef        .notdef\r\n.notdef       .notdef        .notdef        .notdef\r\n.notdef       .notdef        .notdef        .notdef\r\n  \r\nspace         exclam         quotedbl       numbersign\r\ndollar        percent        ampersand      quotesingle\r\nparenleft     parenright     asterisk       plus\r\ncomma         hyphen         period         slash\r\nzero          one            two            three\r\nfour          five           six            seven\r\neight         nine           colon          semicolon\r\nless          equal          greater        question\r\n  \r\nat            A              B              C\r\nD             E              F              G\r\nH             I              J              K\r\nL             M              N              O\r\nP             Q              R              S\r\nT             U              V              W\r\nX             Y              Z              bracketleft\r\nbackslash     bracketright   asciicircum    underscore\r\n  \r\ngrave         a              b              c\r\nd             e              f              g\r\nh             i              j              k\r\nl             m              n              o\r\np             q              r              s\r\nt             u              v              w\r\nx             y              z              braceleft\r\nbar           braceright     asciitilde     .notdef\r\n  \r\nEuro          .notdef        quotesinglbase florin\r\nquotedblbase  ellipsis       dagger         daggerdbl\r\ncircumflex    perthousand    Scaron         guilsinglleft\r\nOE            .notdef        Zcaron         .notdef\r\n.notdef       quoteleft      quoteright     quotedblleft\r\nquotedblright bullet         endash         emdash\r\ntilde         trademark      scaron         guilsinglright\r\noe            .notdef        zcaron         ydieresis\r\n  \r\nspace         exclamdown     cent           sterling\r\ncurrency      yen            brokenbar      section\r\ndieresis      copyright      ordfeminine    guillemotleft\r\nlogicalnot    hyphen         registered     macron\r\ndegree        plusminus      twosuperior    threesuperior\r\nacute         mu             paragraph      periodcentered\r\ncedilla       onesuperior    ordmasculine   guillemotright\r\nonequarter    onehalf        threequarters  questiondown\r\n  \r\nAgrave        Aacute         Acircumflex    Atilde\r\nAdieresis     Aring          AE             Ccedilla\r\nEgrave        Eacute         Ecircumflex    Edieresis\r\nIgrave        Iacute         Icircumflex    Idieresis\r\nEth           Ntilde         Ograve         Oacute\r\nOcircumflex   Otilde         Odieresis      multiply\r\nOslash        Ugrave         Uacute         Ucircumflex\r\nUdieresis     Yacute         Thorn          germandbls\r\n  \r\nagrave        aacute         acircumflex    atilde\r\nadieresis     aring          ae             ccedilla\r\negrave        eacute         ecircumflex    edieresis\r\nigrave        iacute         icircumflex    idieresis\r\neth           ntilde         ograve         oacute\r\nocircumflex   otilde         odieresis      divide\r\noslash        ugrave         uacute         ucircumflex\r\nudieresis     yacute         thorn          ydieresis\\\r\n`.split(/\\s+/);\r\n\r\nclass AFMFont {\r\n  static open(filename) {\r\n    return new AFMFont(fs.readFileSync(filename, 'utf8'));\r\n  }\r\n\r\n  constructor(contents) {\r\n    this.contents = contents;\r\n    this.attributes = {};\r\n    this.glyphWidths = {};\r\n    this.boundingBoxes = {};\r\n    this.kernPairs = {};\r\n\r\n    this.parse();\r\n    // todo: remove charWidths since appears to not be used\r\n    this.charWidths = new Array(256);\r\n    for (let char = 0; char <= 255; char++) {\r\n      this.charWidths[char] = this.glyphWidths[characters[char]];\r\n    }\r\n\r\n    this.bbox = this.attributes['FontBBox'].split(/\\s+/).map(e => +e);\r\n    this.ascender = +(this.attributes['Ascender'] || 0);\r\n    this.descender = +(this.attributes['Descender'] || 0);\r\n    this.xHeight = +(this.attributes['XHeight'] || 0);\r\n    this.capHeight = +(this.attributes['CapHeight'] || 0);\r\n    this.lineGap =\r\n      this.bbox[3] - this.bbox[1] - (this.ascender - this.descender);\r\n  }\r\n\r\n  parse() {\r\n    let section = '';\r\n    for (let line of this.contents.split('\\n')) {\r\n      var match;\r\n      var a;\r\n      if ((match = line.match(/^Start(\\w+)/))) {\r\n        section = match[1];\r\n        continue;\r\n      } else if ((match = line.match(/^End(\\w+)/))) {\r\n        section = '';\r\n        continue;\r\n      }\r\n\r\n      switch (section) {\r\n        case 'FontMetrics':\r\n          match = line.match(/(^\\w+)\\s+(.*)/);\r\n          var key = match[1];\r\n          var value = match[2];\r\n\r\n          if ((a = this.attributes[key])) {\r\n            if (!Array.isArray(a)) {\r\n              a = this.attributes[key] = [a];\r\n            }\r\n            a.push(value);\r\n          } else {\r\n            this.attributes[key] = value;\r\n          }\r\n          break;\r\n\r\n        case 'CharMetrics':\r\n          if (!/^CH?\\s/.test(line)) {\r\n            continue;\r\n          }\r\n          var name = line.match(/\\bN\\s+(\\.?\\w+)\\s*;/)[1];\r\n          this.glyphWidths[name] = +line.match(/\\bWX\\s+(\\d+)\\s*;/)[1];\r\n          break;\r\n\r\n        case 'KernPairs':\r\n          match = line.match(/^KPX\\s+(\\.?\\w+)\\s+(\\.?\\w+)\\s+(-?\\d+)/);\r\n          if (match) {\r\n            this.kernPairs[match[1] + '\\0' + match[2]] = parseInt(match[3]);\r\n          }\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  encodeText(text) {\r\n    const res = [];\r\n    for (let i = 0, len = text.length; i < len; i++) {\r\n      let char = text.charCodeAt(i);\r\n      char = WIN_ANSI_MAP[char] || char;\r\n      res.push(char.toString(16));\r\n    }\r\n\r\n    return res;\r\n  }\r\n\r\n  glyphsForString(string) {\r\n    const glyphs = [];\r\n\r\n    for (let i = 0, len = string.length; i < len; i++) {\r\n      const charCode = string.charCodeAt(i);\r\n      glyphs.push(this.characterToGlyph(charCode));\r\n    }\r\n\r\n    return glyphs;\r\n  }\r\n\r\n  characterToGlyph(character) {\r\n    return characters[WIN_ANSI_MAP[character] || character] || '.notdef';\r\n  }\r\n\r\n  widthOfGlyph(glyph) {\r\n    return this.glyphWidths[glyph] || 0;\r\n  }\r\n\r\n  getKernPair(left, right) {\r\n    return this.kernPairs[left + '\\0' + right] || 0;\r\n  }\r\n\r\n  advancesForGlyphs(glyphs) {\r\n    const advances = [];\r\n\r\n    for (let index = 0; index < glyphs.length; index++) {\r\n      const left = glyphs[index];\r\n      const right = glyphs[index + 1];\r\n      advances.push(this.widthOfGlyph(left) + this.getKernPair(left, right));\r\n    }\r\n\r\n    return advances;\r\n  }\r\n}\r\n\r\nexport default AFMFont;\r\n","class PDFFont {\r\n  constructor() {}\r\n\r\n  encode() {\r\n    throw new Error('Must be implemented by subclasses');\r\n  }\r\n\r\n  widthOfString() {\r\n    throw new Error('Must be implemented by subclasses');\r\n  }\r\n\r\n  ref() {\r\n    return this.dictionary != null\r\n      ? this.dictionary\r\n      : (this.dictionary = this.document.ref());\r\n  }\r\n\r\n  finalize() {\r\n    if (this.embedded || this.dictionary == null) {\r\n      return;\r\n    }\r\n\r\n    this.embed();\r\n    return (this.embedded = true);\r\n  }\r\n\r\n  embed() {\r\n    throw new Error('Must be implemented by subclasses');\r\n  }\r\n\r\n  lineHeight(size, includeGap) {\r\n    if (includeGap == null) {\r\n      includeGap = false;\r\n    }\r\n    const gap = includeGap ? this.lineGap : 0;\r\n    return ((this.ascender + gap - this.descender) / 1000) * size;\r\n  }\r\n}\r\n\r\nexport default PDFFont;\r\n","import AFMFont from './afm';\r\nimport PDFFont from '../font';\r\nimport fs from 'fs';\r\n\r\n// This insanity is so bundlers can inline the font files\r\nconst STANDARD_FONTS = {\r\n  Courier() {\r\n    return fs.readFileSync(__dirname + '/data/Courier.afm', 'utf8');\r\n  },\r\n  'Courier-Bold'() {\r\n    return fs.readFileSync(__dirname + '/data/Courier-Bold.afm', 'utf8');\r\n  },\r\n  'Courier-Oblique'() {\r\n    return fs.readFileSync(__dirname + '/data/Courier-Oblique.afm', 'utf8');\r\n  },\r\n  'Courier-BoldOblique'() {\r\n    return fs.readFileSync(__dirname + '/data/Courier-BoldOblique.afm', 'utf8');\r\n  },\r\n  Helvetica() {\r\n    return fs.readFileSync(__dirname + '/data/Helvetica.afm', 'utf8');\r\n  },\r\n  'Helvetica-Bold'() {\r\n    return fs.readFileSync(__dirname + '/data/Helvetica-Bold.afm', 'utf8');\r\n  },\r\n  'Helvetica-Oblique'() {\r\n    return fs.readFileSync(__dirname + '/data/Helvetica-Oblique.afm', 'utf8');\r\n  },\r\n  'Helvetica-BoldOblique'() {\r\n    return fs.readFileSync(\r\n      __dirname + '/data/Helvetica-BoldOblique.afm',\r\n      'utf8'\r\n    );\r\n  },\r\n  'Times-Roman'() {\r\n    return fs.readFileSync(__dirname + '/data/Times-Roman.afm', 'utf8');\r\n  },\r\n  'Times-Bold'() {\r\n    return fs.readFileSync(__dirname + '/data/Times-Bold.afm', 'utf8');\r\n  },\r\n  'Times-Italic'() {\r\n    return fs.readFileSync(__dirname + '/data/Times-Italic.afm', 'utf8');\r\n  },\r\n  'Times-BoldItalic'() {\r\n    return fs.readFileSync(__dirname + '/data/Times-BoldItalic.afm', 'utf8');\r\n  },\r\n  Symbol() {\r\n    return fs.readFileSync(__dirname + '/data/Symbol.afm', 'utf8');\r\n  },\r\n  ZapfDingbats() {\r\n    return fs.readFileSync(__dirname + '/data/ZapfDingbats.afm', 'utf8');\r\n  }\r\n};\r\n\r\nclass StandardFont extends PDFFont {\r\n  constructor(document, name, id) {\r\n    super();\r\n    this.document = document;\r\n    this.name = name;\r\n    this.id = id;\r\n    this.font = new AFMFont(STANDARD_FONTS[this.name]());\r\n    ({\r\n      ascender: this.ascender,\r\n      descender: this.descender,\r\n      bbox: this.bbox,\r\n      lineGap: this.lineGap,\r\n      xHeight: this.xHeight,\r\n      capHeight: this.capHeight\r\n    } = this.font);\r\n  }\r\n\r\n  embed() {\r\n    this.dictionary.data = {\r\n      Type: 'Font',\r\n      BaseFont: this.name,\r\n      Subtype: 'Type1',\r\n      Encoding: 'WinAnsiEncoding'\r\n    };\r\n\r\n    return this.dictionary.end();\r\n  }\r\n\r\n  encode(text) {\r\n    const encoded = this.font.encodeText(text);\r\n    const glyphs = this.font.glyphsForString(`${text}`);\r\n    const advances = this.font.advancesForGlyphs(glyphs);\r\n    const positions = [];\r\n    for (let i = 0; i < glyphs.length; i++) {\r\n      const glyph = glyphs[i];\r\n      positions.push({\r\n        xAdvance: advances[i],\r\n        yAdvance: 0,\r\n        xOffset: 0,\r\n        yOffset: 0,\r\n        advanceWidth: this.font.widthOfGlyph(glyph)\r\n      });\r\n    }\r\n\r\n    return [encoded, positions];\r\n  }\r\n\r\n  widthOfString(string, size) {\r\n    const glyphs = this.font.glyphsForString(`${string}`);\r\n    const advances = this.font.advancesForGlyphs(glyphs);\r\n\r\n    let width = 0;\r\n    for (let advance of advances) {\r\n      width += advance;\r\n    }\r\n\r\n    const scale = size / 1000;\r\n    return width * scale;\r\n  }\r\n\r\n  static isStandardFont(name) {\r\n    return name in STANDARD_FONTS;\r\n  }\r\n}\r\n\r\nexport default StandardFont;\r\n","import PDFFont from '../font';\r\n\r\nconst toHex = function(num) {\r\n  return `0000${num.toString(16)}`.slice(-4);\r\n};\r\n\r\nclass EmbeddedFont extends PDFFont {\r\n  constructor(document, font, id) {\r\n    super();\r\n    this.document = document;\r\n    this.font = font;\r\n    this.id = id;\r\n    this.subset = this.font.createSubset();\r\n    this.unicode = [[0]];\r\n    this.widths = [this.font.getGlyph(0).advanceWidth];\r\n\r\n    this.name = this.font.postscriptName;\r\n    this.scale = 1000 / this.font.unitsPerEm;\r\n    this.ascender = this.font.ascent * this.scale;\r\n    this.descender = this.font.descent * this.scale;\r\n    this.xHeight = this.font.xHeight * this.scale;\r\n    this.capHeight = this.font.capHeight * this.scale;\r\n    this.lineGap = this.font.lineGap * this.scale;\r\n    this.bbox = this.font.bbox;\r\n\r\n    if (document.options.fontLayoutCache !== false) {\r\n      this.layoutCache = Object.create(null);\r\n    }\r\n  }\r\n\r\n  layoutRun(text, features) {\r\n    const run = this.font.layout(text, features);\r\n\r\n    // Normalize position values\r\n    for (let i = 0; i < run.positions.length; i++) {\r\n      const position = run.positions[i];\r\n      for (let key in position) {\r\n        position[key] *= this.scale;\r\n      }\r\n\r\n      position.advanceWidth = run.glyphs[i].advanceWidth * this.scale;\r\n    }\r\n\r\n    return run;\r\n  }\r\n\r\n  layoutCached(text) {\r\n    if (!this.layoutCache) {\r\n      return this.layoutRun(text);\r\n    }\r\n    let cached;\r\n    if ((cached = this.layoutCache[text])) {\r\n      return cached;\r\n    }\r\n\r\n    const run = this.layoutRun(text);\r\n    this.layoutCache[text] = run;\r\n    return run;\r\n  }\r\n\r\n  layout(text, features, onlyWidth) {\r\n    // Skip the cache if any user defined features are applied\r\n    if (features) {\r\n      return this.layoutRun(text, features);\r\n    }\r\n\r\n    let glyphs = onlyWidth ? null : [];\r\n    let positions = onlyWidth ? null : [];\r\n    let advanceWidth = 0;\r\n\r\n    // Split the string by words to increase cache efficiency.\r\n    // For this purpose, spaces and tabs are a good enough delimeter.\r\n    let last = 0;\r\n    let index = 0;\r\n    while (index <= text.length) {\r\n      var needle;\r\n      if (\r\n        (index === text.length && last < index) ||\r\n        ((needle = text.charAt(index)), [' ', '\\t'].includes(needle))\r\n      ) {\r\n        const run = this.layoutCached(text.slice(last, ++index));\r\n        if (!onlyWidth) {\r\n          glyphs = glyphs.concat(run.glyphs);\r\n          positions = positions.concat(run.positions);\r\n        }\r\n\r\n        advanceWidth += run.advanceWidth;\r\n        last = index;\r\n      } else {\r\n        index++;\r\n      }\r\n    }\r\n\r\n    return { glyphs, positions, advanceWidth };\r\n  }\r\n\r\n  encode(text, features) {\r\n    const { glyphs, positions } = this.layout(text, features);\r\n\r\n    const res = [];\r\n    for (let i = 0; i < glyphs.length; i++) {\r\n      const glyph = glyphs[i];\r\n      const gid = this.subset.includeGlyph(glyph.id);\r\n      res.push(`0000${gid.toString(16)}`.slice(-4));\r\n\r\n      if (this.widths[gid] == null) {\r\n        this.widths[gid] = glyph.advanceWidth * this.scale;\r\n      }\r\n      if (this.unicode[gid] == null) {\r\n        this.unicode[gid] = glyph.codePoints;\r\n      }\r\n    }\r\n\r\n    return [res, positions];\r\n  }\r\n\r\n  widthOfString(string, size, features) {\r\n    const width = this.layout(string, features, true).advanceWidth;\r\n    const scale = size / 1000;\r\n    return width * scale;\r\n  }\r\n\r\n  embed() {\r\n    const isCFF = this.subset.cff != null;\r\n    const fontFile = this.document.ref();\r\n\r\n    if (isCFF) {\r\n      fontFile.data.Subtype = 'CIDFontType0C';\r\n    }\r\n\r\n    this.subset\r\n      .encodeStream()\r\n      .on('data', data => fontFile.write(data))\r\n      .on('end', () => fontFile.end());\r\n\r\n    const familyClass =\r\n      ((this.font['OS/2'] != null\r\n        ? this.font['OS/2'].sFamilyClass\r\n        : undefined) || 0) >> 8;\r\n    let flags = 0;\r\n    if (this.font.post.isFixedPitch) {\r\n      flags |= 1 << 0;\r\n    }\r\n    if (1 <= familyClass && familyClass <= 7) {\r\n      flags |= 1 << 1;\r\n    }\r\n    flags |= 1 << 2; // assume the font uses non-latin characters\r\n    if (familyClass === 10) {\r\n      flags |= 1 << 3;\r\n    }\r\n    if (this.font.head.macStyle.italic) {\r\n      flags |= 1 << 6;\r\n    }\r\n\r\n    // generate a tag (6 uppercase letters. 17 is the char code offset from '0' to 'A'. 73 will map to 'Z')\r\n    const tag = [1, 2, 3, 4, 5, 6]\r\n      .map(i => String.fromCharCode((this.id.charCodeAt(i) || 73) + 17))\r\n      .join('');\r\n    const name = tag + '+' + this.font.postscriptName;\r\n\r\n    const { bbox } = this.font;\r\n    const descriptor = this.document.ref({\r\n      Type: 'FontDescriptor',\r\n      FontName: name,\r\n      Flags: flags,\r\n      FontBBox: [\r\n        bbox.minX * this.scale,\r\n        bbox.minY * this.scale,\r\n        bbox.maxX * this.scale,\r\n        bbox.maxY * this.scale\r\n      ],\r\n      ItalicAngle: this.font.italicAngle,\r\n      Ascent: this.ascender,\r\n      Descent: this.descender,\r\n      CapHeight: (this.font.capHeight || this.font.ascent) * this.scale,\r\n      XHeight: (this.font.xHeight || 0) * this.scale,\r\n      StemV: 0\r\n    }); // not sure how to calculate this\r\n\r\n    if (isCFF) {\r\n      descriptor.data.FontFile3 = fontFile;\r\n    } else {\r\n      descriptor.data.FontFile2 = fontFile;\r\n    }\r\n\r\n    if (this.document.subset) {\r\n      const CIDSet = Buffer.from('FFFFFFFFC0', 'hex');\r\n      const CIDSetRef = this.document.ref();\r\n      CIDSetRef.write(CIDSet);\r\n      CIDSetRef.end();\r\n\r\n      descriptor.data.CIDSet = CIDSetRef;\r\n    }\r\n\r\n    descriptor.end();\r\n\r\n    const descendantFontData = {\r\n      Type: 'Font',\r\n      Subtype: 'CIDFontType0',\r\n      BaseFont: name,\r\n      CIDSystemInfo: {\r\n        Registry: new String('Adobe'),\r\n        Ordering: new String('Identity'),\r\n        Supplement: 0\r\n      },\r\n      FontDescriptor: descriptor,\r\n      W: [0, this.widths]\r\n    };\r\n\r\n    if (!isCFF) {\r\n      descendantFontData.Subtype = 'CIDFontType2';\r\n      descendantFontData.CIDToGIDMap = 'Identity';\r\n    }\r\n\r\n    const descendantFont = this.document.ref(descendantFontData);\r\n\r\n    descendantFont.end();\r\n\r\n    this.dictionary.data = {\r\n      Type: 'Font',\r\n      Subtype: 'Type0',\r\n      BaseFont: name,\r\n      Encoding: 'Identity-H',\r\n      DescendantFonts: [descendantFont],\r\n      ToUnicode: this.toUnicodeCmap()\r\n    };\r\n\r\n    return this.dictionary.end();\r\n  }\r\n\r\n  // Maps the glyph ids encoded in the PDF back to unicode strings\r\n  // Because of ligature substitutions and the like, there may be one or more\r\n  // unicode characters represented by each glyph.\r\n  toUnicodeCmap() {\r\n    const cmap = this.document.ref();\r\n\r\n    const entries = [];\r\n    for (let codePoints of this.unicode) {\r\n      const encoded = [];\r\n\r\n      // encode codePoints to utf16\r\n      for (let value of codePoints) {\r\n        if (value > 0xffff) {\r\n          value -= 0x10000;\r\n          encoded.push(toHex(((value >>> 10) & 0x3ff) | 0xd800));\r\n          value = 0xdc00 | (value & 0x3ff);\r\n        }\r\n\r\n        encoded.push(toHex(value));\r\n      }\r\n\r\n      entries.push(`<${encoded.join(' ')}>`);\r\n    }\r\n\r\n    const chunkSize = 256;\r\n    const chunks = Math.ceil(entries.length / chunkSize);\r\n    const ranges = [];\r\n    for (let i = 0; i < chunks; i++) {\r\n      const start = i * chunkSize;\r\n      const end = Math.min((i + 1) * chunkSize, entries.length);\r\n      ranges.push(`<${toHex(start)}> <${toHex(end - 1)}> [${entries.slice(start, end).join(' ')}]`);\r\n    }\r\n\r\n    cmap.end(`\\\r\n/CIDInit /ProcSet findresource begin\r\n12 dict begin\r\nbegincmap\r\n/CIDSystemInfo <<\r\n  /Registry (Adobe)\r\n  /Ordering (UCS)\r\n  /Supplement 0\r\n>> def\r\n/CMapName /Adobe-Identity-UCS def\r\n/CMapType 2 def\r\n1 begincodespacerange\r\n<0000><ffff>\r\nendcodespacerange\r\n1 beginbfrange\r\n${ranges.join('\\n')}\r\nendbfrange\r\nendcmap\r\nCMapName currentdict /CMap defineresource pop\r\nend\r\nend\\\r\n`);\r\n\r\n    return cmap;\r\n  }\r\n}\r\n\r\nexport default EmbeddedFont;\r\n","import fs from 'fs';\r\nimport fontkit from 'fontkit';\r\nimport StandardFont from './font/standard';\r\nimport EmbeddedFont from './font/embedded';\r\n\r\nclass PDFFontFactory {\r\n  static open(document, src, family, id) {\r\n    let font;\r\n    if (typeof src === 'string') {\r\n      if (StandardFont.isStandardFont(src)) {\r\n        return new StandardFont(document, src, id);\r\n      }\r\n\r\n      src = fs.readFileSync(src);\r\n    }\r\n    if (Buffer.isBuffer(src)) {\r\n      font = fontkit.create(src, family);\r\n    } else if (src instanceof Uint8Array) {\r\n      font = fontkit.create(Buffer.from(src), family);\r\n    } else if (src instanceof ArrayBuffer) {\r\n      font = fontkit.create(Buffer.from(new Uint8Array(src)), family);\r\n    }\r\n\r\n    if (font == null) {\r\n      throw new Error('Not a supported font format or standard PDF font.');\r\n    }\r\n\r\n    return new EmbeddedFont(document, font, id);\r\n  }\r\n}\r\n\r\nexport default PDFFontFactory;\r\n","import PDFFontFactory from '../font_factory';\r\n\r\nexport default {\r\n  initFonts(defaultFont = 'Helvetica') {\r\n    // Lookup table for embedded fonts\r\n    this._fontFamilies = {};\r\n    this._fontCount = 0;\r\n\r\n    // Font state\r\n    this._fontSize = 12;\r\n    this._font = null;\r\n\r\n    this._registeredFonts = {};\r\n\r\n    // Set the default font\r\n    if (defaultFont) {\r\n      this.font(defaultFont);\r\n    }\r\n  },\r\n\r\n  font(src, family, size) {\r\n    let cacheKey, font;\r\n    if (typeof family === 'number') {\r\n      size = family;\r\n      family = null;\r\n    }\r\n\r\n    // check registered fonts if src is a string\r\n    if (typeof src === 'string' && this._registeredFonts[src]) {\r\n      cacheKey = src;\r\n      ({ src, family } = this._registeredFonts[src]);\r\n    } else {\r\n      cacheKey = family || src;\r\n      if (typeof cacheKey !== 'string') {\r\n        cacheKey = null;\r\n      }\r\n    }\r\n\r\n    if (size != null) {\r\n      this.fontSize(size);\r\n    }\r\n\r\n    // fast path: check if the font is already in the PDF\r\n    if ((font = this._fontFamilies[cacheKey])) {\r\n      this._font = font;\r\n      return this;\r\n    }\r\n\r\n    // load the font\r\n    const id = `F${++this._fontCount}`;\r\n    this._font = PDFFontFactory.open(this, src, family, id);\r\n\r\n    // check for existing font familes with the same name already in the PDF\r\n    // useful if the font was passed as a buffer\r\n    if ((font = this._fontFamilies[this._font.name])) {\r\n      this._font = font;\r\n      return this;\r\n    }\r\n\r\n    // save the font for reuse later\r\n    if (cacheKey) {\r\n      this._fontFamilies[cacheKey] = this._font;\r\n    }\r\n\r\n    if (this._font.name) {\r\n      this._fontFamilies[this._font.name] = this._font;\r\n    }\r\n\r\n    return this;\r\n  },\r\n\r\n  fontSize(_fontSize) {\r\n    this._fontSize = _fontSize;\r\n    return this;\r\n  },\r\n\r\n  currentLineHeight(includeGap) {\r\n    if (includeGap == null) {\r\n      includeGap = false;\r\n    }\r\n    return this._font.lineHeight(this._fontSize, includeGap);\r\n  },\r\n\r\n  registerFont(name, src, family) {\r\n    this._registeredFonts[name] = {\r\n      src,\r\n      family\r\n    };\r\n\r\n    return this;\r\n  }\r\n};\r\n","import { EventEmitter } from 'events';\r\nimport LineBreaker from 'linebreak';\r\n\r\nconst SOFT_HYPHEN = '\\u00AD';\r\nconst HYPHEN = '-';\r\n\r\nclass LineWrapper extends EventEmitter {\r\n  constructor(document, options) {\r\n    super();\r\n    this.document = document;\r\n    this.indent = options.indent || 0;\r\n    this.characterSpacing = options.characterSpacing || 0;\r\n    this.wordSpacing = options.wordSpacing === 0;\r\n    this.columns = options.columns || 1;\r\n    this.columnGap = options.columnGap != null ? options.columnGap : 18; // 1/4 inch\r\n    this.lineWidth =\r\n      (options.width - this.columnGap * (this.columns - 1)) / this.columns;\r\n    this.spaceLeft = this.lineWidth;\r\n    this.startX = this.document.x;\r\n    this.startY = this.document.y;\r\n    this.column = 1;\r\n    this.ellipsis = options.ellipsis;\r\n    this.continuedX = 0;\r\n    this.features = options.features;\r\n\r\n    // calculate the maximum Y position the text can appear at\r\n    if (options.height != null) {\r\n      this.height = options.height;\r\n      this.maxY = this.startY + options.height;\r\n    } else {\r\n      this.maxY = this.document.page.maxY();\r\n    }\r\n\r\n    // handle paragraph indents\r\n    this.on('firstLine', options => {\r\n      // if this is the first line of the text segment, and\r\n      // we're continuing where we left off, indent that much\r\n      // otherwise use the user specified indent option\r\n      const indent = this.continuedX || this.indent;\r\n      this.document.x += indent;\r\n      this.lineWidth -= indent;\r\n\r\n      return this.once('line', () => {\r\n        this.document.x -= indent;\r\n        this.lineWidth += indent;\r\n        if (options.continued && !this.continuedX) {\r\n          this.continuedX = this.indent;\r\n        }\r\n        if (!options.continued) {\r\n          return (this.continuedX = 0);\r\n        }\r\n      });\r\n    });\r\n\r\n    // handle left aligning last lines of paragraphs\r\n    this.on('lastLine', options => {\r\n      const { align } = options;\r\n      if (align === 'justify') {\r\n        options.align = 'left';\r\n      }\r\n      this.lastLine = true;\r\n\r\n      return this.once('line', () => {\r\n        this.document.y += options.paragraphGap || 0;\r\n        options.align = align;\r\n        return (this.lastLine = false);\r\n      });\r\n    });\r\n  }\r\n\r\n  wordWidth(word) {\r\n    return (\r\n      this.document.widthOfString(word, this) +\r\n      this.characterSpacing +\r\n      this.wordSpacing\r\n    );\r\n  }\r\n\r\n  canFit(word, w) {\r\n    if (word[word.length - 1] != SOFT_HYPHEN) {\r\n      return w <= this.spaceLeft;\r\n    }\r\n    return w + this.wordWidth(HYPHEN) <= this.spaceLeft;\r\n  }\r\n\r\n  eachWord(text, fn) {\r\n    // setup a unicode line breaker\r\n    let bk;\r\n    const breaker = new LineBreaker(text);\r\n    let last = null;\r\n    const wordWidths = Object.create(null);\r\n\r\n    while ((bk = breaker.nextBreak())) {\r\n      var shouldContinue;\r\n      let word = text.slice(\r\n        (last != null ? last.position : undefined) || 0,\r\n        bk.position\r\n      );\r\n      let w =\r\n        wordWidths[word] != null\r\n          ? wordWidths[word]\r\n          : (wordWidths[word] = this.wordWidth(word));\r\n\r\n      // if the word is longer than the whole line, chop it up\r\n      // TODO: break by grapheme clusters, not JS string characters\r\n      if (w > this.lineWidth + this.continuedX) {\r\n        // make some fake break objects\r\n        let lbk = last;\r\n        const fbk = {};\r\n\r\n        while (word.length) {\r\n          // fit as much of the word as possible into the space we have\r\n          var l, mightGrow;\r\n          if (w > this.spaceLeft) {\r\n            // start our check at the end of our available space - this method is faster than a loop of each character and it resolves\r\n            // an issue with long loops when processing massive words, such as a huge number of spaces\r\n            l = Math.ceil(this.spaceLeft / (w / word.length));\r\n            w = this.wordWidth(word.slice(0, l));\r\n            mightGrow = w <= this.spaceLeft && l < word.length;\r\n          } else {\r\n            l = word.length;\r\n          }\r\n          let mustShrink = w > this.spaceLeft && l > 0;\r\n          // shrink or grow word as necessary after our near-guess above\r\n          while (mustShrink || mightGrow) {\r\n            if (mustShrink) {\r\n              w = this.wordWidth(word.slice(0, --l));\r\n              mustShrink = w > this.spaceLeft && l > 0;\r\n            } else {\r\n              w = this.wordWidth(word.slice(0, ++l));\r\n              mustShrink = w > this.spaceLeft && l > 0;\r\n              mightGrow = w <= this.spaceLeft && l < word.length;\r\n            }\r\n          }\r\n\r\n          // check for the edge case where a single character cannot fit into a line.\r\n          if (l === 0 && this.spaceLeft === this.lineWidth) {\r\n            l = 1;\r\n          }\r\n\r\n          // send a required break unless this is the last piece and a linebreak is not specified\r\n          fbk.required = bk.required || l < word.length;\r\n          shouldContinue = fn(word.slice(0, l), w, fbk, lbk);\r\n          lbk = { required: false };\r\n\r\n          // get the remaining piece of the word\r\n          word = word.slice(l);\r\n          w = this.wordWidth(word);\r\n\r\n          if (shouldContinue === false) {\r\n            break;\r\n          }\r\n        }\r\n      } else {\r\n        // otherwise just emit the break as it was given to us\r\n        shouldContinue = fn(word, w, bk, last);\r\n      }\r\n\r\n      if (shouldContinue === false) {\r\n        break;\r\n      }\r\n      last = bk;\r\n    }\r\n  }\r\n\r\n  wrap(text, options) {\r\n    // override options from previous continued fragments\r\n    if (options.indent != null) {\r\n      this.indent = options.indent;\r\n    }\r\n    if (options.characterSpacing != null) {\r\n      this.characterSpacing = options.characterSpacing;\r\n    }\r\n    if (options.wordSpacing != null) {\r\n      this.wordSpacing = options.wordSpacing;\r\n    }\r\n    if (options.ellipsis != null) {\r\n      this.ellipsis = options.ellipsis;\r\n    }\r\n\r\n    // make sure we're actually on the page\r\n    // and that the first line of is never by\r\n    // itself at the bottom of a page (orphans)\r\n    const nextY = this.document.y + this.document.currentLineHeight(true);\r\n    if (this.document.y > this.maxY || nextY > this.maxY) {\r\n      this.nextSection();\r\n    }\r\n\r\n    let buffer = '';\r\n    let textWidth = 0;\r\n    let wc = 0;\r\n    let lc = 0;\r\n\r\n    let { y } = this.document; // used to reset Y pos if options.continued (below)\r\n    const emitLine = () => {\r\n      options.textWidth = textWidth + this.wordSpacing * (wc - 1);\r\n      options.wordCount = wc;\r\n      options.lineWidth = this.lineWidth;\r\n      ({ y } = this.document);\r\n      this.emit('line', buffer, options, this);\r\n      return lc++;\r\n    };\r\n\r\n    this.emit('sectionStart', options, this);\r\n\r\n    this.eachWord(text, (word, w, bk, last) => {\r\n      if (last == null || last.required) {\r\n        this.emit('firstLine', options, this);\r\n        this.spaceLeft = this.lineWidth;\r\n      }\r\n\r\n      if (this.canFit(word, w)) {\r\n        buffer += word;\r\n        textWidth += w;\r\n        wc++;\r\n      }\r\n\r\n      if (bk.required || !this.canFit(word, w)) {\r\n        // if the user specified a max height and an ellipsis, and is about to pass the\r\n        // max height and max columns after the next line, append the ellipsis\r\n        const lh = this.document.currentLineHeight(true);\r\n        if (\r\n          this.height != null &&\r\n          this.ellipsis &&\r\n          this.document.y + lh * 2 > this.maxY &&\r\n          this.column >= this.columns\r\n        ) {\r\n          if (this.ellipsis === true) {\r\n            this.ellipsis = '';\r\n          } // map default ellipsis character\r\n          buffer = buffer.replace(/\\s+$/, '');\r\n          textWidth = this.wordWidth(buffer + this.ellipsis);\r\n\r\n          // remove characters from the buffer until the ellipsis fits\r\n          // to avoid infinite loop need to stop while-loop if buffer is empty string\r\n          while (buffer && textWidth > this.lineWidth) {\r\n            buffer = buffer.slice(0, -1).replace(/\\s+$/, '');\r\n            textWidth = this.wordWidth(buffer + this.ellipsis);\r\n          }\r\n          // need to add ellipsis only if there is enough space for it\r\n          if (textWidth <= this.lineWidth) {\r\n            buffer = buffer + this.ellipsis;\r\n          }\r\n\r\n          textWidth = this.wordWidth(buffer);\r\n        }\r\n\r\n        if (bk.required) {\r\n          if (w > this.spaceLeft) {\r\n            emitLine();\r\n            buffer = word;\r\n            textWidth = w;\r\n            wc = 1;\r\n          }\r\n\r\n          this.emit('lastLine', options, this);\r\n        }\r\n\r\n        // Previous entry is a soft hyphen - add visible hyphen.\r\n        if (buffer[buffer.length - 1] == SOFT_HYPHEN) {\r\n          buffer = buffer.slice(0, -1) + HYPHEN;\r\n          this.spaceLeft -= this.wordWidth(HYPHEN);\r\n        }\r\n\r\n        emitLine();\r\n\r\n        // if we've reached the edge of the page,\r\n        // continue on a new page or column\r\n        if (this.document.y + lh > this.maxY) {\r\n          const shouldContinue = this.nextSection();\r\n\r\n          // stop if we reached the maximum height\r\n          if (!shouldContinue) {\r\n            wc = 0;\r\n            buffer = '';\r\n            return false;\r\n          }\r\n        }\r\n\r\n        // reset the space left and buffer\r\n        if (bk.required) {\r\n          this.spaceLeft = this.lineWidth;\r\n          buffer = '';\r\n          textWidth = 0;\r\n          return (wc = 0);\r\n        } else {\r\n          // reset the space left and buffer\r\n          this.spaceLeft = this.lineWidth - w;\r\n          buffer = word;\r\n          textWidth = w;\r\n          return (wc = 1);\r\n        }\r\n      } else {\r\n        return (this.spaceLeft -= w);\r\n      }\r\n    });\r\n\r\n    if (wc > 0) {\r\n      this.emit('lastLine', options, this);\r\n      emitLine();\r\n    }\r\n\r\n    this.emit('sectionEnd', options, this);\r\n\r\n    // if the wrap is set to be continued, save the X position\r\n    // to start the first line of the next segment at, and reset\r\n    // the y position\r\n    if (options.continued === true) {\r\n      if (lc > 1) {\r\n        this.continuedX = 0;\r\n      }\r\n      this.continuedX += options.textWidth || 0;\r\n      return (this.document.y = y);\r\n    } else {\r\n      return (this.document.x = this.startX);\r\n    }\r\n  }\r\n\r\n  nextSection(options) {\r\n    this.emit('sectionEnd', options, this);\r\n\r\n    if (++this.column > this.columns) {\r\n      // if a max height was specified by the user, we're done.\r\n      // otherwise, the default is to make a new page at the bottom.\r\n      if (this.height != null) {\r\n        return false;\r\n      }\r\n\r\n      this.document.continueOnNewPage();\r\n      this.column = 1;\r\n      this.startY = this.document.page.margins.top;\r\n      this.maxY = this.document.page.maxY();\r\n      this.document.x = this.startX;\r\n      if (this.document._fillColor) {\r\n        this.document.fillColor(...this.document._fillColor);\r\n      }\r\n      this.emit('pageBreak', options, this);\r\n    } else {\r\n      this.document.x += this.lineWidth + this.columnGap;\r\n      this.document.y = this.startY;\r\n      this.emit('columnBreak', options, this);\r\n    }\r\n\r\n    this.emit('sectionStart', options, this);\r\n    return true;\r\n  }\r\n}\r\n\r\nexport default LineWrapper;\r\n","import LineWrapper from '../line_wrapper';\r\nimport PDFObject from '../object';\r\n\r\nconst { number } = PDFObject;\r\n\r\nexport default {\r\n  initText() {\r\n    this._line = this._line.bind(this);\r\n    // Current coordinates\r\n    this.x = 0;\r\n    this.y = 0;\r\n    return (this._lineGap = 0);\r\n  },\r\n\r\n  lineGap(_lineGap) {\r\n    this._lineGap = _lineGap;\r\n    return this;\r\n  },\r\n\r\n  moveDown(lines) {\r\n    if (lines == null) {\r\n      lines = 1;\r\n    }\r\n    this.y += this.currentLineHeight(true) * lines + this._lineGap;\r\n    return this;\r\n  },\r\n\r\n  moveUp(lines) {\r\n    if (lines == null) {\r\n      lines = 1;\r\n    }\r\n    this.y -= this.currentLineHeight(true) * lines + this._lineGap;\r\n    return this;\r\n  },\r\n\r\n  _text(text, x, y, options, lineCallback) {\r\n    options = this._initOptions(x, y, options);\r\n\r\n    // Convert text to a string\r\n    text = text == null ? '' : `${text}`;\r\n\r\n    // if the wordSpacing option is specified, remove multiple consecutive spaces\r\n    if (options.wordSpacing) {\r\n      text = text.replace(/\\s{2,}/g, ' ');\r\n    }\r\n\r\n    const addStructure = () => {\r\n      if (options.structParent) {\r\n        options.structParent.add(this.struct(options.structType || 'P',\r\n          [ this.markStructureContent(options.structType || 'P') ]));\r\n      }\r\n    };\r\n\r\n    // word wrapping\r\n    if (options.width) {\r\n      let wrapper = this._wrapper;\r\n      if (!wrapper) {\r\n        wrapper = new LineWrapper(this, options);\r\n        wrapper.on('line', lineCallback);\r\n        wrapper.on('firstLine', addStructure);\r\n      }\r\n\r\n      this._wrapper = options.continued ? wrapper : null;\r\n      this._textOptions = options.continued ? options : null;\r\n      wrapper.wrap(text, options);\r\n\r\n      // render paragraphs as single lines\r\n    } else {\r\n      for (let line of text.split('\\n')) {\r\n        addStructure();\r\n        lineCallback(line, options);\r\n      }\r\n    }\r\n\r\n    return this;\r\n  },\r\n\r\n  text(text, x, y, options) {\r\n    return this._text(text, x, y, options, this._line);\r\n  },\r\n\r\n  widthOfString(string, options = {}) {\r\n    return (\r\n      this._font.widthOfString(string, this._fontSize, options.features) +\r\n      (options.characterSpacing || 0) * (string.length - 1)\r\n    );\r\n  },\r\n\r\n  heightOfString(text, options) {\r\n    const { x, y } = this;\r\n\r\n    options = this._initOptions(options);\r\n    options.height = Infinity; // don't break pages\r\n\r\n    const lineGap = options.lineGap || this._lineGap || 0;\r\n    this._text(text, this.x, this.y, options, () => {\r\n      return (this.y += this.currentLineHeight(true) + lineGap);\r\n    });\r\n\r\n    const height = this.y - y;\r\n    this.x = x;\r\n    this.y = y;\r\n\r\n    return height;\r\n  },\r\n\r\n  list(list, x, y, options, wrapper) {\r\n    options = this._initOptions(x, y, options);\r\n\r\n    const listType = options.listType || 'bullet';\r\n    const unit = Math.round((this._font.ascender / 1000) * this._fontSize);\r\n    const midLine = unit / 2;\r\n    const r = options.bulletRadius || unit / 3;\r\n    const indent =\r\n      options.textIndent || (listType === 'bullet' ? r * 5 : unit * 2);\r\n    const itemIndent =\r\n      options.bulletIndent || (listType === 'bullet' ? r * 8 : unit * 2);\r\n\r\n    let level = 1;\r\n    const items = [];\r\n    const levels = [];\r\n    const numbers = [];\r\n\r\n    var flatten = function(list) {\r\n      let n = 1;\r\n      for (let i = 0; i < list.length; i++) {\r\n        const item = list[i];\r\n        if (Array.isArray(item)) {\r\n          level++;\r\n          flatten(item);\r\n          level--;\r\n        } else {\r\n          items.push(item);\r\n          levels.push(level);\r\n          if (listType !== 'bullet') {\r\n            numbers.push(n++);\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    flatten(list);\r\n\r\n    const label = function(n) {\r\n      switch (listType) {\r\n        case 'numbered':\r\n          return `${n}.`;\r\n        case 'lettered':\r\n          var letter = String.fromCharCode(((n - 1) % 26) + 65);\r\n          var times = Math.floor((n - 1) / 26 + 1);\r\n          var text = Array(times + 1).join(letter);\r\n          return `${text}.`;\r\n      }\r\n    };\r\n\r\n    const drawListItem = function(listItem) {\r\n      wrapper = new LineWrapper(this, options);\r\n      wrapper.on('line', this._line);\r\n\r\n      level = 1;\r\n      let i = 0;\r\n      wrapper.once('firstLine', () => {\r\n        let item, itemType, labelType, bodyType;\r\n        if (options.structParent) {\r\n          if (options.structTypes) {\r\n            [itemType, labelType, bodyType] = options.structTypes;\r\n          } else {\r\n            [itemType, labelType, bodyType] = ['LI', 'Lbl', 'LBody'];\r\n          }\r\n        }\r\n\r\n        if (itemType) {\r\n          item = this.struct(itemType);\r\n          options.structParent.add(item);\r\n        } else if (options.structParent) {\r\n          item = options.structParent;\r\n        }\r\n\r\n        let l;\r\n        if ((l = levels[i++]) !== level) {\r\n          const diff = itemIndent * (l - level);\r\n          this.x += diff;\r\n          wrapper.lineWidth -= diff;\r\n          level = l;\r\n        }\r\n\r\n        if (item && (labelType || bodyType)) {\r\n          item.add(this.struct(labelType || bodyType,\r\n            [this.markStructureContent(labelType || bodyType)]));\r\n        }\r\n        switch (listType) {\r\n          case 'bullet':\r\n            this.circle(this.x - indent + r, this.y + midLine, r);\r\n            this.fill();\r\n            break;\r\n          case 'numbered':\r\n          case 'lettered':\r\n            var text = label(numbers[i - 1]);\r\n            this._fragment(text, this.x - indent, this.y, options);\r\n            break;\r\n        }\r\n\r\n        if (item && labelType && bodyType) {\r\n          item.add(this.struct(bodyType, [this.markStructureContent(bodyType)]));\r\n        }\r\n        if (item && item !== options.structParent) {\r\n          item.end();\r\n        }\r\n      });\r\n\r\n      wrapper.on('sectionStart', () => {\r\n        const pos = indent + itemIndent * (level - 1);\r\n        this.x += pos;\r\n        return (wrapper.lineWidth -= pos);\r\n      });\r\n\r\n      wrapper.on('sectionEnd', () => {\r\n        const pos = indent + itemIndent * (level - 1);\r\n        this.x -= pos;\r\n        return (wrapper.lineWidth += pos);\r\n      });\r\n\r\n      wrapper.wrap(listItem, options);\r\n    };\r\n\r\n\r\n    for (let i = 0; i < items.length; i++) {\r\n      drawListItem.call(this, items[i]);\r\n    }\r\n\r\n    return this;\r\n  },\r\n\r\n  _initOptions(x = {}, y, options = {}) {\r\n    if (typeof x === 'object') {\r\n      options = x;\r\n      x = null;\r\n    }\r\n\r\n    // clone options object\r\n    const result = Object.assign({}, options);\r\n\r\n    // extend options with previous values for continued text\r\n    if (this._textOptions) {\r\n      for (let key in this._textOptions) {\r\n        const val = this._textOptions[key];\r\n        if (key !== 'continued') {\r\n          if (result[key] === undefined) {\r\n            result[key] = val;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    // Update the current position\r\n    if (x != null) {\r\n      this.x = x;\r\n    }\r\n    if (y != null) {\r\n      this.y = y;\r\n    }\r\n\r\n    // wrap to margins if no x or y position passed\r\n    if (result.lineBreak !== false) {\r\n      if (result.width == null) {\r\n        result.width = this.page.width - this.x - this.page.margins.right;\r\n      }\r\n      result.width = Math.max(result.width, 0);\r\n    }\r\n\r\n    if (!result.columns) {\r\n      result.columns = 0;\r\n    }\r\n    if (result.columnGap == null) {\r\n      result.columnGap = 18;\r\n    } // 1/4 inch\r\n\r\n    return result;\r\n  },\r\n\r\n  _line(text, options = {}, wrapper) {\r\n    this._fragment(text, this.x, this.y, options);\r\n    const lineGap = options.lineGap || this._lineGap || 0;\r\n\r\n    if (!wrapper) {\r\n      return (this.x += this.widthOfString(text));\r\n    } else {\r\n      return (this.y += this.currentLineHeight(true) + lineGap);\r\n    }\r\n  },\r\n\r\n  _fragment(text, x, y, options) {\r\n    let dy, encoded, i, positions, textWidth, words;\r\n    text = `${text}`.replace(/\\n/g, '');\r\n    if (text.length === 0) {\r\n      return;\r\n    }\r\n\r\n    // handle options\r\n    const align = options.align || 'left';\r\n    let wordSpacing = options.wordSpacing || 0;\r\n    const characterSpacing = options.characterSpacing || 0;\r\n\r\n    // text alignments\r\n    if (options.width) {\r\n      switch (align) {\r\n        case 'right':\r\n          textWidth = this.widthOfString(text.replace(/\\s+$/, ''), options);\r\n          x += options.lineWidth - textWidth;\r\n          break;\r\n\r\n        case 'center':\r\n          x += options.lineWidth / 2 - options.textWidth / 2;\r\n          break;\r\n\r\n        case 'justify':\r\n          // calculate the word spacing value\r\n          words = text.trim().split(/\\s+/);\r\n          textWidth = this.widthOfString(text.replace(/\\s+/g, ''), options);\r\n          var spaceWidth = this.widthOfString(' ') + characterSpacing;\r\n          wordSpacing = Math.max(\r\n            0,\r\n            (options.lineWidth - textWidth) / Math.max(1, words.length - 1) -\r\n              spaceWidth\r\n          );\r\n          break;\r\n      }\r\n    }\r\n\r\n    // text baseline alignments based on http://wiki.apache.org/xmlgraphics-fop/LineLayout/AlignmentHandling\r\n    if (typeof options.baseline === 'number') {\r\n      dy = -options.baseline;\r\n    } else {\r\n      switch (options.baseline) {\r\n        case 'svg-middle':\r\n          dy = 0.5 * this._font.xHeight;\r\n          break;\r\n        case 'middle':\r\n        case 'svg-central':\r\n          dy = 0.5 * (this._font.descender + this._font.ascender);\r\n          break;\r\n        case 'bottom':\r\n        case 'ideographic':\r\n          dy = this._font.descender;\r\n          break;\r\n        case 'alphabetic':\r\n          dy = 0;\r\n          break;\r\n        case 'mathematical':\r\n          dy = 0.5 * this._font.ascender;\r\n          break;\r\n        case 'hanging':\r\n          dy = 0.8 * this._font.ascender;\r\n          break;\r\n        case 'top':\r\n          dy = this._font.ascender;\r\n          break;\r\n        default:\r\n          dy = this._font.ascender;\r\n      }\r\n      dy = (dy / 1000) * this._fontSize;\r\n    }\r\n\r\n    // calculate the actual rendered width of the string after word and character spacing\r\n    const renderedWidth =\r\n      options.textWidth +\r\n      wordSpacing * (options.wordCount - 1) +\r\n      characterSpacing * (text.length - 1);\r\n\r\n    // create link annotations if the link option is given\r\n    if (options.link != null) {\r\n      this.link(x, y, renderedWidth, this.currentLineHeight(), options.link);\r\n    }\r\n    if (options.goTo != null) {\r\n      this.goTo(x, y, renderedWidth, this.currentLineHeight(), options.goTo);\r\n    }\r\n    if (options.destination != null) {\r\n      this.addNamedDestination(options.destination, 'XYZ', x, y, null);\r\n    }\r\n\r\n    // create underline\r\n    if (options.underline) {\r\n      this.save();\r\n      if (!options.stroke) {\r\n        this.strokeColor(...(this._fillColor || []));\r\n      }\r\n\r\n      const lineWidth =\r\n        this._fontSize < 10 ? 0.5 : Math.floor(this._fontSize / 10);\r\n      this.lineWidth(lineWidth);\r\n\r\n      let lineY = (y + this.currentLineHeight())  - lineWidth\r\n      this.moveTo(x, lineY);\r\n      this.lineTo(x + renderedWidth, lineY);\r\n      this.stroke();\r\n      this.restore();\r\n    }\r\n    \r\n    // create strikethrough line\r\n    if (options.strike) {\r\n      this.save();\r\n      if (!options.stroke) {\r\n        this.strokeColor(...(this._fillColor || []));\r\n      }\r\n\r\n      const lineWidth =\r\n        this._fontSize < 10 ? 0.5 : Math.floor(this._fontSize / 10);\r\n      this.lineWidth(lineWidth);\r\n\r\n      let lineY = y + this.currentLineHeight() / 2;\r\n      this.moveTo(x, lineY);\r\n      this.lineTo(x + renderedWidth, lineY);\r\n      this.stroke();\r\n      this.restore();\r\n    }\r\n\r\n    this.save();\r\n\r\n    // oblique (angle in degrees or boolean)\r\n    if (options.oblique) {\r\n      let skew;\r\n      if (typeof options.oblique === 'number') {\r\n        skew = -Math.tan((options.oblique * Math.PI) / 180);\r\n      } else {\r\n        skew = -0.25;\r\n      }\r\n      this.transform(1, 0, 0, 1, x, y);\r\n      this.transform(1, 0, skew, 1, -skew * dy, 0);\r\n      this.transform(1, 0, 0, 1, -x, -y);\r\n    }\r\n\r\n    // flip coordinate system\r\n    this.transform(1, 0, 0, -1, 0, this.page.height);\r\n    y = this.page.height - y - dy;\r\n\r\n    // add current font to page if necessary\r\n    if (this.page.fonts[this._font.id] == null) {\r\n      this.page.fonts[this._font.id] = this._font.ref();\r\n    }\r\n\r\n    // begin the text object\r\n    this.addContent('BT');\r\n\r\n    // text position\r\n    this.addContent(`1 0 0 1 ${number(x)} ${number(y)} Tm`);\r\n\r\n    // font and font size\r\n    this.addContent(`/${this._font.id} ${number(this._fontSize)} Tf`);\r\n\r\n    // rendering mode\r\n    const mode = options.fill && options.stroke ? 2 : options.stroke ? 1 : 0;\r\n    if (mode) {\r\n      this.addContent(`${mode} Tr`);\r\n    }\r\n\r\n    // Character spacing\r\n    if (characterSpacing) {\r\n      this.addContent(`${number(characterSpacing)} Tc`);\r\n    }\r\n\r\n    // Add the actual text\r\n    // If we have a word spacing value, we need to encode each word separately\r\n    // since the normal Tw operator only works on character code 32, which isn't\r\n    // used for embedded fonts.\r\n    if (wordSpacing) {\r\n      words = text.trim().split(/\\s+/);\r\n      wordSpacing += this.widthOfString(' ') + characterSpacing;\r\n      wordSpacing *= 1000 / this._fontSize;\r\n\r\n      encoded = [];\r\n      positions = [];\r\n      for (let word of words) {\r\n        const [encodedWord, positionsWord] = this._font.encode(\r\n          word,\r\n          options.features\r\n        );\r\n        encoded = encoded.concat(encodedWord);\r\n        positions = positions.concat(positionsWord);\r\n\r\n        // add the word spacing to the end of the word\r\n        // clone object because of cache\r\n        const space = {};\r\n        const object = positions[positions.length - 1];\r\n        for (let key in object) {\r\n          const val = object[key];\r\n          space[key] = val;\r\n        }\r\n        space.xAdvance += wordSpacing;\r\n        positions[positions.length - 1] = space;\r\n      }\r\n    } else {\r\n      [encoded, positions] = this._font.encode(text, options.features);\r\n    }\r\n\r\n    const scale = this._fontSize / 1000;\r\n    const commands = [];\r\n    let last = 0;\r\n    let hadOffset = false;\r\n\r\n    // Adds a segment of text to the TJ command buffer\r\n    const addSegment = cur => {\r\n      if (last < cur) {\r\n        const hex = encoded.slice(last, cur).join('');\r\n        const advance =\r\n          positions[cur - 1].xAdvance - positions[cur - 1].advanceWidth;\r\n        commands.push(`<${hex}> ${number(-advance)}`);\r\n      }\r\n\r\n      return (last = cur);\r\n    };\r\n\r\n    // Flushes the current TJ commands to the output stream\r\n    const flush = i => {\r\n      addSegment(i);\r\n\r\n      if (commands.length > 0) {\r\n        this.addContent(`[${commands.join(' ')}] TJ`);\r\n        return (commands.length = 0);\r\n      }\r\n    };\r\n\r\n    for (i = 0; i < positions.length; i++) {\r\n      // If we have an x or y offset, we have to break out of the current TJ command\r\n      // so we can move the text position.\r\n      const pos = positions[i];\r\n      if (pos.xOffset || pos.yOffset) {\r\n        // Flush the current buffer\r\n        flush(i);\r\n\r\n        // Move the text position and flush just the current character\r\n        this.addContent(\r\n          `1 0 0 1 ${number(x + pos.xOffset * scale)} ${number(\r\n            y + pos.yOffset * scale\r\n          )} Tm`\r\n        );\r\n        flush(i + 1);\r\n\r\n        hadOffset = true;\r\n      } else {\r\n        // If the last character had an offset, reset the text position\r\n        if (hadOffset) {\r\n          this.addContent(`1 0 0 1 ${number(x)} ${number(y)} Tm`);\r\n          hadOffset = false;\r\n        }\r\n\r\n        // Group segments that don't have any advance adjustments\r\n        if (pos.xAdvance - pos.advanceWidth !== 0) {\r\n          addSegment(i + 1);\r\n        }\r\n      }\r\n\r\n      x += pos.xAdvance * scale;\r\n    }\r\n\r\n    // Flush any remaining commands\r\n    flush(i);\r\n\r\n    // end the text object\r\n    this.addContent('ET');\r\n\r\n    // restore flipped coordinate system\r\n    return this.restore();\r\n  }\r\n};\r\n","import exif from 'jpeg-exif';\r\n\r\nconst MARKERS = [\r\n  0xffc0,\r\n  0xffc1,\r\n  0xffc2,\r\n  0xffc3,\r\n  0xffc5,\r\n  0xffc6,\r\n  0xffc7,\r\n  0xffc8,\r\n  0xffc9,\r\n  0xffca,\r\n  0xffcb,\r\n  0xffcc,\r\n  0xffcd,\r\n  0xffce,\r\n  0xffcf\r\n];\r\n\r\nconst COLOR_SPACE_MAP = {\r\n  1: 'DeviceGray',\r\n  3: 'DeviceRGB',\r\n  4: 'DeviceCMYK'\r\n};\r\n\r\nclass JPEG {\r\n  constructor(data, label) {\r\n    let marker;\r\n    this.data = data;\r\n    this.label = label;\r\n    if (this.data.readUInt16BE(0) !== 0xffd8) {\r\n      throw 'SOI not found in JPEG';\r\n    }\r\n\r\n    // Parse the EXIF orientation\r\n    this.orientation = exif.fromBuffer(this.data).Orientation || 1;\r\n\r\n    let pos = 2;\r\n    while (pos < this.data.length) {\r\n      marker = this.data.readUInt16BE(pos);\r\n      pos += 2;\r\n      if (MARKERS.includes(marker)) {\r\n        break;\r\n      }\r\n      pos += this.data.readUInt16BE(pos);\r\n    }\r\n\r\n    if (!MARKERS.includes(marker)) {\r\n      throw 'Invalid JPEG.';\r\n    }\r\n    pos += 2;\r\n\r\n    this.bits = this.data[pos++];\r\n    this.height = this.data.readUInt16BE(pos);\r\n    pos += 2;\r\n\r\n    this.width = this.data.readUInt16BE(pos);\r\n    pos += 2;\r\n\r\n    const channels = this.data[pos++];\r\n    this.colorSpace = COLOR_SPACE_MAP[channels];\r\n\r\n    this.obj = null;\r\n  }\r\n\r\n  embed(document) {\r\n    if (this.obj) {\r\n      return;\r\n    }\r\n\r\n    this.obj = document.ref({\r\n      Type: 'XObject',\r\n      Subtype: 'Image',\r\n      BitsPerComponent: this.bits,\r\n      Width: this.width,\r\n      Height: this.height,\r\n      ColorSpace: this.colorSpace,\r\n      Filter: 'DCTDecode'\r\n    });\r\n\r\n    // add extra decode params for CMYK images. By swapping the\r\n    // min and max values from the default, we invert the colors. See\r\n    // section 4.8.4 of the spec.\r\n    if (this.colorSpace === 'DeviceCMYK') {\r\n      this.obj.data['Decode'] = [1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0];\r\n    }\r\n\r\n    this.obj.end(this.data);\r\n\r\n    // free memory\r\n    return (this.data = null);\r\n  }\r\n}\r\n\r\nexport default JPEG;\r\n","import zlib from 'zlib';\r\nimport PNG from 'png-js';\r\n\r\nclass PNGImage {\r\n  constructor(data, label) {\r\n    this.label = label;\r\n    this.image = new PNG(data);\r\n    this.width = this.image.width;\r\n    this.height = this.image.height;\r\n    this.imgData = this.image.imgData;\r\n    this.obj = null;\r\n  }\r\n\r\n  embed(document) {\r\n    let dataDecoded = false;\r\n\r\n    this.document = document;\r\n    if (this.obj) {\r\n      return;\r\n    }\r\n\r\n    const hasAlphaChannel = this.image.hasAlphaChannel;\r\n    const isInterlaced = this.image.interlaceMethod === 1;\r\n\r\n    this.obj = this.document.ref({\r\n      Type: 'XObject',\r\n      Subtype: 'Image',\r\n      BitsPerComponent: hasAlphaChannel ? 8 : this.image.bits,\r\n      Width: this.width,\r\n      Height: this.height,\r\n      Filter: 'FlateDecode'\r\n    });\r\n\r\n    if (!hasAlphaChannel) {\r\n      const params = this.document.ref({\r\n        Predictor: isInterlaced ? 1 : 15,\r\n        Colors: this.image.colors,\r\n        BitsPerComponent: this.image.bits,\r\n        Columns: this.width\r\n      });\r\n\r\n      this.obj.data['DecodeParms'] = params;\r\n      params.end();\r\n    }\r\n\r\n    if (this.image.palette.length === 0) {\r\n      this.obj.data['ColorSpace'] = this.image.colorSpace;\r\n    } else {\r\n      // embed the color palette in the PDF as an object stream\r\n      const palette = this.document.ref();\r\n      palette.end(Buffer.from(this.image.palette));\r\n\r\n      // build the color space array for the image\r\n      this.obj.data['ColorSpace'] = [\r\n        'Indexed',\r\n        'DeviceRGB',\r\n        this.image.palette.length / 3 - 1,\r\n        palette\r\n      ];\r\n    }\r\n\r\n    // For PNG color types 0, 2 and 3, the transparency data is stored in\r\n    // a dedicated PNG chunk.\r\n    if (this.image.transparency.grayscale != null) {\r\n      // Use Color Key Masking (spec section 4.8.5)\r\n      // An array with N elements, where N is two times the number of color components.\r\n      const val = this.image.transparency.grayscale;\r\n      this.obj.data['Mask'] = [val, val];\r\n    } else if (this.image.transparency.rgb) {\r\n      // Use Color Key Masking (spec section 4.8.5)\r\n      // An array with N elements, where N is two times the number of color components.\r\n      const { rgb } = this.image.transparency;\r\n      const mask = [];\r\n      for (let x of rgb) {\r\n        mask.push(x, x);\r\n      }\r\n\r\n      this.obj.data['Mask'] = mask;\r\n    } else if (this.image.transparency.indexed) {\r\n      // Create a transparency SMask for the image based on the data\r\n      // in the PLTE and tRNS sections. See below for details on SMasks.\r\n      dataDecoded = true;\r\n      return this.loadIndexedAlphaChannel();\r\n    } else if (hasAlphaChannel) {\r\n      // For PNG color types 4 and 6, the transparency data is stored as a alpha\r\n      // channel mixed in with the main image data. Separate this data out into an\r\n      // SMask object and store it separately in the PDF.\r\n      dataDecoded = true;\r\n      return this.splitAlphaChannel();\r\n    }\r\n\r\n    if (isInterlaced && !dataDecoded) {\r\n      return this.decodeData();\r\n    }\r\n\r\n    this.finalize();\r\n  }\r\n\r\n  finalize() {\r\n    if (this.alphaChannel) {\r\n      const sMask = this.document.ref({\r\n        Type: 'XObject',\r\n        Subtype: 'Image',\r\n        Height: this.height,\r\n        Width: this.width,\r\n        BitsPerComponent: 8,\r\n        Filter: 'FlateDecode',\r\n        ColorSpace: 'DeviceGray',\r\n        Decode: [0, 1]\r\n      });\r\n\r\n      sMask.end(this.alphaChannel);\r\n      this.obj.data['SMask'] = sMask;\r\n    }\r\n\r\n    // add the actual image data\r\n    this.obj.end(this.imgData);\r\n\r\n    // free memory\r\n    this.image = null;\r\n    return (this.imgData = null);\r\n  }\r\n\r\n  splitAlphaChannel() {\r\n    return this.image.decodePixels(pixels => {\r\n      let a, p;\r\n      const colorCount = this.image.colors;\r\n      const pixelCount = this.width * this.height;\r\n      const imgData = Buffer.alloc(pixelCount * colorCount);\r\n      const alphaChannel = Buffer.alloc(pixelCount);\r\n\r\n      let i = (p = a = 0);\r\n      const len = pixels.length;\r\n      // For 16bit images copy only most significant byte (MSB) - PNG data is always stored in network byte order (MSB first)\r\n      const skipByteCount = this.image.bits === 16 ? 1 : 0;\r\n      while (i < len) {\r\n        for (let colorIndex = 0; colorIndex < colorCount; colorIndex++) {\r\n          imgData[p++] = pixels[i++];\r\n          i += skipByteCount;\r\n        }\r\n        alphaChannel[a++] = pixels[i++];\r\n        i += skipByteCount;\r\n      }\r\n\r\n      this.imgData = zlib.deflateSync(imgData);\r\n      this.alphaChannel = zlib.deflateSync(alphaChannel);\r\n      return this.finalize();\r\n    });\r\n  }\r\n\r\n  loadIndexedAlphaChannel() {\r\n    const transparency = this.image.transparency.indexed;\r\n    return this.image.decodePixels(pixels => {\r\n      const alphaChannel = Buffer.alloc(this.width * this.height);\r\n\r\n      let i = 0;\r\n      for (let j = 0, end = pixels.length; j < end; j++) {\r\n        alphaChannel[i++] = transparency[pixels[j]];\r\n      }\r\n\r\n      this.alphaChannel = zlib.deflateSync(alphaChannel);\r\n      return this.finalize();\r\n    });\r\n  }\r\n\r\n  decodeData() {\r\n    this.image.decodePixels(pixels => {\r\n      this.imgData = zlib.deflateSync(pixels);\r\n      this.finalize();\r\n    });\r\n  }\r\n}\r\n\r\nexport default PNGImage;\r\n","/*\r\nPDFImage - embeds images in PDF documents\r\nBy Devon Govett\r\n*/\r\n\r\nimport fs from 'fs';\r\nimport JPEG from './image/jpeg';\r\nimport PNG from './image/png';\r\n\r\nclass PDFImage {\r\n  static open(src, label) {\r\n    let data;\r\n    if (Buffer.isBuffer(src)) {\r\n      data = src;\r\n    } else if (src instanceof ArrayBuffer) {\r\n      data = Buffer.from(new Uint8Array(src));\r\n    } else {\r\n      let match;\r\n      if ((match = /^data:.+?;base64,(.*)$/.exec(src))) {\r\n        data = Buffer.from(match[1], 'base64');\r\n      } else {\r\n        data = fs.readFileSync(src);\r\n        if (!data) {\r\n          return;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (data[0] === 0xff && data[1] === 0xd8) {\r\n      return new JPEG(data, label);\r\n    } else if (data[0] === 0x89 && data.toString('ascii', 1, 4) === 'PNG') {\r\n      return new PNG(data, label);\r\n    } else {\r\n      throw new Error('Unknown image format.');\r\n    }\r\n  }\r\n}\r\n\r\nexport default PDFImage;\r\n","import PDFImage from '../image';\r\n\r\nexport default {\r\n  initImages() {\r\n    this._imageRegistry = {};\r\n    return (this._imageCount = 0);\r\n  },\r\n\r\n  image(src, x, y, options = {}) {\r\n    let bh, bp, bw, image, ip, left, left1, rotateAngle, originX, originY;\r\n    if (typeof x === 'object') {\r\n      options = x;\r\n      x = null;\r\n    }\r\n\r\n    // Ignore orientation based on document options or image options\r\n    const ignoreOrientation =\r\n      options.ignoreOrientation ||\r\n      (options.ignoreOrientation !== false && this.options.ignoreOrientation);\r\n\r\n    x = (left = x != null ? x : options.x) != null ? left : this.x;\r\n    y = (left1 = y != null ? y : options.y) != null ? left1 : this.y;\r\n\r\n    if (typeof src === 'string') {\r\n      image = this._imageRegistry[src];\r\n    }\r\n\r\n    if (!image) {\r\n      if (src.width && src.height) {\r\n        image = src;\r\n      } else {\r\n        image = this.openImage(src);\r\n      }\r\n    }\r\n\r\n    if (!image.obj) {\r\n      image.embed(this);\r\n    }\r\n\r\n    if (this.page.xobjects[image.label] == null) {\r\n      this.page.xobjects[image.label] = image.obj;\r\n    }\r\n\r\n    let { width, height } = image;\r\n\r\n    // If EXIF orientation calls for it, swap width and height\r\n    if (!ignoreOrientation && image.orientation > 4) {\r\n      [width, height] = [height, width];\r\n    }\r\n\r\n    let w = options.width || width;\r\n    let h = options.height || height;\r\n\r\n    if (options.width && !options.height) {\r\n      const wp = w / width;\r\n      w = width * wp;\r\n      h = height * wp;\r\n    } else if (options.height && !options.width) {\r\n      const hp = h / height;\r\n      w = width * hp;\r\n      h = height * hp;\r\n    } else if (options.scale) {\r\n      w = width * options.scale;\r\n      h = height * options.scale;\r\n    } else if (options.fit) {\r\n      [bw, bh] = options.fit;\r\n      bp = bw / bh;\r\n      ip = width / height;\r\n      if (ip > bp) {\r\n        w = bw;\r\n        h = bw / ip;\r\n      } else {\r\n        h = bh;\r\n        w = bh * ip;\r\n      }\r\n    } else if (options.cover) {\r\n      [bw, bh] = options.cover;\r\n      bp = bw / bh;\r\n      ip = width / height;\r\n      if (ip > bp) {\r\n        h = bh;\r\n        w = bh * ip;\r\n      } else {\r\n        w = bw;\r\n        h = bw / ip;\r\n      }\r\n    }\r\n\r\n    if (options.fit || options.cover) {\r\n      if (options.align === 'center') {\r\n        x = x + bw / 2 - w / 2;\r\n      } else if (options.align === 'right') {\r\n        x = x + bw - w;\r\n      }\r\n\r\n      if (options.valign === 'center') {\r\n        y = y + bh / 2 - h / 2;\r\n      } else if (options.valign === 'bottom') {\r\n        y = y + bh - h;\r\n      }\r\n    }\r\n\r\n    if (!ignoreOrientation) {\r\n      switch (image.orientation) {\r\n        // No orientation (need to flip image, though, because of the default transform matrix on the document)\r\n        default:\r\n        case 1:\r\n          h = -h;\r\n          y -= h;\r\n\r\n          rotateAngle = 0;\r\n          break;\r\n        // Flip Horizontal\r\n        case 2:\r\n          w = -w;\r\n          h = -h;\r\n          x -= w;\r\n          y -= h;\r\n\r\n          rotateAngle = 0;\r\n          break;\r\n        // Rotate 180 degrees\r\n        case 3:\r\n          originX = x;\r\n          originY = y;\r\n\r\n          h = -h;\r\n          x -= w;\r\n\r\n          rotateAngle = 180;\r\n          break;\r\n        // Flip vertical\r\n        case 4:\r\n          // Do nothing, image will be flipped\r\n\r\n          break;\r\n        // Flip horizontally and rotate 270 degrees CW\r\n        case 5:\r\n          originX = x;\r\n          originY = y;\r\n\r\n          [w, h] = [h, w];\r\n          y -= h;\r\n\r\n          rotateAngle = 90;\r\n          break;\r\n        // Rotate 90 degrees CW\r\n        case 6:\r\n          originX = x;\r\n          originY = y;\r\n\r\n          [w, h] = [h, w];\r\n          h = -h;\r\n\r\n          rotateAngle = 90;\r\n          break;\r\n        // Flip horizontally and rotate 90 degrees CW\r\n        case 7:\r\n          originX = x;\r\n          originY = y;\r\n\r\n          [w, h] = [h, w];\r\n          h = -h;\r\n          w = -w;\r\n          x -= w;\r\n\r\n          rotateAngle = 90;\r\n          break;\r\n        // Rotate 270 degrees CW\r\n        case 8:\r\n          originX = x;\r\n          originY = y;\r\n\r\n          [w, h] = [h, w];\r\n          h = -h;\r\n          x -= w;\r\n          y -= h;\r\n\r\n          rotateAngle = -90;\r\n          break;\r\n      }\r\n    } else {\r\n      h = -h;\r\n      y -= h;\r\n      rotateAngle = 0;\r\n    }\r\n\r\n    // create link annotations if the link option is given\r\n    if (options.link != null) {\r\n      this.link(x, y, w, h, options.link);\r\n    }\r\n    if (options.goTo != null) {\r\n      this.goTo(x, y, w, h, options.goTo);\r\n    }\r\n    if (options.destination != null) {\r\n      this.addNamedDestination(options.destination, 'XYZ', x, y, null);\r\n    }\r\n\r\n    // Set the current y position to below the image if it is in the document flow\r\n    if (this.y === y) {\r\n      this.y += h;\r\n    }\r\n\r\n    this.save();\r\n\r\n    if (rotateAngle) {\r\n      this.rotate(rotateAngle, {\r\n        origin: [originX, originY]\r\n      });\r\n    }\r\n\r\n    this.transform(w, 0, 0, h, x, y);\r\n    this.addContent(`/${image.label} Do`);\r\n    this.restore();\r\n\r\n    return this;\r\n  },\r\n\r\n  openImage(src) {\r\n    let image;\r\n    if (typeof src === 'string') {\r\n      image = this._imageRegistry[src];\r\n    }\r\n\r\n    if (!image) {\r\n      image = PDFImage.open(src, `I${++this._imageCount}`);\r\n      if (typeof src === 'string') {\r\n        this._imageRegistry[src] = image;\r\n      }\r\n    }\r\n\r\n    return image;\r\n  }\r\n};\r\n","export default {\r\n  annotate(x, y, w, h, options) {\r\n    options.Type = 'Annot';\r\n    options.Rect = this._convertRect(x, y, w, h);\r\n    options.Border = [0, 0, 0];\r\n\r\n    if (options.Subtype === 'Link' && typeof options.F === 'undefined') {\r\n      options.F = 1 << 2; // Print Annotation Flag\r\n    }\r\n\r\n    if (options.Subtype !== 'Link') {\r\n      if (options.C == null) {\r\n        options.C = this._normalizeColor(options.color || [0, 0, 0]);\r\n      }\r\n    } // convert colors\r\n    delete options.color;\r\n\r\n    if (typeof options.Dest === 'string') {\r\n      options.Dest = new String(options.Dest);\r\n    }\r\n\r\n    // Capitalize keys\r\n    for (let key in options) {\r\n      const val = options[key];\r\n      options[key[0].toUpperCase() + key.slice(1)] = val;\r\n    }\r\n\r\n    const ref = this.ref(options);\r\n    this.page.annotations.push(ref);\r\n    ref.end();\r\n    return this;\r\n  },\r\n\r\n  note(x, y, w, h, contents, options = {}) {\r\n    options.Subtype = 'Text';\r\n    options.Contents = new String(contents);\r\n    options.Name = 'Comment';\r\n    if (options.color == null) {\r\n      options.color = [243, 223, 92];\r\n    }\r\n    return this.annotate(x, y, w, h, options);\r\n  },\r\n\r\n  goTo(x, y, w, h, name, options = {}) {\r\n    options.Subtype = 'Link';\r\n    options.A = this.ref({\r\n      S: 'GoTo',\r\n      D: new String(name)\r\n    });\r\n    options.A.end();\r\n    return this.annotate(x, y, w, h, options);\r\n  },\r\n\r\n  link(x, y, w, h, url, options = {}) {\r\n    options.Subtype = 'Link';\r\n\r\n    if (typeof url === 'number') {\r\n      // Link to a page in the document (the page must already exist)\r\n      const pages = this._root.data.Pages.data;\r\n      if (url >= 0 && url < pages.Kids.length) {\r\n        options.A = this.ref({\r\n          S: 'GoTo',\r\n          D: [pages.Kids[url], 'XYZ', null, null, null]\r\n        });\r\n        options.A.end();\r\n      } else {\r\n        throw new Error(`The document has no page ${url}`);\r\n      }\r\n    } else {\r\n      // Link to an external url\r\n      options.A = this.ref({\r\n        S: 'URI',\r\n        URI: new String(url)\r\n      });\r\n      options.A.end();\r\n    }\r\n\r\n    return this.annotate(x, y, w, h, options);\r\n  },\r\n\r\n  _markup(x, y, w, h, options = {}) {\r\n    const [x1, y1, x2, y2] = this._convertRect(x, y, w, h);\r\n    options.QuadPoints = [x1, y2, x2, y2, x1, y1, x2, y1];\r\n    options.Contents = new String();\r\n    return this.annotate(x, y, w, h, options);\r\n  },\r\n\r\n  highlight(x, y, w, h, options = {}) {\r\n    options.Subtype = 'Highlight';\r\n    if (options.color == null) {\r\n      options.color = [241, 238, 148];\r\n    }\r\n    return this._markup(x, y, w, h, options);\r\n  },\r\n\r\n  underline(x, y, w, h, options = {}) {\r\n    options.Subtype = 'Underline';\r\n    return this._markup(x, y, w, h, options);\r\n  },\r\n\r\n  strike(x, y, w, h, options = {}) {\r\n    options.Subtype = 'StrikeOut';\r\n    return this._markup(x, y, w, h, options);\r\n  },\r\n\r\n  lineAnnotation(x1, y1, x2, y2, options = {}) {\r\n    options.Subtype = 'Line';\r\n    options.Contents = new String();\r\n    options.L = [x1, this.page.height - y1, x2, this.page.height - y2];\r\n    return this.annotate(x1, y1, x2, y2, options);\r\n  },\r\n\r\n  rectAnnotation(x, y, w, h, options = {}) {\r\n    options.Subtype = 'Square';\r\n    options.Contents = new String();\r\n    return this.annotate(x, y, w, h, options);\r\n  },\r\n\r\n  ellipseAnnotation(x, y, w, h, options = {}) {\r\n    options.Subtype = 'Circle';\r\n    options.Contents = new String();\r\n    return this.annotate(x, y, w, h, options);\r\n  },\r\n\r\n  textAnnotation(x, y, w, h, text, options = {}) {\r\n    options.Subtype = 'FreeText';\r\n    options.Contents = new String(text);\r\n    options.DA = new String();\r\n    return this.annotate(x, y, w, h, options);\r\n  },\r\n\r\n  fileAnnotation(x, y, w, h, file = {}, options = {}) {\r\n    // create hidden file\r\n    const filespec = this.file(\r\n      file.src,\r\n      Object.assign({ hidden: true }, file)\r\n    );\r\n\r\n    options.Subtype = 'FileAttachment';\r\n    options.FS = filespec;\r\n\r\n    // add description from filespec unless description (Contents) has already been set\r\n    if (options.Contents) {\r\n      options.Contents = new String(options.Contents);\r\n    } else if (filespec.data.Desc) {\r\n      options.Contents = filespec.data.Desc;\r\n    }\r\n\r\n    return this.annotate(x, y, w, h, options);\r\n  },\r\n\r\n  _convertRect(x1, y1, w, h) {\r\n    // flip y1 and y2\r\n    let y2 = y1;\r\n    y1 += h;\r\n\r\n    // make x2\r\n    let x2 = x1 + w;\r\n\r\n    // apply current transformation matrix to points\r\n    const [m0, m1, m2, m3, m4, m5] = this._ctm;\r\n    x1 = m0 * x1 + m2 * y1 + m4;\r\n    y1 = m1 * x1 + m3 * y1 + m5;\r\n    x2 = m0 * x2 + m2 * y2 + m4;\r\n    y2 = m1 * x2 + m3 * y2 + m5;\r\n\r\n    return [x1, y1, x2, y2];\r\n  }\r\n};\r\n","class PDFOutline {\r\n  constructor(document, parent, title, dest, options = { expanded: false }) {\r\n    this.document = document;\r\n    this.options = options;\r\n    this.outlineData = {};\r\n\r\n    if (dest !== null) {\r\n      this.outlineData['Dest'] = [dest.dictionary, 'Fit'];\r\n    }\r\n\r\n    if (parent !== null) {\r\n      this.outlineData['Parent'] = parent;\r\n    }\r\n\r\n    if (title !== null) {\r\n      this.outlineData['Title'] = new String(title);\r\n    }\r\n\r\n    this.dictionary = this.document.ref(this.outlineData);\r\n    this.children = [];\r\n  }\r\n\r\n  addItem(title, options = { expanded: false }) {\r\n    const result = new PDFOutline(\r\n      this.document,\r\n      this.dictionary,\r\n      title,\r\n      this.document.page,\r\n      options\r\n    );\r\n    this.children.push(result);\r\n\r\n    return result;\r\n  }\r\n\r\n  endOutline() {\r\n    if (this.children.length > 0) {\r\n      if (this.options.expanded) {\r\n        this.outlineData.Count = this.children.length;\r\n      }\r\n\r\n      const first = this.children[0],\r\n        last = this.children[this.children.length - 1];\r\n      this.outlineData.First = first.dictionary;\r\n      this.outlineData.Last = last.dictionary;\r\n\r\n      for (let i = 0, len = this.children.length; i < len; i++) {\r\n        const child = this.children[i];\r\n        if (i > 0) {\r\n          child.outlineData.Prev = this.children[i - 1].dictionary;\r\n        }\r\n        if (i < this.children.length - 1) {\r\n          child.outlineData.Next = this.children[i + 1].dictionary;\r\n        }\r\n        child.endOutline();\r\n      }\r\n    }\r\n\r\n    return this.dictionary.end();\r\n  }\r\n}\r\n\r\nexport default PDFOutline;\r\n","import PDFOutline from '../outline';\r\n\r\nexport default {\r\n  initOutline() {\r\n    return (this.outline = new PDFOutline(this, null, null, null));\r\n  },\r\n\r\n  endOutline() {\r\n    this.outline.endOutline();\r\n    if (this.outline.children.length > 0) {\r\n      this._root.data.Outlines = this.outline.dictionary;\r\n      return (this._root.data.PageMode = 'UseOutlines');\r\n    }\r\n  }\r\n};\r\n","/*\r\nPDFStructureContent - a reference to a marked structure content\r\nBy Ben Schmidt\r\n*/\r\n\r\nclass PDFStructureContent {\r\n  constructor(pageRef, mcid) {\r\n    this.refs = [{ pageRef, mcid }];\r\n  }\r\n\r\n  push(structContent) {\r\n    structContent.refs.forEach((ref) => this.refs.push(ref));\r\n  }\r\n}\r\n\r\nexport default PDFStructureContent;\r\n","/*\r\nPDFStructureElement - represents an element in the PDF logical structure tree\r\nBy Ben Schmidt\r\n*/\r\n\r\nimport PDFStructureContent from \"./structure_content\";\r\n\r\nclass PDFStructureElement {\r\n  constructor(document, type, options = {}, children = null) {\r\n    this.document = document;\r\n\r\n    this._attached = false;\r\n    this._ended = false;\r\n    this._flushed = false;\r\n    this.dictionary = document.ref({\r\n      // Type: \"StructElem\",\r\n      S: type\r\n    });\r\n\r\n    const data = this.dictionary.data;\r\n\r\n    if (Array.isArray(options) || this._isValidChild(options)) {\r\n      children = options;\r\n      options = {};\r\n    }\r\n\r\n    if (typeof options.title !== 'undefined') {\r\n      data.T = new String(options.title);\r\n    }\r\n    if (typeof options.lang !== 'undefined') {\r\n      data.Lang = new String(options.lang);\r\n    }\r\n    if (typeof options.alt !== 'undefined') {\r\n      data.Alt = new String(options.alt);\r\n    }\r\n    if (typeof options.expanded !== 'undefined') {\r\n      data.E = new String(options.expanded);\r\n    }\r\n    if (typeof options.actual !== 'undefined') {\r\n      data.ActualText = new String(options.actual);\r\n    }\r\n\r\n    this._children = [];\r\n\r\n    if (children) {\r\n      if (!Array.isArray(children)) {\r\n        children = [children];\r\n      }\r\n      children.forEach((child) => this.add(child));\r\n      this.end();\r\n    }\r\n  }\r\n\r\n  add(child) {\r\n    if (this._ended) {\r\n      throw new Error(`Cannot add child to already-ended structure element`);\r\n    }\r\n\r\n    if (!this._isValidChild(child)) {\r\n      throw new Error(`Invalid structure element child`);\r\n    }\r\n\r\n    if (child instanceof PDFStructureElement) {\r\n      child.setParent(this.dictionary);\r\n      if (this._attached) {\r\n        child.setAttached();\r\n      }\r\n    }\r\n\r\n    if (child instanceof PDFStructureContent) {\r\n      this._addContentToParentTree(child);\r\n    }\r\n\r\n    if (typeof child === 'function' && this._attached) {\r\n      // _contentForClosure() adds the content to the parent tree\r\n      child = this._contentForClosure(child);\r\n    }\r\n\r\n    this._children.push(child);\r\n\r\n    return this;\r\n  }\r\n\r\n  _addContentToParentTree(content) {\r\n    content.refs.forEach(({ pageRef, mcid }) => {\r\n      const pageStructParents = this.document.getStructParentTree()\r\n        .get(pageRef.data.StructParents);\r\n      pageStructParents[mcid] = this.dictionary;\r\n    });\r\n  }\r\n\r\n  setParent(parentRef) {\r\n    if (this.dictionary.data.P) {\r\n      throw new Error(`Structure element added to more than one parent`);\r\n    }\r\n\r\n    this.dictionary.data.P = parentRef;\r\n\r\n    this._flush();\r\n  }\r\n\r\n  setAttached() {\r\n    if (this._attached) {\r\n      return;\r\n    }\r\n\r\n    this._children.forEach((child, index) => {\r\n      if (child instanceof PDFStructureElement) {\r\n        child.setAttached();\r\n      }\r\n      if (typeof child === 'function') {\r\n        this._children[index] = this._contentForClosure(child);\r\n      }\r\n    });\r\n\r\n    this._attached = true;\r\n\r\n    this._flush();\r\n  }\r\n\r\n  end() {\r\n    if (this._ended) {\r\n      return;\r\n    }\r\n\r\n    this._children\r\n      .filter((child) => child instanceof PDFStructureElement)\r\n      .forEach((child) => child.end());\r\n\r\n    this._ended = true;\r\n\r\n    this._flush();\r\n  }\r\n\r\n  _isValidChild(child) {\r\n    return child instanceof PDFStructureElement ||\r\n        child instanceof PDFStructureContent ||\r\n        typeof child === 'function';\r\n  }\r\n\r\n  _contentForClosure(closure) {\r\n    const content = this.document.markStructureContent(this.dictionary.data.S);\r\n    closure();\r\n    this.document.endMarkedContent();\r\n\r\n    this._addContentToParentTree(content);\r\n\r\n    return content;\r\n  }\r\n\r\n  _isFlushable() {\r\n    if (!this.dictionary.data.P || !this._ended) {\r\n      return false;\r\n    }\r\n\r\n    return this._children.every((child) => {\r\n      if (typeof child === 'function') {\r\n        return false;\r\n      }\r\n      if (child instanceof PDFStructureElement) {\r\n        return child._isFlushable();\r\n      }\r\n      return true;\r\n    });\r\n  }\r\n\r\n  _flush() {\r\n    if (this._flushed || !this._isFlushable()) {\r\n      return;\r\n    }\r\n\r\n    this.dictionary.data.K = [];\r\n\r\n    this._children.forEach((child) => this._flushChild(child));\r\n\r\n    this.dictionary.end();\r\n\r\n    // free memory used by children; the dictionary itself may still be\r\n    // referenced by a parent structure element or root, but we can\r\n    // at least trim the tree here\r\n    this._children = [];\r\n    this.dictionary.data.K = null;\r\n\r\n    this._flushed = true;\r\n  }\r\n\r\n  _flushChild(child) {\r\n    if (child instanceof PDFStructureElement) {\r\n      this.dictionary.data.K.push(child.dictionary);\r\n    }\r\n\r\n    if (child instanceof PDFStructureContent) {\r\n      child.refs.forEach(({ pageRef, mcid }) => {\r\n        if (!this.dictionary.data.Pg) {\r\n          this.dictionary.data.Pg = pageRef;\r\n        }\r\n\r\n        if (this.dictionary.data.Pg === pageRef) {\r\n          this.dictionary.data.K.push(mcid);\r\n        } else {\r\n          this.dictionary.data.K.push({\r\n            Type: \"MCR\",\r\n            Pg: pageRef,\r\n            MCID: mcid\r\n          });\r\n        }\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nexport default PDFStructureElement;\r\n","/*\r\nPDFNumberTree - represents a number tree object\r\n*/\r\n\r\nimport PDFTree from \"./tree\";\r\n\r\nclass PDFNumberTree extends PDFTree {\r\n  _compareKeys(a, b) {\r\n    return parseInt(a) - parseInt(b);\r\n  }\r\n\r\n  _keysName() {\r\n    return \"Nums\";\r\n  }\r\n\r\n  _dataForKey(k) {\r\n    return parseInt(k);\r\n  }\r\n}\r\n\r\nexport default PDFNumberTree;\r\n","/*\r\nMarkings mixin - support marked content sequences in content streams\r\nBy Ben Schmidt\r\n*/\r\n\r\nimport PDFStructureElement from \"../structure_element\";\r\nimport PDFStructureContent from \"../structure_content\";\r\nimport PDFNumberTree from \"../number_tree\";\r\nimport PDFObject from \"../object\";\r\n\r\nexport default {\r\n\r\n  initMarkings(options) {\r\n    this.structChildren = [];\r\n\r\n    if (options.tagged) {\r\n      this.getMarkInfoDictionary().data.Marked = true;\r\n      this.getStructTreeRoot();\r\n    }\r\n  },\r\n\r\n  markContent(tag, options = null) {\r\n    if (tag === 'Artifact' || (options && options.mcid)) {\r\n      let toClose = 0;\r\n      this.page.markings.forEach((marking) => {\r\n        if (toClose || marking.structContent || marking.tag === 'Artifact') {\r\n          toClose++;\r\n        }\r\n      });\r\n      while (toClose--) {\r\n        this.endMarkedContent();\r\n      }\r\n    }\r\n\r\n    if (!options) {\r\n      this.page.markings.push({ tag });\r\n      this.addContent(`/${tag} BMC`);\r\n      return this;\r\n    }\r\n\r\n    this.page.markings.push({ tag, options });\r\n\r\n    const dictionary = {};\r\n\r\n    if (typeof options.mcid !== 'undefined') {\r\n      dictionary.MCID = options.mcid;\r\n    }\r\n    if (tag === 'Artifact') {\r\n      if (typeof options.type === 'string') {\r\n        dictionary.Type = options.type;\r\n      }\r\n      if (Array.isArray(options.bbox)) {\r\n        dictionary.BBox = [options.bbox[0], this.page.height - options.bbox[3],\r\n          options.bbox[2], this.page.height - options.bbox[1]];\r\n      }\r\n      if (Array.isArray(options.attached) &&\r\n        options.attached.every(val => typeof val === 'string')) {\r\n        dictionary.Attached = options.attached;\r\n      }\r\n    }\r\n    if (tag === 'Span') {\r\n      if (options.lang) {\r\n        dictionary.Lang = new String(options.lang);\r\n      }\r\n      if (options.alt) {\r\n        dictionary.Alt = new String(options.alt);\r\n      }\r\n      if (options.expanded) {\r\n        dictionary.E = new String(options.expanded);\r\n      }\r\n      if (options.actual) {\r\n        dictionary.ActualText = new String(options.actual);\r\n      }\r\n    }\r\n\r\n    this.addContent(`/${tag} ${PDFObject.convert(dictionary)} BDC`);\r\n    return this;\r\n  },\r\n\r\n  markStructureContent(tag, options = {}) {\r\n    const pageStructParents = this.getStructParentTree().get(this.page.structParentTreeKey);\r\n    const mcid = pageStructParents.length;\r\n    pageStructParents.push(null);\r\n\r\n    this.markContent(tag, { ...options, mcid });\r\n\r\n    const structContent = new PDFStructureContent(this.page.dictionary, mcid);\r\n    this.page.markings.slice(-1)[0].structContent = structContent;\r\n    return structContent;\r\n  },\r\n\r\n  endMarkedContent() {\r\n    this.page.markings.pop();\r\n    this.addContent('EMC');\r\n    return this;\r\n  },\r\n\r\n  struct(type, options = {}, children = null) {\r\n    return new PDFStructureElement(this, type, options, children);\r\n  },\r\n\r\n  addStructure(structElem) {\r\n    const structTreeRoot = this.getStructTreeRoot();\r\n    structElem.setParent(structTreeRoot);\r\n    structElem.setAttached();\r\n    this.structChildren.push(structElem);\r\n    if (!structTreeRoot.data.K) {\r\n      structTreeRoot.data.K = [];\r\n    }\r\n    structTreeRoot.data.K.push(structElem.dictionary);\r\n    return this;\r\n  },\r\n\r\n  initPageMarkings(pageMarkings) {\r\n    pageMarkings.forEach((marking) => {\r\n      if (marking.structContent) {\r\n        const structContent = marking.structContent;\r\n        const newStructContent = this.markStructureContent(marking.tag, marking.options);\r\n        structContent.push(newStructContent);\r\n        this.page.markings.slice(-1)[0].structContent = structContent;\r\n      } else {\r\n        this.markContent(marking.tag, marking.options);\r\n      }\r\n    });\r\n  },\r\n\r\n  endPageMarkings(page) {\r\n    const pageMarkings = page.markings;\r\n    pageMarkings.forEach(() => page.write('EMC'));\r\n    page.markings = [];\r\n    return pageMarkings;\r\n  },\r\n\r\n  getMarkInfoDictionary() {\r\n    if (!this._root.data.MarkInfo) {\r\n      this._root.data.MarkInfo = this.ref({});\r\n    }\r\n    return this._root.data.MarkInfo;\r\n  },\r\n\r\n  getStructTreeRoot() {\r\n    if (!this._root.data.StructTreeRoot) {\r\n      this._root.data.StructTreeRoot = this.ref({\r\n        Type: 'StructTreeRoot',\r\n        ParentTree: new PDFNumberTree(),\r\n        ParentTreeNextKey: 0\r\n      });\r\n    }\r\n    return this._root.data.StructTreeRoot;\r\n  },\r\n\r\n  getStructParentTree() {\r\n    return this.getStructTreeRoot().data.ParentTree;\r\n  },\r\n\r\n  createStructParentTreeNextKey() {\r\n    // initialise the MarkInfo dictionary\r\n    this.getMarkInfoDictionary();\r\n\r\n    const structTreeRoot = this.getStructTreeRoot();\r\n    const key = structTreeRoot.data.ParentTreeNextKey++;\r\n    structTreeRoot.data.ParentTree.add(key, []);\r\n    return key;\r\n  },\r\n\r\n  endMarkings() {\r\n    const structTreeRoot = this._root.data.StructTreeRoot;\r\n    if (structTreeRoot) {\r\n      structTreeRoot.end();\r\n      this.structChildren.forEach((structElem) => structElem.end());\r\n    }\r\n    if (this._root.data.MarkInfo) {\r\n      this._root.data.MarkInfo.end();\r\n    }\r\n  }\r\n\r\n};\r\n","const FIELD_FLAGS = {\r\n  readOnly: 1,\r\n  required: 2,\r\n  noExport: 4,\r\n  multiline: 0x1000,\r\n  password: 0x2000,\r\n  toggleToOffButton: 0x4000,\r\n  radioButton: 0x8000,\r\n  pushButton: 0x10000,\r\n  combo: 0x20000,\r\n  edit: 0x40000,\r\n  sort: 0x80000,\r\n  multiSelect: 0x200000,\r\n  noSpell: 0x400000\r\n};\r\nconst FIELD_JUSTIFY = {\r\n  left: 0,\r\n  center: 1,\r\n  right: 2\r\n};\r\nconst VALUE_MAP = { value: 'V', defaultValue: 'DV' };\r\nconst FORMAT_SPECIAL = {\r\n  zip: '0',\r\n  zipPlus4: '1',\r\n  zip4: '1',\r\n  phone: '2',\r\n  ssn: '3'\r\n};\r\nconst FORMAT_DEFAULT = {\r\n  number: {\r\n    nDec: 0,\r\n    sepComma: false,\r\n    negStyle: 'MinusBlack',\r\n    currency: '',\r\n    currencyPrepend: true\r\n  },\r\n  percent: {\r\n    nDec: 0,\r\n    sepComma: false\r\n  }\r\n};\r\n\r\nexport default {\r\n  /**\r\n   * Must call if adding AcroForms to a document. Must also call font() before\r\n   * this method to set the default font.\r\n   */\r\n  initForm() {\r\n    if (!this._font) {\r\n      throw new Error('Must set a font before calling initForm method');\r\n    }\r\n    this._acroform = {\r\n      fonts: {},\r\n      defaultFont: this._font.name\r\n    };\r\n    this._acroform.fonts[this._font.id] = this._font.ref();\r\n\r\n    let data = {\r\n      Fields: [],\r\n      NeedAppearances: true,\r\n      DA: new String(`/${this._font.id} 0 Tf 0 g`),\r\n      DR: {\r\n        Font: {}\r\n      }\r\n    };\r\n    data.DR.Font[this._font.id] = this._font.ref();\r\n    const AcroForm = this.ref(data);\r\n    this._root.data.AcroForm = AcroForm;\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Called automatically by document.js\r\n   */\r\n  endAcroForm() {\r\n    if (this._root.data.AcroForm) {\r\n      if (\r\n        !Object.keys(this._acroform.fonts).length &&\r\n        !this._acroform.defaultFont\r\n      ) {\r\n        throw new Error('No fonts specified for PDF form');\r\n      }\r\n      let fontDict = this._root.data.AcroForm.data.DR.Font;\r\n      Object.keys(this._acroform.fonts).forEach(name => {\r\n        fontDict[name] = this._acroform.fonts[name];\r\n      });\r\n      this._root.data.AcroForm.data.Fields.forEach(fieldRef => {\r\n        this._endChild(fieldRef);\r\n      });\r\n      this._root.data.AcroForm.end();\r\n    }\r\n    return this;\r\n  },\r\n\r\n  _endChild(ref) {\r\n    if (Array.isArray(ref.data.Kids)) {\r\n      ref.data.Kids.forEach(childRef => {\r\n        this._endChild(childRef);\r\n      });\r\n      ref.end();\r\n    }\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Creates and adds a form field to the document. Form fields are intermediate\r\n   * nodes in a PDF form that are used to specify form name heirarchy and form\r\n   * value defaults.\r\n   * @param {string} name - field name (T attribute in field dictionary)\r\n   * @param {object} options  - other attributes to include in field dictionary\r\n   */\r\n  formField(name, options = {}) {\r\n    let fieldDict = this._fieldDict(name, null, options);\r\n    let fieldRef = this.ref(fieldDict);\r\n    this._addToParent(fieldRef);\r\n    return fieldRef;\r\n  },\r\n\r\n  /**\r\n   * Creates and adds a Form Annotation to the document. Form annotations are\r\n   * called Widget annotations internally within a PDF file.\r\n   * @param {string} name - form field name (T attribute of widget annotation\r\n   * dictionary)\r\n   * @param {number} x\r\n   * @param {number} y\r\n   * @param {number} w\r\n   * @param {number} h\r\n   * @param {object} options\r\n   */\r\n  formAnnotation(name, type, x, y, w, h, options = {}) {\r\n    let fieldDict = this._fieldDict(name, type, options);\r\n    fieldDict.Subtype = 'Widget';\r\n    if (fieldDict.F === undefined) {\r\n      fieldDict.F = 4; // print the annotation\r\n    }\r\n\r\n    // Add Field annot to page, and get it's ref\r\n    this.annotate(x, y, w, h, fieldDict);\r\n    let annotRef = this.page.annotations[this.page.annotations.length - 1];\r\n\r\n    return this._addToParent(annotRef);\r\n  },\r\n\r\n  formText(name, x, y, w, h, options = {}) {\r\n    return this.formAnnotation(name, 'text', x, y, w, h, options);\r\n  },\r\n\r\n  formPushButton(name, x, y, w, h, options = {}) {\r\n    return this.formAnnotation(name, 'pushButton', x, y, w, h, options);\r\n  },\r\n\r\n  formCombo(name, x, y, w, h, options = {}) {\r\n    return this.formAnnotation(name, 'combo', x, y, w, h, options);\r\n  },\r\n\r\n  formList(name, x, y, w, h, options = {}) {\r\n    return this.formAnnotation(name, 'list', x, y, w, h, options);\r\n  },\r\n\r\n  formRadioButton(name, x, y, w, h, options = {}) {\r\n    return this.formAnnotation(name, 'radioButton', x, y, w, h, options);\r\n  },\r\n\r\n  formCheckbox(name, x, y, w, h, options = {}) {\r\n    return this.formAnnotation(name, 'checkbox', x, y, w, h, options);\r\n  },\r\n\r\n  _addToParent(fieldRef) {\r\n    let parent = fieldRef.data.Parent;\r\n    if (parent) {\r\n      if (!parent.data.Kids) {\r\n        parent.data.Kids = [];\r\n      }\r\n      parent.data.Kids.push(fieldRef);\r\n    } else {\r\n      this._root.data.AcroForm.data.Fields.push(fieldRef);\r\n    }\r\n    return this;\r\n  },\r\n\r\n  _fieldDict(name, type, options = {}) {\r\n    if (!this._acroform) {\r\n      throw new Error(\r\n        'Call document.initForms() method before adding form elements to document'\r\n      );\r\n    }\r\n    let opts = Object.assign({}, options);\r\n    if (type !== null) {\r\n      opts = this._resolveType(type, options);\r\n    }\r\n    opts = this._resolveFlags(opts);\r\n    opts = this._resolveJustify(opts);\r\n    opts = this._resolveFont(opts);\r\n    opts = this._resolveStrings(opts);\r\n    opts = this._resolveColors(opts);\r\n    opts = this._resolveFormat(opts);\r\n    opts.T = new String(name);\r\n    if (opts.parent) {\r\n      opts.Parent = opts.parent;\r\n      delete opts.parent;\r\n    }\r\n    return opts;\r\n  },\r\n\r\n  _resolveType(type, opts) {\r\n    if (type === 'text') {\r\n      opts.FT = 'Tx';\r\n    } else if (type === 'pushButton') {\r\n      opts.FT = 'Btn';\r\n      opts.pushButton = true;\r\n    } else if (type === 'radioButton') {\r\n      opts.FT = 'Btn';\r\n      opts.radioButton = true;\r\n    } else if (type === 'checkbox') {\r\n      opts.FT = 'Btn';\r\n    } else if (type === 'combo') {\r\n      opts.FT = 'Ch';\r\n      opts.combo = true;\r\n    } else if (type === 'list') {\r\n      opts.FT = 'Ch';\r\n    } else {\r\n      throw new Error(`Invalid form annotation type '${type}'`);\r\n    }\r\n    return opts;\r\n  },\r\n\r\n  _resolveFormat(opts) {\r\n    const f = opts.format;\r\n    if (f && f.type) {\r\n      let fnKeystroke;\r\n      let fnFormat;\r\n      let params = '';\r\n      if (FORMAT_SPECIAL[f.type] !== undefined) {\r\n        fnKeystroke = `AFSpecial_Keystroke`;\r\n        fnFormat = `AFSpecial_Format`;\r\n        params = FORMAT_SPECIAL[f.type];\r\n      } else {\r\n        let format = f.type.charAt(0).toUpperCase() + f.type.slice(1);\r\n        fnKeystroke = `AF${format}_Keystroke`;\r\n        fnFormat = `AF${format}_Format`;\r\n\r\n        if (f.type === 'date') {\r\n          fnKeystroke += 'Ex';\r\n          params = String(f.param);\r\n        } else if (f.type === 'time') {\r\n          params = String(f.param);\r\n        } else if (f.type === 'number') {\r\n          let p = Object.assign({}, FORMAT_DEFAULT.number, f);\r\n          params = String(\r\n            [\r\n              String(p.nDec),\r\n              p.sepComma ? '0' : '1',\r\n              '\"' + p.negStyle + '\"',\r\n              'null',\r\n              '\"' + p.currency + '\"',\r\n              String(p.currencyPrepend)\r\n            ].join(',')\r\n          );\r\n        } else if (f.type === 'percent') {\r\n          let p = Object.assign({}, FORMAT_DEFAULT.percent, f);\r\n          params = String([String(p.nDec), p.sepComma ? '0' : '1'].join(','));\r\n        }\r\n      }\r\n      opts.AA = opts.AA ? opts.AA : {};\r\n      opts.AA.K = {\r\n        S: 'JavaScript',\r\n        JS: new String(`${fnKeystroke}(${params});`)\r\n      };\r\n      opts.AA.F = {\r\n        S: 'JavaScript',\r\n        JS: new String(`${fnFormat}(${params});`)\r\n      };\r\n    }\r\n    delete opts.format;\r\n    return opts;\r\n  },\r\n\r\n  _resolveColors(opts) {\r\n    let color = this._normalizeColor(opts.backgroundColor);\r\n    if (color) {\r\n      if (!opts.MK) {\r\n        opts.MK = {};\r\n      }\r\n      opts.MK.BG = color;\r\n    }\r\n    color = this._normalizeColor(opts.borderColor);\r\n    if (color) {\r\n      if (!opts.MK) {\r\n        opts.MK = {};\r\n      }\r\n      opts.MK.BC = color;\r\n    }\r\n    delete opts.backgroundColor;\r\n    delete opts.borderColor;\r\n    return opts;\r\n  },\r\n\r\n  _resolveFlags(options) {\r\n    let result = 0;\r\n    Object.keys(options).forEach(key => {\r\n      if (FIELD_FLAGS[key]) {\r\n        if (options[key]) {\r\n          result |= FIELD_FLAGS[key];\r\n        }\r\n        delete options[key];\r\n      }\r\n    });\r\n    if (result !== 0) {\r\n      options.Ff = options.Ff ? options.Ff : 0;\r\n      options.Ff |= result;\r\n    }\r\n    return options;\r\n  },\r\n\r\n  _resolveJustify(options) {\r\n    let result = 0;\r\n    if (options.align !== undefined) {\r\n      if (typeof FIELD_JUSTIFY[options.align] === 'number') {\r\n        result = FIELD_JUSTIFY[options.align];\r\n      }\r\n      delete options.align;\r\n    }\r\n    if (result !== 0) {\r\n      options.Q = result; // default\r\n    }\r\n    return options;\r\n  },\r\n\r\n  _resolveFont(options) {\r\n    // add current font to document-level AcroForm dict if necessary\r\n    if (this._acroform.fonts[this._font.id] === null) {\r\n      this._acroform.fonts[this._font.id] = this._font.ref();\r\n    }\r\n\r\n    // add current font to field's resource dict (RD) if not the default acroform font\r\n    if (this._acroform.defaultFont !== this._font.name) {\r\n      options.DR = { Font: {} };\r\n\r\n      // Get the fontSize option. If not set use auto sizing\r\n      const fontSize = options.fontSize || 0;\r\n\r\n      options.DR.Font[this._font.id] = this._font.ref();\r\n      options.DA = new String(`/${this._font.id} ${fontSize} Tf 0 g`);\r\n    }\r\n    return options;\r\n  },\r\n\r\n  _resolveStrings(options) {\r\n    let select = [];\r\n    function appendChoices(a) {\r\n      if (Array.isArray(a)) {\r\n        for (let idx = 0; idx < a.length; idx++) {\r\n          if (typeof a[idx] === 'string') {\r\n            select.push(new String(a[idx]));\r\n          } else {\r\n            select.push(a[idx]);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    appendChoices(options.Opt);\r\n    if (options.select) {\r\n      appendChoices(options.select);\r\n      delete options.select;\r\n    }\r\n    if (select.length) {\r\n      options.Opt = select;\r\n    }\r\n\r\n    Object.keys(VALUE_MAP).forEach(key => {\r\n      if (options[key] !== undefined) {\r\n        options[VALUE_MAP[key]] = options[key];\r\n        delete options[key];\r\n      }\r\n    });\r\n    ['V', 'DV'].forEach(key => {\r\n      if (typeof options[key] === 'string') {\r\n        options[key] = new String(options[key]);\r\n      }\r\n    });\r\n\r\n    if (options.MK && options.MK.CA) {\r\n      options.MK.CA = new String(options.MK.CA);\r\n    }\r\n    if (options.label) {\r\n      options.MK = options.MK ? options.MK : {};\r\n      options.MK.CA = new String(options.label);\r\n      delete options.label;\r\n    }\r\n    return options;\r\n  }\r\n};\r\n","import fs from 'fs';\r\nimport CryptoJS from 'crypto-js';\r\n\r\nexport default {\r\n  /**\r\n   * Embed contents of `src` in PDF\r\n   * @param {Buffer | ArrayBuffer | string} src input Buffer, ArrayBuffer, base64 encoded string or path to file\r\n   * @param {object} options\r\n   *  * options.name: filename to be shown in PDF, will use `src` if none set\r\n   *  * options.type: filetype to be shown in PDF\r\n   *  * options.description: description to be shown in PDF\r\n   *  * options.hidden: if true, do not add attachment to EmbeddedFiles dictionary. Useful for file attachment annotations\r\n   *  * options.creationDate: override creation date\r\n   *  * options.modifiedDate: override modified date\r\n   * @returns filespec reference\r\n   */\r\n  file(src, options = {}) {\r\n    options.name = options.name || src;\r\n\r\n    const refBody = {\r\n      Type: 'EmbeddedFile',\r\n      Params: {}\r\n    };\r\n    let data;\r\n\r\n    if (!src) {\r\n      throw new Error('No src specified');\r\n    }\r\n    if (Buffer.isBuffer(src)) {\r\n      data = src;\r\n    } else if (src instanceof ArrayBuffer) {\r\n      data = Buffer.from(new Uint8Array(src));\r\n    } else {\r\n      let match;\r\n      if ((match = /^data:(.*?);base64,(.*)$/.exec(src))) {\r\n        if (match[1]) {\r\n          refBody.Subtype = match[1].replace('/', '#2F');\r\n        }\r\n        data = Buffer.from(match[2], 'base64');\r\n      } else {\r\n        data = fs.readFileSync(src);\r\n        if (!data) {\r\n          throw new Error(`Could not read contents of file at filepath ${src}`);\r\n        }\r\n\r\n        // update CreationDate and ModDate\r\n        const { birthtime, ctime } = fs.statSync(src);\r\n        refBody.Params.CreationDate = birthtime;\r\n        refBody.Params.ModDate = ctime;\r\n      }\r\n    }\r\n\r\n    // override creation date and modified date\r\n    if (options.creationDate instanceof Date) {\r\n      refBody.Params.CreationDate = options.creationDate;\r\n    }\r\n    if (options.modifiedDate instanceof Date) {\r\n      refBody.Params.ModDate = options.modifiedDate;\r\n    }\r\n    // add optional subtype\r\n    if (options.type) {\r\n      refBody.Subtype = options.type.replace('/', '#2F');\r\n    }\r\n\r\n    // add checksum and size information\r\n    const checksum = CryptoJS.MD5(\r\n      CryptoJS.lib.WordArray.create(new Uint8Array(data))\r\n    );\r\n    refBody.Params.CheckSum = new String(checksum);\r\n    refBody.Params.Size = data.byteLength;\r\n\r\n    // save some space when embedding the same file again\r\n    // if a file with the same name and metadata exists, reuse its reference\r\n    let ref;\r\n    if (!this._fileRegistry) this._fileRegistry = {};\r\n    let file = this._fileRegistry[options.name];\r\n    if (file && isEqual(refBody, file)) {\r\n      ref = file.ref;\r\n    } else {\r\n      ref = this.ref(refBody);\r\n      ref.end(data);\r\n\r\n      this._fileRegistry[options.name] = { ...refBody, ref };\r\n    }\r\n    // add filespec for embedded file\r\n    const fileSpecBody = {\r\n      Type: 'Filespec',\r\n      F: new String(options.name),\r\n      EF: { F: ref },\r\n      UF: new String(options.name)\r\n    };\r\n    if (options.description) {\r\n      fileSpecBody.Desc = new String(options.description);\r\n    }\r\n    const filespec = this.ref(fileSpecBody);\r\n    filespec.end();\r\n\r\n    if (!options.hidden) {\r\n      this.addNamedEmbeddedFile(options.name, filespec);\r\n    }\r\n\r\n    return filespec;\r\n  }\r\n};\r\n\r\n/** check two embedded file metadata objects for equality */\r\nfunction isEqual(a, b) {\r\n  return (\r\n    a.Subtype === b.Subtype &&\r\n    a.Params.CheckSum.toString() === b.Params.CheckSum.toString() &&\r\n    a.Params.Size === b.Params.Size &&\r\n    a.Params.CreationDate === b.Params.CreationDate &&\r\n    a.Params.ModDate === b.Params.ModDate\r\n  );\r\n}\r\n","import fs from 'fs';\r\n\r\nexport default {\r\n  initPDFA(pSubset) {\r\n    if (pSubset.charAt(pSubset.length - 3) === '-') {\r\n      this.subset_conformance = pSubset\r\n        .charAt(pSubset.length - 1)\r\n        .toUpperCase();\r\n      this.subset = parseInt(pSubset.charAt(pSubset.length - 2));\r\n    } else {\r\n      // Default to Basic conformance when user doesn't specify\r\n      this.subset_conformance = 'B';\r\n      this.subset = parseInt(pSubset.charAt(pSubset.length - 1));\r\n    }\r\n  },\r\n\r\n  endSubset() {\r\n    this._addPdfaMetadata();\r\n    this._addColorOutputIntent(`${__dirname}/data/sRGB_IEC61966_2_1.icc`);\r\n  },\r\n\r\n  _addColorOutputIntent(pICCPath) {\r\n    const iccProfile = fs.readFileSync(pICCPath);\r\n\r\n    const colorProfileRef = this.ref({\r\n      Length: iccProfile.length,\r\n      N: 3\r\n    });\r\n    colorProfileRef.write(iccProfile);\r\n    colorProfileRef.end();\r\n\r\n    const intentRef = this.ref({\r\n      Type: 'OutputIntent',\r\n      S: 'GTS_PDFA1',\r\n      Info: new String('sRGB IEC61966-2.1'),\r\n      OutputConditionIdentifier: new String('sRGB IEC61966-2.1'),\r\n      DestOutputProfile: colorProfileRef\r\n    });\r\n    intentRef.end();\r\n\r\n    this._root.data.OutputIntents = [intentRef];\r\n  },\r\n\r\n  _getPdfaid() {\r\n    return `\r\n        <rdf:Description xmlns:pdfaid=\"http://www.aiim.org/pdfa/ns/id/\" rdf:about=\"\">\r\n            <pdfaid:part>${this.subset}</pdfaid:part>\r\n            <pdfaid:conformance>${this.subset_conformance}</pdfaid:conformance>\r\n        </rdf:Description>\r\n        `;\r\n  },\r\n\r\n  _addPdfaMetadata() {\r\n    this.appendXML(this._getPdfaid());\r\n  }\r\n};\r\n","\r\nexport default {\r\n\r\n    initPDFUA() {\r\n        this.subset = 1;\r\n    },\r\n\r\n    endSubset() {\r\n        this._addPdfuaMetadata();\r\n    },\r\n\r\n    _addPdfuaMetadata() {\r\n        this.appendXML(this._getPdfuaid());\r\n    },\r\n\r\n    _getPdfuaid() {\r\n        return `\r\n        <rdf:Description xmlns:pdfuaid=\"http://www.aiim.org/pdfua/ns/id/\" rdf:about=\"\">\r\n            <pdfuaid:part>${this.subset}</pdfuaid:part>\r\n        </rdf:Description>\r\n        `;\r\n    },\r\n\r\n}","import PDFA from './pdfa';\r\nimport PDFUA from './pdfua';\r\n\r\nexport default {\r\n    _importSubset(subset) {\r\n        Object.assign(this, subset)\r\n    },\r\n\r\n    initSubset(options) {\r\n\r\n        switch (options.subset) {\r\n            case 'PDF/A-1':\r\n            case 'PDF/A-1a':\r\n            case 'PDF/A-1b':\r\n            case 'PDF/A-2':\r\n            case 'PDF/A-2a':\r\n            case 'PDF/A-2b':\r\n            case 'PDF/A-3':\r\n            case 'PDF/A-3a':\r\n            case 'PDF/A-3b':\r\n                this._importSubset(PDFA);\r\n                this.initPDFA(options.subset);\r\n                break;\r\n            case 'PDF/UA':\r\n                this._importSubset(PDFUA);\r\n                this.initPDFUA();\r\n                break;\r\n        }\r\n    }\r\n}","\r\nclass PDFMetadata {\r\n    constructor() {\r\n        this._metadata = `\r\n        <?xpacket begin=\"\\ufeff\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?>\r\n            <x:xmpmeta xmlns:x=\"adobe:ns:meta/\">\r\n                <rdf:RDF xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\">\r\n        `;\r\n    }\r\n    \r\n    _closeTags() {\r\n        this._metadata = this._metadata.concat(`\r\n                </rdf:RDF>\r\n            </x:xmpmeta>\r\n        <?xpacket end=\"w\"?>\r\n        `);\r\n    }\r\n\r\n    append(xml, newline=true) {\r\n        this._metadata = this._metadata.concat(xml); \r\n        if (newline)\r\n            this._metadata = this._metadata.concat('\\n'); \r\n    }\r\n\r\n    getXML() { return this._metadata; }\r\n\r\n    getLength() { return this._metadata.length; }\r\n\r\n    end() {\r\n        this._closeTags();\r\n        this._metadata = this._metadata.trim();\r\n    }\r\n}\r\n\r\nexport default PDFMetadata;","import PDFMetadata from \"../metadata\"\r\n\r\nexport default {\r\n    initMetadata() {\r\n        this.metadata = new PDFMetadata();\r\n    },\r\n\r\n    appendXML(xml, newline=true) { this.metadata.append(xml,newline); },\r\n\r\n    _addInfo() {\r\n        this.appendXML(`\r\n        <rdf:Description rdf:about=\"\" xmlns:xmp=\"http://ns.adobe.com/xap/1.0/\">\r\n            <xmp:CreateDate>${this.info.CreationDate.toISOString().split('.')[0]+\"Z\"}</xmp:CreateDate>\r\n            <xmp:CreatorTool>${this.info.Creator}</xmp:CreatorTool>\r\n        </rdf:Description>\r\n        `\r\n        );\r\n\r\n        if (this.info.Title || this.info.Author || this.info.Subject) {\r\n            this.appendXML(`\r\n            <rdf:Description rdf:about=\"\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\">\r\n            `);\r\n            \r\n            if (this.info.Title) {\r\n                this.appendXML(`\r\n                <dc:title>\r\n                    <rdf:Alt>\r\n                        <rdf:li xml:lang=\"x-default\">${this.info.Title}</rdf:li>\r\n                    </rdf:Alt>\r\n                </dc:title>\r\n                `);\r\n            }\r\n\r\n            if (this.info.Author) {\r\n                this.appendXML(`\r\n                <dc:creator>\r\n                    <rdf:Seq>\r\n                        <rdf:li>${this.info.Author}</rdf:li>\r\n                    </rdf:Seq>\r\n                </dc:creator>\r\n                `);\r\n            }\r\n\r\n            if (this.info.Subject) {\r\n                this.appendXML(`\r\n                <dc:description>\r\n                    <rdf:Alt>\r\n                        <rdf:li xml:lang=\"x-default\">${this.info.Subject}</rdf:li>\r\n                    </rdf:Alt>\r\n                </dc:description>\r\n                `);\r\n            }\r\n\r\n            this.appendXML(`\r\n            </rdf:Description>\r\n            `);\r\n        }\r\n\r\n        this.appendXML(`\r\n        <rdf:Description rdf:about=\"\" xmlns:pdf=\"http://ns.adobe.com/pdf/1.3/\">\r\n            <pdf:Producer>${this.info.Creator}</pdf:Producer>`, false);\r\n\r\n        if (this.info.Keywords) {\r\n            this.appendXML(`\r\n            <pdf:Keywords>${this.info.Keywords}</pdf:Keywords>`, false);\r\n        }\r\n\r\n        this.appendXML(`\r\n        </rdf:Description>\r\n        `);\r\n    },\r\n\r\n    endMetadata() {\r\n        this._addInfo();\r\n    \r\n        this.metadata.end();\r\n\r\n        /*\r\n        Metadata was introduced in PDF 1.4, so adding it to 1.3 \r\n        will likely only take up more space.\r\n        */\r\n        if (this.version != 1.3) {\r\n            this.metadataRef = this.ref({\r\n                length: this.metadata.getLength(),\r\n                Type: 'Metadata',\r\n                Subtype: 'XML'\r\n            });\r\n            this.metadataRef.compress = false;\r\n            this.metadataRef.write(Buffer.from(this.metadata.getXML(), 'utf-8'));\r\n            this.metadataRef.end();\r\n            this._root.data.Metadata = this.metadataRef;\r\n        }\r\n    }\r\n}","/*\r\nPDFDocument - represents an entire PDF document\r\nBy Devon Govett\r\n*/\r\n\r\nimport stream from 'stream';\r\nimport PDFObject from './object';\r\nimport PDFReference from './reference';\r\nimport PDFPage from './page';\r\nimport PDFNameTree from './name_tree';\r\nimport PDFSecurity from './security';\r\nimport ColorMixin from './mixins/color';\r\nimport VectorMixin from './mixins/vector';\r\nimport FontsMixin from './mixins/fonts';\r\nimport TextMixin from './mixins/text';\r\nimport ImagesMixin from './mixins/images';\r\nimport AnnotationsMixin from './mixins/annotations';\r\nimport OutlineMixin from './mixins/outline';\r\nimport MarkingsMixin from './mixins/markings';\r\nimport AcroFormMixin from './mixins/acroform';\r\nimport AttachmentsMixin from './mixins/attachments';\r\nimport LineWrapper from './line_wrapper';\r\nimport SubsetMixin from './mixins/subsets';\r\nimport MetadataMixin from './mixins/metadata';\r\n\r\nclass PDFDocument extends stream.Readable {\r\n  constructor(options = {}) {\r\n    super(options);\r\n    this.options = options;\r\n\r\n    // PDF version\r\n    switch (options.pdfVersion) {\r\n      case '1.4':\r\n        this.version = 1.4;\r\n        break;\r\n      case '1.5':\r\n        this.version = 1.5;\r\n        break;\r\n      case '1.6':\r\n        this.version = 1.6;\r\n        break;\r\n      case '1.7':\r\n      case '1.7ext3':\r\n        this.version = 1.7;\r\n        break;\r\n      default:\r\n        this.version = 1.3;\r\n        break;\r\n    }\r\n\r\n    // Whether streams should be compressed\r\n    this.compress =\r\n      this.options.compress != null ? this.options.compress : true;\r\n\r\n    this._pageBuffer = [];\r\n    this._pageBufferStart = 0;\r\n\r\n    // The PDF object store\r\n    this._offsets = [];\r\n    this._waiting = 0;\r\n    this._ended = false;\r\n    this._offset = 0;\r\n    const Pages = this.ref({\r\n      Type: 'Pages',\r\n      Count: 0,\r\n      Kids: []\r\n    });\r\n\r\n    const Names = this.ref({\r\n      Dests: new PDFNameTree()\r\n    });\r\n\r\n    this._root = this.ref({\r\n      Type: 'Catalog',\r\n      Pages,\r\n      Names\r\n    });\r\n\r\n    if (this.options.lang) {\r\n      this._root.data.Lang = new String(this.options.lang);\r\n    }\r\n\r\n    // The current page\r\n    this.page = null;\r\n\r\n    // Initialize mixins\r\n    this.initMetadata();\r\n    this.initColor();\r\n    this.initVector();\r\n    this.initFonts(options.font);\r\n    this.initText();\r\n    this.initImages();\r\n    this.initOutline();\r\n    this.initMarkings(options);\r\n    this.initSubset(options);\r\n\r\n    // Initialize the metadata\r\n    this.info = {\r\n      Producer: 'PDFKit',\r\n      Creator: 'PDFKit',\r\n      CreationDate: new Date()\r\n    };\r\n\r\n    if (this.options.info) {\r\n      for (let key in this.options.info) {\r\n        const val = this.options.info[key];\r\n        this.info[key] = val;\r\n      }\r\n    }\r\n\r\n    if (this.options.displayTitle) {\r\n      this._root.data.ViewerPreferences = this.ref({\r\n        DisplayDocTitle: true\r\n      });\r\n    }\r\n\r\n    // Generate file ID\r\n    this._id = PDFSecurity.generateFileID(this.info);\r\n\r\n    // Initialize security settings\r\n    this._security = PDFSecurity.create(this, options);\r\n\r\n    // Write the header\r\n    // PDF version\r\n    this._write(`%PDF-${this.version}`);\r\n\r\n    // 4 binary chars, as recommended by the spec\r\n    this._write('%\\xFF\\xFF\\xFF\\xFF');\r\n\r\n    // Add the first page\r\n    if (this.options.autoFirstPage !== false) {\r\n      this.addPage();\r\n    }\r\n  }\r\n\r\n  addPage(options) {\r\n    if (options == null) {\r\n      ({ options } = this);\r\n    }\r\n\r\n    // end the current page if needed\r\n    if (!this.options.bufferPages) {\r\n      this.flushPages();\r\n    }\r\n\r\n    // create a page object\r\n    this.page = new PDFPage(this, options);\r\n    this._pageBuffer.push(this.page);\r\n\r\n    // add the page to the object store\r\n    const pages = this._root.data.Pages.data;\r\n    pages.Kids.push(this.page.dictionary);\r\n    pages.Count++;\r\n\r\n    // reset x and y coordinates\r\n    this.x = this.page.margins.left;\r\n    this.y = this.page.margins.top;\r\n\r\n    // flip PDF coordinate system so that the origin is in\r\n    // the top left rather than the bottom left\r\n    this._ctm = [1, 0, 0, 1, 0, 0];\r\n    this.transform(1, 0, 0, -1, 0, this.page.height);\r\n\r\n    this.emit('pageAdded');\r\n\r\n    return this;\r\n  }\r\n\r\n  continueOnNewPage(options) {\r\n    const pageMarkings = this.endPageMarkings(this.page);\r\n\r\n    this.addPage(options);\r\n\r\n    this.initPageMarkings(pageMarkings);\r\n\r\n    return this;\r\n  }\r\n\r\n  bufferedPageRange() {\r\n    return { start: this._pageBufferStart, count: this._pageBuffer.length };\r\n  }\r\n\r\n  switchToPage(n) {\r\n    let page;\r\n    if (!(page = this._pageBuffer[n - this._pageBufferStart])) {\r\n      throw new Error(\r\n        `switchToPage(${n}) out of bounds, current buffer covers pages ${\r\n          this._pageBufferStart\r\n        } to ${this._pageBufferStart + this._pageBuffer.length - 1}`\r\n      );\r\n    }\r\n\r\n    return (this.page = page);\r\n  }\r\n\r\n  flushPages() {\r\n    // this local variable exists so we're future-proof against\r\n    // reentrant calls to flushPages.\r\n    const pages = this._pageBuffer;\r\n    this._pageBuffer = [];\r\n    this._pageBufferStart += pages.length;\r\n    for (let page of pages) {\r\n      this.endPageMarkings(page);\r\n      page.end();\r\n    }\r\n  }\r\n\r\n  addNamedDestination(name, ...args) {\r\n    if (args.length === 0) {\r\n      args = ['XYZ', null, null, null];\r\n    }\r\n    if (args[0] === 'XYZ' && args[2] !== null) {\r\n      args[2] = this.page.height - args[2];\r\n    }\r\n    args.unshift(this.page.dictionary);\r\n    this._root.data.Names.data.Dests.add(name, args);\r\n  }\r\n\r\n  addNamedEmbeddedFile(name, ref) {\r\n    if (!this._root.data.Names.data.EmbeddedFiles) {\r\n      // disabling /Limits for this tree fixes attachments not showing in Adobe Reader\r\n      this._root.data.Names.data.EmbeddedFiles = new PDFNameTree({\r\n        limits: false\r\n      });\r\n    }\r\n\r\n    // add filespec to EmbeddedFiles\r\n    this._root.data.Names.data.EmbeddedFiles.add(name, ref);\r\n  }\r\n\r\n  addNamedJavaScript(name, js) {\r\n    if (!this._root.data.Names.data.JavaScript) {\r\n      this._root.data.Names.data.JavaScript = new PDFNameTree();\r\n    }\r\n    let data = {\r\n      JS: new String(js),\r\n      S: 'JavaScript'\r\n    };\r\n    this._root.data.Names.data.JavaScript.add(name, data);\r\n  }\r\n\r\n  ref(data) {\r\n    const ref = new PDFReference(this, this._offsets.length + 1, data);\r\n    this._offsets.push(null); // placeholder for this object's offset once it is finalized\r\n    this._waiting++;\r\n    return ref;\r\n  }\r\n\r\n  _read() {}\r\n  // do nothing, but this method is required by node\r\n\r\n  _write(data) {\r\n    if (!Buffer.isBuffer(data)) {\r\n      data = Buffer.from(data + '\\n', 'binary');\r\n    }\r\n\r\n    this.push(data);\r\n    return (this._offset += data.length);\r\n  }\r\n\r\n  addContent(data) {\r\n    this.page.write(data);\r\n    return this;\r\n  }\r\n\r\n  _refEnd(ref) {\r\n    this._offsets[ref.id - 1] = ref.offset;\r\n    if (--this._waiting === 0 && this._ended) {\r\n      this._finalize();\r\n      return (this._ended = false);\r\n    }\r\n  }\r\n\r\n  end() {\r\n    this.flushPages();\r\n\r\n    this._info = this.ref();\r\n    for (let key in this.info) {\r\n      let val = this.info[key];\r\n      if (typeof val === 'string') {\r\n        val = new String(val);\r\n      }\r\n\r\n      let entry = this.ref(val);\r\n      entry.end();\r\n\r\n      this._info.data[key] = entry;\r\n    }\r\n\r\n    this._info.end();\r\n\r\n    for (let name in this._fontFamilies) {\r\n      const font = this._fontFamilies[name];\r\n      font.finalize();\r\n    }\r\n\r\n    this.endOutline();\r\n    this.endMarkings();\r\n\r\n    if (this.subset) {\r\n      this.endSubset();\r\n    }\r\n\r\n    this.endMetadata();\r\n\r\n    this._root.end();\r\n    this._root.data.Pages.end();\r\n    this._root.data.Names.end();\r\n    this.endAcroForm();\r\n\r\n    if (this._root.data.ViewerPreferences) {\r\n      this._root.data.ViewerPreferences.end();\r\n    }\r\n\r\n    if (this._security) {\r\n      this._security.end();\r\n    }\r\n\r\n    if (this._waiting === 0) {\r\n      return this._finalize();\r\n    } else {\r\n      return (this._ended = true);\r\n    }\r\n  }\r\n\r\n  _finalize() {\r\n    // generate xref\r\n    const xRefOffset = this._offset;\r\n    this._write('xref');\r\n    this._write(`0 ${this._offsets.length + 1}`);\r\n    this._write('0000000000 65535 f ');\r\n\r\n    for (let offset of this._offsets) {\r\n      offset = `0000000000${offset}`.slice(-10);\r\n      this._write(offset + ' 00000 n ');\r\n    }\r\n\r\n    // trailer\r\n    const trailer = {\r\n      Size: this._offsets.length + 1,\r\n      Root: this._root,\r\n      Info: this._info,\r\n      ID: [this._id, this._id]\r\n    };\r\n    if (this._security) {\r\n      trailer.Encrypt = this._security.dictionary;\r\n    }\r\n\r\n    this._write('trailer');\r\n    this._write(PDFObject.convert(trailer));\r\n\r\n    this._write('startxref');\r\n    this._write(`${xRefOffset}`);\r\n    this._write('%%EOF');\r\n\r\n    // end the stream\r\n    return this.push(null);\r\n  }\r\n\r\n  toString() {\r\n    return '[object PDFDocument]';\r\n  }\r\n}\r\n\r\nconst mixin = methods => {\r\n  Object.assign(PDFDocument.prototype, methods);\r\n};\r\n\r\nmixin(MetadataMixin);\r\nmixin(ColorMixin);\r\nmixin(VectorMixin);\r\nmixin(FontsMixin);\r\nmixin(TextMixin);\r\nmixin(ImagesMixin);\r\nmixin(AnnotationsMixin);\r\nmixin(OutlineMixin);\r\nmixin(MarkingsMixin);\r\nmixin(AcroFormMixin);\r\nmixin(AttachmentsMixin);\r\nmixin(SubsetMixin);\r\n\r\nPDFDocument.LineWrapper = LineWrapper;\r\n\r\nexport default PDFDocument;\r\n"],"mappings":";;;;;;;;;;AAAA;AACA;AACA;;AAEA,MAAMA,oBAAoB,CAAC;EACzBC,QAAQA,CAAA,EAAG;IACT,MAAM,IAAIC,KAAK,CAAC,mCAAmC,CAAC;;AAExD;;ACRA;AACA;AACA;AAIA,MAAMC,OAAO,CAAC;EACZC,WAAWA,CAAA,EAAe;IAAA,IAAdC,OAAO,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,EAAE;IACtB,IAAI,CAACG,MAAM,GAAG,EAAE;;IAEhB,IAAI,CAACC,MAAM,GACT,OAAOL,OAAO,CAACK,MAAM,KAAK,SAAS,GAAGL,OAAO,CAACK,MAAM,GAAG,IAAI;;EAG/DC,GAAGA,CAACC,GAAG,EAAEC,GAAG,EAAE;IACZ,OAAQ,IAAI,CAACJ,MAAM,CAACG,GAAG,CAAC,GAAGC,GAAG;;EAGhCC,GAAGA,CAACF,GAAG,EAAE;IACP,OAAO,IAAI,CAACH,MAAM,CAACG,GAAG,CAAC;;EAGzBX,QAAQA,CAAA,EAAG;;IAET,MAAMc,UAAU,GAAGC,MAAM,CAACC,IAAI,CAAC,IAAI,CAACR,MAAM,CAAC,CAACS,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KACpD,IAAI,CAACC,YAAY,CAACF,CAAC,EAAEC,CAAC,CACxB,CAAC;IAED,MAAME,GAAG,GAAG,CAAC,IAAI,CAAC;IAClB,IAAI,IAAI,CAACZ,MAAM,IAAIK,UAAU,CAACR,MAAM,GAAG,CAAC,EAAE;MACxC,MAAMgB,KAAK,GAAGR,UAAU,CAAC,CAAC,CAAC;QACzBS,IAAI,GAAGT,UAAU,CAACA,UAAU,CAACR,MAAM,GAAG,CAAC,CAAC;MAC1Ce,GAAG,CAACG,IAAI,CACL,aAAYC,SAAS,CAACC,OAAO,CAAC,CAAC,IAAI,CAACC,WAAW,CAACL,KAAK,CAAC,EAAE,IAAI,CAACK,WAAW,CAACJ,IAAI,CAAC,CAAC,CAAE,EACpF,CAAC;;IAEHF,GAAG,CAACG,IAAI,CAAE,MAAK,IAAI,CAACI,SAAS,EAAG,IAAG,CAAC;IACpC,KAAK,IAAIjB,GAAG,IAAIG,UAAU,EAAE;MAC1BO,GAAG,CAACG,IAAI,CACL,OAAMC,SAAS,CAACC,OAAO,CAAC,IAAI,CAACC,WAAW,CAAChB,GAAG,CAAC,CAAE,IAAGc,SAAS,CAACC,OAAO,CAClE,IAAI,CAAClB,MAAM,CAACG,GAAG,CACjB,CAAE,EACJ,CAAC;;IAEHU,GAAG,CAACG,IAAI,CAAC,GAAG,CAAC;IACbH,GAAG,CAACG,IAAI,CAAC,IAAI,CAAC;IACd,OAAOH,GAAG,CAACQ,IAAI,CAAC,IAAI,CAAC;;EAGvBT,YAAYA,CAAA;EAAA,EAAW;IACrB,MAAM,IAAInB,KAAK,CAAC,mCAAmC,CAAC;;EAGtD2B,SAASA,CAAA,EAAG;IACV,MAAM,IAAI3B,KAAK,CAAC,mCAAmC,CAAC;;EAGtD0B,WAAWA,CAAA;EAAA,EAAQ;IACjB,MAAM,IAAI1B,KAAK,CAAC,mCAAmC,CAAC;;AAExD;;AC5DA;AACA;AACA;AACA;AAKA,MAAM6B,GAAG,GAAGA,CAACC,GAAG,EAAEzB,MAAM,KAAK,CAAC0B,KAAK,CAAC1B,MAAM,GAAG,CAAC,CAAC,CAACuB,IAAI,CAAC,GAAG,CAAC,GAAGE,GAAG,EAAEE,KAAK,CAAC,CAAC3B,MAAM,CAAC;AAE/E,MAAM4B,WAAW,GAAG,mBAAmB;AACvC,MAAMC,SAAS,GAAG;EAChB,IAAI,EAAE,KAAK;EACX,IAAI,EAAE,KAAK;EACX,IAAI,EAAE,KAAK;EACX,IAAI,EAAE,KAAK;EACX,IAAI,EAAE,KAAK;EACX,IAAI,EAAE,MAAM;EACZ,GAAG,EAAE,KAAK;EACV,GAAG,EAAE;AACP,CAAC;;AAED;AACA,MAAMC,SAAS,GAAG,SAAAA,CAASC,IAAI,EAAE;EAC/B,MAAMC,CAAC,GAAGD,IAAI,CAAC/B,MAAM;EACrB,IAAIgC,CAAC,GAAG,IAAI,EAAE;IACZ,MAAM,IAAIrC,KAAK,CAAC,4BAA4B,CAAC;GAC9C,MAAM;IACL,KAAK,IAAIsC,CAAC,GAAG,CAAC,EAAEC,GAAG,GAAGF,CAAC,GAAG,CAAC,EAAEC,CAAC,GAAGC,GAAG,EAAED,CAAC,IAAI,CAAC,EAAE;MAC5C,MAAMrB,CAAC,GAAGmB,IAAI,CAACE,CAAC,CAAC;MACjBF,IAAI,CAACE,CAAC,CAAC,GAAGF,IAAI,CAACE,CAAC,GAAG,CAAC,CAAC;MACrBF,IAAI,CAACE,CAAC,GAAG,CAAC,CAAC,GAAGrB,CAAC;;;EAInB,OAAOmB,IAAI;AACb,CAAC;AAED,MAAMZ,SAAS,CAAC;EACd,OAAOC,OAAOA,CAACe,MAAM,EAAoB;IAAA,IAAlBC,SAAS,GAAArC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,IAAI;;IAErC,IAAI,OAAOoC,MAAM,KAAK,QAAQ,EAAE;MAC9B,OAAQ,IAAGA,MAAO,EAAC;;;KAGpB,MAAM,IAAIA,MAAM,YAAYE,MAAM,EAAE;MACnC,IAAIC,MAAM,GAAGH,MAAM;;MAEnB,IAAII,SAAS,GAAG,KAAK;MACrB,KAAK,IAAIN,CAAC,GAAG,CAAC,EAAEC,GAAG,GAAGI,MAAM,CAACtC,MAAM,EAAEiC,CAAC,GAAGC,GAAG,EAAED,CAAC,EAAE,EAAE;QACjD,IAAIK,MAAM,CAACE,UAAU,CAACP,CAAC,CAAC,GAAG,IAAI,EAAE;UAC/BM,SAAS,GAAG,IAAI;UAChB;;;;;MAKJ,IAAIE,YAAY;MAChB,IAAIF,SAAS,EAAE;QACbE,YAAY,GAAGX,SAAS,CAACY,MAAM,CAACC,IAAI,CAAE,SAAQL,MAAO,EAAC,EAAE,SAAS,CAAC,CAAC;OACpE,MAAM;QACLG,YAAY,GAAGC,MAAM,CAACC,IAAI,CAACL,MAAM,CAACM,OAAO,EAAE,EAAE,OAAO,CAAC;;;;MAIvD,IAAIR,SAAS,EAAE;QACbE,MAAM,GAAGF,SAAS,CAACK,YAAY,CAAC,CAAC/C,QAAQ,CAAC,QAAQ,CAAC;OACpD,MAAM;QACL4C,MAAM,GAAGG,YAAY,CAAC/C,QAAQ,CAAC,QAAQ,CAAC;;;;MAI1C4C,MAAM,GAAGA,MAAM,CAACO,OAAO,CAACjB,WAAW,EAAEkB,CAAC,IAAIjB,SAAS,CAACiB,CAAC,CAAC,CAAC;MAEvD,OAAQ,IAAGR,MAAO,GAAE;;;KAGrB,MAAM,IAAII,MAAM,CAACK,QAAQ,CAACZ,MAAM,CAAC,EAAE;MAClC,OAAQ,IAAGA,MAAM,CAACzC,QAAQ,CAAC,KAAK,CAAE,GAAE;KACrC,MAAM,IACLyC,MAAM,YAAY1C,oBAAoB,IACtC0C,MAAM,YAAYvC,OAAO,EACzB;MACA,OAAOuC,MAAM,CAACzC,QAAQ,EAAE;KACzB,MAAM,IAAIyC,MAAM,YAAYa,IAAI,EAAE;MACjC,IAAIV,MAAM,GACP,KAAId,GAAG,CAACW,MAAM,CAACc,cAAc,EAAE,EAAE,CAAC,CAAE,EAAC,GACtCzB,GAAG,CAACW,MAAM,CAACe,WAAW,EAAE,GAAG,CAAC,EAAE,CAAC,CAAC,GAChC1B,GAAG,CAACW,MAAM,CAACgB,UAAU,EAAE,EAAE,CAAC,CAAC,GAC3B3B,GAAG,CAACW,MAAM,CAACiB,WAAW,EAAE,EAAE,CAAC,CAAC,GAC5B5B,GAAG,CAACW,MAAM,CAACkB,aAAa,EAAE,EAAE,CAAC,CAAC,GAC9B7B,GAAG,CAACW,MAAM,CAACmB,aAAa,EAAE,EAAE,CAAC,CAAC,GAC9B,GAAG;;;MAGL,IAAIlB,SAAS,EAAE;QACbE,MAAM,GAAGF,SAAS,CAACM,MAAM,CAACC,IAAI,CAACL,MAAM,EAAE,OAAO,CAAC,CAAC,CAAC5C,QAAQ,CAAC,QAAQ,CAAC;;;QAGnE4C,MAAM,GAAGA,MAAM,CAACO,OAAO,CAACjB,WAAW,EAAEkB,CAAC,IAAIjB,SAAS,CAACiB,CAAC,CAAC,CAAC;;MAGzD,OAAQ,IAAGR,MAAO,GAAE;KACrB,MAAM,IAAIZ,KAAK,CAAC6B,OAAO,CAACpB,MAAM,CAAC,EAAE;MAChC,MAAMqB,KAAK,GAAGrB,MAAM,CAACsB,GAAG,CAACC,CAAC,IAAIvC,SAAS,CAACC,OAAO,CAACsC,CAAC,EAAEtB,SAAS,CAAC,CAAC,CAACb,IAAI,CAAC,GAAG,CAAC;MACxE,OAAQ,IAAGiC,KAAM,GAAE;KACpB,MAAM,IAAI,EAAE,CAAC9D,QAAQ,CAACiE,IAAI,CAACxB,MAAM,CAAC,KAAK,iBAAiB,EAAE;MACzD,MAAMpB,GAAG,GAAG,CAAC,IAAI,CAAC;MAClB,KAAK,IAAIV,GAAG,IAAI8B,MAAM,EAAE;QACtB,MAAM7B,GAAG,GAAG6B,MAAM,CAAC9B,GAAG,CAAC;QACvBU,GAAG,CAACG,IAAI,CAAE,IAAGb,GAAI,IAAGc,SAAS,CAACC,OAAO,CAACd,GAAG,EAAE8B,SAAS,CAAE,EAAC,CAAC;;MAG1DrB,GAAG,CAACG,IAAI,CAAC,IAAI,CAAC;MACd,OAAOH,GAAG,CAACQ,IAAI,CAAC,IAAI,CAAC;KACtB,MAAM,IAAI,OAAOY,MAAM,KAAK,QAAQ,EAAE;MACrC,OAAOhB,SAAS,CAACyC,MAAM,CAACzB,MAAM,CAAC;KAChC,MAAM;MACL,OAAQ,GAAEA,MAAO,EAAC;;;EAItB,OAAOyB,MAAMA,CAACC,CAAC,EAAE;IACf,IAAIA,CAAC,GAAG,CAAC,IAAI,IAAIA,CAAC,GAAG,IAAI,EAAE;MACzB,OAAOC,IAAI,CAACC,KAAK,CAACF,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG;;IAGlC,MAAM,IAAIlE,KAAK,CAAE,uBAAsBkE,CAAE,EAAC,CAAC;;AAE/C;;ACjIA;AACA;AACA;AACA;AAMA,MAAMG,YAAY,SAASvE,oBAAoB,CAAC;EAC9CI,WAAWA,CAACoE,QAAQ,EAAEC,EAAE,EAAa;IAAA,IAAXC,IAAI,GAAApE,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,EAAE;IACjC,KAAK,EAAE;IACP,IAAI,CAACkE,QAAQ,GAAGA,QAAQ;IACxB,IAAI,CAACC,EAAE,GAAGA,EAAE;IACZ,IAAI,CAACC,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACC,GAAG,GAAG,CAAC;IACZ,IAAI,CAACC,QAAQ,GAAG,IAAI,CAACJ,QAAQ,CAACI,QAAQ,IAAI,CAAC,IAAI,CAACF,IAAI,CAACG,MAAM;IAC3D,IAAI,CAACC,kBAAkB,GAAG,CAAC;IAC3B,IAAI,CAACC,MAAM,GAAG,EAAE;;EAGlBC,KAAKA,CAACC,KAAK,EAAE;IACX,IAAI,CAAChC,MAAM,CAACK,QAAQ,CAAC2B,KAAK,CAAC,EAAE;MAC3BA,KAAK,GAAGhC,MAAM,CAACC,IAAI,CAAC+B,KAAK,GAAG,IAAI,EAAE,QAAQ,CAAC;;IAG7C,IAAI,CAACH,kBAAkB,IAAIG,KAAK,CAAC1E,MAAM;IACvC,IAAI,IAAI,CAACmE,IAAI,CAACQ,MAAM,IAAI,IAAI,EAAE;MAC5B,IAAI,CAACR,IAAI,CAACQ,MAAM,GAAG,CAAC;;IAEtB,IAAI,CAACH,MAAM,CAACtD,IAAI,CAACwD,KAAK,CAAC;IACvB,IAAI,CAACP,IAAI,CAACQ,MAAM,IAAID,KAAK,CAAC1E,MAAM;IAChC,IAAI,IAAI,CAACqE,QAAQ,EAAE;MACjB,OAAQ,IAAI,CAACF,IAAI,CAACG,MAAM,GAAG,aAAa;;;EAI5CpC,GAAGA,CAACwC,KAAK,EAAE;IACT,IAAIA,KAAK,EAAE;MACT,IAAI,CAACD,KAAK,CAACC,KAAK,CAAC;;IAEnB,OAAO,IAAI,CAACE,QAAQ,EAAE;;EAGxBA,QAAQA,CAAA,EAAG;IACT,IAAI,CAACC,MAAM,GAAG,IAAI,CAACZ,QAAQ,CAACa,OAAO;IAEnC,MAAM1C,SAAS,GAAG,IAAI,CAAC6B,QAAQ,CAACc,SAAS,GACrC,IAAI,CAACd,QAAQ,CAACc,SAAS,CAACC,YAAY,CAAC,IAAI,CAACd,EAAE,EAAE,IAAI,CAACE,GAAG,CAAC,GACvD,IAAI;IAER,IAAI,IAAI,CAACI,MAAM,CAACxE,MAAM,EAAE;MACtB,IAAI,CAACwE,MAAM,GAAG9B,MAAM,CAACuC,MAAM,CAAC,IAAI,CAACT,MAAM,CAAC;MACxC,IAAI,IAAI,CAACH,QAAQ,EAAE;QACjB,IAAI,CAACG,MAAM,GAAGU,IAAI,CAACC,WAAW,CAAC,IAAI,CAACX,MAAM,CAAC;;MAG7C,IAAIpC,SAAS,EAAE;QACb,IAAI,CAACoC,MAAM,GAAGpC,SAAS,CAAC,IAAI,CAACoC,MAAM,CAAC;;MAGtC,IAAI,CAACL,IAAI,CAACQ,MAAM,GAAG,IAAI,CAACH,MAAM,CAACxE,MAAM;;IAGvC,IAAI,CAACiE,QAAQ,CAACmB,MAAM,CAAE,GAAE,IAAI,CAAClB,EAAG,IAAG,IAAI,CAACE,GAAI,MAAK,CAAC;IAClD,IAAI,CAACH,QAAQ,CAACmB,MAAM,CAACjE,SAAS,CAACC,OAAO,CAAC,IAAI,CAAC+C,IAAI,EAAE/B,SAAS,CAAC,CAAC;IAE7D,IAAI,IAAI,CAACoC,MAAM,CAACxE,MAAM,EAAE;MACtB,IAAI,CAACiE,QAAQ,CAACmB,MAAM,CAAC,QAAQ,CAAC;MAC9B,IAAI,CAACnB,QAAQ,CAACmB,MAAM,CAAC,IAAI,CAACZ,MAAM,CAAC;MAEjC,IAAI,CAACA,MAAM,GAAG,EAAE,CAAC;MACjB,IAAI,CAACP,QAAQ,CAACmB,MAAM,CAAC,aAAa,CAAC;;IAGrC,IAAI,CAACnB,QAAQ,CAACmB,MAAM,CAAC,QAAQ,CAAC;IAC9B,IAAI,CAACnB,QAAQ,CAACoB,OAAO,CAAC,IAAI,CAAC;;EAE7B3F,QAAQA,CAAA,EAAG;IACT,OAAQ,GAAE,IAAI,CAACwE,EAAG,IAAG,IAAI,CAACE,GAAI,IAAG;;AAErC;;ACjFA;AACA;AACA;AACA;;AAEA,MAAMkB,eAAe,GAAG;EACtBC,GAAG,EAAE,EAAE;EACPC,IAAI,EAAE,EAAE;EACRC,MAAM,EAAE,EAAE;EACVC,KAAK,EAAE;AACT,CAAC;AAED,MAAMC,KAAK,GAAG;EACZ,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;EACzB,KAAK,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;EACzBC,EAAE,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;EACtBC,EAAE,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;EACtBC,EAAE,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;EACtBC,EAAE,EAAE,CAAC,MAAM,EAAE,OAAO,CAAC;EACrBC,EAAE,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC;EACpBC,EAAE,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC;EACpBC,EAAE,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC;EACpBC,EAAE,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC;EACpBC,EAAE,EAAE,CAAC,KAAK,EAAE,MAAM,CAAC;EACnBC,EAAE,EAAE,CAAC,MAAM,EAAE,KAAK,CAAC;EACnBC,GAAG,EAAE,CAAC,IAAI,EAAE,MAAM,CAAC;EACnBC,EAAE,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;EACtBC,EAAE,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;EACtBC,EAAE,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;EACtBC,EAAE,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;EACtBC,EAAE,EAAE,CAAC,MAAM,EAAE,OAAO,CAAC;EACrBC,EAAE,EAAE,CAAC,KAAK,EAAE,MAAM,CAAC;EACnBC,EAAE,EAAE,CAAC,MAAM,EAAE,KAAK,CAAC;EACnBC,EAAE,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC;EACpBC,EAAE,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC;EACpBC,EAAE,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC;EACpBC,GAAG,EAAE,CAAC,KAAK,EAAE,MAAM,CAAC;EACpBC,EAAE,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;EACtBC,EAAE,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;EACtBC,EAAE,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;EACtBC,EAAE,EAAE,CAAC,MAAM,EAAE,OAAO,CAAC;EACrBC,EAAE,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC;EACpBC,EAAE,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC;EACpBC,EAAE,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC;EACpBC,EAAE,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC;EACpBC,EAAE,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC;EACpBC,EAAE,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC;EACpBC,GAAG,EAAE,CAAC,KAAK,EAAE,MAAM,CAAC;EACpBC,GAAG,EAAE,CAAC,MAAM,EAAE,OAAO,CAAC;EACtBC,GAAG,EAAE,CAAC,OAAO,EAAE,MAAM,CAAC;EACtBC,GAAG,EAAE,CAAC,MAAM,EAAE,OAAO,CAAC;EACtBC,GAAG,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC;EACrBC,GAAG,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC;EACrBC,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;EACxBC,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;EACxBC,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;EACxBC,IAAI,EAAE,CAAC,MAAM,EAAE,OAAO,CAAC;EACvBC,IAAI,EAAE,CAAC,KAAK,EAAE,MAAM,CAAC;EACrBC,SAAS,EAAE,CAAC,MAAM,EAAE,KAAK,CAAC;EAC1BC,KAAK,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;EACrBC,KAAK,EAAE,CAAC,KAAK,EAAE,MAAM,CAAC;EACtBC,MAAM,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;EACtBC,OAAO,EAAE,CAAC,KAAK,EAAE,MAAM;AACzB,CAAC;AAED,MAAMC,OAAO,CAAC;EACZ/I,WAAWA,CAACoE,QAAQ,EAAgB;IAAA,IAAdnE,OAAO,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,EAAE;IAChC,IAAI,CAACkE,QAAQ,GAAGA,QAAQ;IACxB,IAAI,CAAC4E,IAAI,GAAG/I,OAAO,CAAC+I,IAAI,IAAI,QAAQ;IACpC,IAAI,CAACC,MAAM,GAAGhJ,OAAO,CAACgJ,MAAM,IAAI,UAAU;;;IAG1C,IAAI,OAAOhJ,OAAO,CAACiJ,MAAM,KAAK,QAAQ,EAAE;MACtC,IAAI,CAACC,OAAO,GAAG;QACbzD,GAAG,EAAEzF,OAAO,CAACiJ,MAAM;QACnBvD,IAAI,EAAE1F,OAAO,CAACiJ,MAAM;QACpBtD,MAAM,EAAE3F,OAAO,CAACiJ,MAAM;QACtBrD,KAAK,EAAE5F,OAAO,CAACiJ;OAChB;;;KAGF,MAAM;MACL,IAAI,CAACC,OAAO,GAAGlJ,OAAO,CAACkJ,OAAO,IAAI1D,eAAe;;;;IAInD,MAAM2D,UAAU,GAAGvH,KAAK,CAAC6B,OAAO,CAAC,IAAI,CAACsF,IAAI,CAAC,GACvC,IAAI,CAACA,IAAI,GACTlD,KAAK,CAAC,IAAI,CAACkD,IAAI,CAACK,WAAW,EAAE,CAAC;IAClC,IAAI,CAACC,KAAK,GAAGF,UAAU,CAAC,IAAI,CAACH,MAAM,KAAK,UAAU,GAAG,CAAC,GAAG,CAAC,CAAC;IAC3D,IAAI,CAACM,MAAM,GAAGH,UAAU,CAAC,IAAI,CAACH,MAAM,KAAK,UAAU,GAAG,CAAC,GAAG,CAAC,CAAC;IAE5D,IAAI,CAACO,OAAO,GAAG,IAAI,CAACpF,QAAQ,CAACqF,GAAG,EAAE;;;IAGlC,IAAI,CAACC,SAAS,GAAG,IAAI,CAACtF,QAAQ,CAACqF,GAAG,CAAC;MACjCE,OAAO,EAAE,CAAC,KAAK,EAAE,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ;KACtD,CAAC;;;IAGF,IAAI,CAACC,UAAU,GAAG,IAAI,CAACxF,QAAQ,CAACqF,GAAG,CAAC;MAClCI,IAAI,EAAE,MAAM;MACZC,MAAM,EAAE,IAAI,CAAC1F,QAAQ,CAAC2F,KAAK,CAACzF,IAAI,CAAC0F,KAAK;MACtCC,QAAQ,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAACX,KAAK,EAAE,IAAI,CAACC,MAAM,CAAC;MACzCW,QAAQ,EAAE,IAAI,CAACV,OAAO;MACtBW,SAAS,EAAE,IAAI,CAACT;KACjB,CAAC;IAEF,IAAI,CAACU,QAAQ,GAAG,EAAE;;;;EAIpB,IAAIC,KAAKA,CAAA,EAAG;IACV,MAAM/F,IAAI,GAAG,IAAI,CAACoF,SAAS,CAACpF,IAAI;IAChC,OAAOA,IAAI,CAACgG,IAAI,IAAI,IAAI,GAAGhG,IAAI,CAACgG,IAAI,GAAIhG,IAAI,CAACgG,IAAI,GAAG,EAAG;;EAGzD,IAAIC,QAAQA,CAAA,EAAG;IACb,MAAMjG,IAAI,GAAG,IAAI,CAACoF,SAAS,CAACpF,IAAI;IAChC,OAAOA,IAAI,CAACkG,OAAO,IAAI,IAAI,GAAGlG,IAAI,CAACkG,OAAO,GAAIlG,IAAI,CAACkG,OAAO,GAAG,EAAG;;EAGlE,IAAIC,WAAWA,CAAA,EAAG;IAChB,MAAMnG,IAAI,GAAG,IAAI,CAACoF,SAAS,CAACpF,IAAI;IAChC,OAAOA,IAAI,CAACoG,SAAS,IAAI,IAAI,GAAGpG,IAAI,CAACoG,SAAS,GAAIpG,IAAI,CAACoG,SAAS,GAAG,EAAG;;EAGxE,IAAIC,QAAQA,CAAA,EAAG;IACb,MAAMrG,IAAI,GAAG,IAAI,CAACoF,SAAS,CAACpF,IAAI;IAChC,OAAOA,IAAI,CAACsG,OAAO,IAAI,IAAI,GAAGtG,IAAI,CAACsG,OAAO,GAAItG,IAAI,CAACsG,OAAO,GAAG,EAAG;;EAGlE,IAAIC,WAAWA,CAAA,EAAG;IAChB,MAAMvG,IAAI,GAAG,IAAI,CAACoF,SAAS,CAACpF,IAAI;IAChC,OAAOA,IAAI,CAACwG,UAAU,KAAKxG,IAAI,CAACwG,UAAU,GAAG,EAAE,CAAC;;EAGlD,IAAIC,WAAWA,CAAA,EAAG;IAChB,MAAMzG,IAAI,GAAG,IAAI,CAACsF,UAAU,CAACtF,IAAI;IACjC,OAAOA,IAAI,CAAC0G,MAAM,IAAI,IAAI,GAAG1G,IAAI,CAAC0G,MAAM,GAAI1G,IAAI,CAAC0G,MAAM,GAAG,EAAG;;EAG/D,IAAIC,mBAAmBA,CAAA,EAAG;IACxB,MAAM3G,IAAI,GAAG,IAAI,CAACsF,UAAU,CAACtF,IAAI;IACjC,OAAOA,IAAI,CAAC4G,aAAa,IAAI,IAAI,GAC7B5G,IAAI,CAAC4G,aAAa,GACjB5G,IAAI,CAAC4G,aAAa,GAAG,IAAI,CAAC9G,QAAQ,CAAC+G,6BAA6B,EAAG;;EAG1EC,IAAIA,CAAA,EAAG;IACL,OAAO,IAAI,CAAC7B,MAAM,GAAG,IAAI,CAACJ,OAAO,CAACvD,MAAM;;EAG1ChB,KAAKA,CAACC,KAAK,EAAE;IACX,OAAO,IAAI,CAAC2E,OAAO,CAAC5E,KAAK,CAACC,KAAK,CAAC;;EAGlCxC,GAAGA,CAAA,EAAG;IACJ,IAAI,CAACuH,UAAU,CAACvH,GAAG,EAAE;IACrB,IAAI,CAACqH,SAAS,CAACrH,GAAG,EAAE;IACpB,OAAO,IAAI,CAACmH,OAAO,CAACnH,GAAG,EAAE;;AAE7B;;AClKA;AACA;AACA;AAIA,MAAMgJ,WAAW,SAAStL,OAAO,CAAC;EAChCkB,YAAYA,CAACF,CAAC,EAAEC,CAAC,EAAE;IACjB,OAAOD,CAAC,CAACuK,aAAa,CAACtK,CAAC,CAAC;;EAG3BS,SAASA,CAAA,EAAG;IACV,OAAO,OAAO;;EAGhBD,WAAWA,CAAC+J,CAAC,EAAE;IACb,OAAO,IAAI/I,MAAM,CAAC+I,CAAC,CAAC;;AAExB;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,OAAOA,CAACC,KAAK,EAAEC,UAAU,EAAE;EAClC,IAAID,KAAK,GAAGC,UAAU,CAAC,CAAC,CAAC,EAAE,OAAO,KAAK;EACvC,IAAIC,UAAU,GAAG,CAAC;EAClB,IAAIC,QAAQ,GAAGF,UAAU,CAACvL,MAAM,GAAG,CAAC;EACpC,OAAOwL,UAAU,IAAIC,QAAQ,EAAE;IAC7B,MAAMC,WAAW,GAAG5H,IAAI,CAAC6H,KAAK,CAAC,CAACH,UAAU,GAAGC,QAAQ,IAAI,CAAC,CAAC;;;IAG3D,MAAMG,UAAU,GAAGF,WAAW,GAAG,CAAC;;;IAGlC,IACEJ,KAAK,IAAIC,UAAU,CAACK,UAAU,CAAC,IAC/BN,KAAK,IAAIC,UAAU,CAACK,UAAU,GAAG,CAAC,CAAC,EACnC;MACA,OAAO,IAAI;;IAGb,IAAIN,KAAK,GAAGC,UAAU,CAACK,UAAU,GAAG,CAAC,CAAC,EAAE;;MAEtCJ,UAAU,GAAGE,WAAW,GAAG,CAAC;KAC7B,MAAM;;MAELD,QAAQ,GAAGC,WAAW,GAAG,CAAC;;;EAG9B,OAAO,KAAK;AACd;;AC/BA;AACA;AACA;AACA;AACA;AACA,MAAMG,sBAAsB,GAAG,CAC7B,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,CACR;AACD;;AAEA,MAAMC,qBAAqB,GAAGC,SAAS,IACrCV,OAAO,CAACU,SAAS,EAAEF,sBAAsB,CAAC;;AAE5C;AACA;AACA;AACA;AACA;AACA,MAAMG,0BAA0B,GAAG,CACjC,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,CACP;AACD;;AAEA,MAAMC,yBAAyB,GAAGF,SAAS,IACzCV,OAAO,CAACU,SAAS,EAAEC,0BAA0B,CAAC;;AAEhD;AACA;AACA;AACA;AACA;AACA,MAAME,0BAA0B,GAAG,CACjC,MAAM,EACN,MAAM,uBACN,MAAM,EACN,MAAM,yBACN,MAAM,EACN,MAAM,gBACN,MAAM,EACN,MAAM,gBACN,MAAM,EACN,MAAM,iBACN,MAAM,EACN,MAAM,iBACN,MAAM,EACN,MAAM,2BACN,MAAM,EACN,MAAM,0BACN,MAAM,EACN,MAAM,yBACN,MAAM,EACN,MAAM,qBACN,MAAM,EACN,MAAM,0BACN,MAAM,EACN,MAAM,mBACN,MAAM,EACN,MAAM,mBACN,MAAM,EACN,MAAM,yBACN,MAAM,EACN,MAAM,8BACN,MAAM,EACN,MAAM,kCACN,MAAM,EACN,MAAM,yBACP;AACD;;AAEA,MAAMC,wBAAwB,GAAGJ,SAAS,IACxCV,OAAO,CAACU,SAAS,EAAEG,0BAA0B,CAAC;;AAEhD;AACA,MAAME,6BAA6B,GAAG;AACpC;AACF;AACA;AACA;AACE,MAAM,EACN,MAAM,6BACN,MAAM,EACN,MAAM,2BACN,MAAM,EACN,MAAM,iCACN,MAAM,EACN,MAAM,kCACN,MAAM,EACN,MAAM,8BACN,MAAM,EACN,MAAM,0BACN,MAAM,EACN,MAAM,uBACN,MAAM,EACN,MAAM,4BACN,MAAM,EACN,MAAM,oBACN,MAAM,EACN,MAAM,6BACN,MAAM,EACN,MAAM,wBACN,MAAM,EACN,MAAM,4BACN,MAAM,EACN,MAAM,6BACN,MAAM,EACN,MAAM,kCACN,MAAM,EACN,MAAM,6BACN,OAAO,EACP,OAAO,oCACR;AAED,MAAMC,wBAAwB,GAAG;AAC/B;AACF;AACA;AACA;AACE,MAAM,EACN,MAAM,mCACN,MAAM,EACN,MAAM,mCACN,OAAO,EACP,OAAO,mCACP,OAAO,EACP,OAAO,mCACP,OAAO,EACP,OAAO,mCACP,OAAO,EACP,OAAO,mCACP,OAAO,EACP,OAAO,mCACP,OAAO,EACP,OAAO,mCACP,OAAO,EACP,OAAO,mCACP,OAAO,EACP,OAAO,mCACP,OAAO,EACP,OAAO,mCACP,OAAO,EACP,OAAO,mCACP,OAAO,EACP,OAAO,mCACP,OAAO,EACP,OAAO,mCACP,OAAO,EACP,OAAO,mCACP,OAAO,EACP,OAAO,mCACP,QAAQ,EACR,QAAQ,kCACT;;AAED;AACA;AACA;AACA,MAAMC,qBAAqB,GAAG;AAC5B;AACF;AACA;AACA;AACE,CAAC,EACD,MAAM,6BACN,MAAM,EACN,MAAM;AAEN;AACF;AACA;AACA;AACE,MAAM,EACN,MAAM,kCACN,MAAM,EACN,MAAM,kCACN,MAAM,EACN,MAAM,2BACN,MAAM,EACN,MAAM,2BACN,MAAM,EACN,MAAM,gCACN,MAAM,EACN,MAAM,gCACN,MAAM,EACN,MAAM,mCACN,MAAM,EACN,MAAM,+BACN,MAAM,EACN,MAAM,+BACN,MAAM,EACN,MAAM,mCACN,MAAM,EACN,MAAM,oCACN,MAAM,EACN,MAAM,oCACN,MAAM,EACN,MAAM,qCACN,MAAM,EACN,MAAM,8BACN,MAAM,EACN,MAAM;AAEN;AACF;AACA;AACA;AACE,MAAM,EACN,MAAM;AAEN;AACF;AACA;AACA;AACE,MAAM,EACN,MAAM;AAEN;AACF;AACA;AACA;AACE,MAAM,EACN,MAAM;AAEN;AACF;AACA;AACA;AACE,MAAM,EACN,MAAM,sCACN,MAAM,EACN,MAAM,yCACN,MAAM,EACN,MAAM,0CACN,MAAM,EACN,MAAM,qCACN,MAAM,EACN,MAAM;AAEN;AACF;AACA;AACA;AACE,OAAO,EACP,OAAO,qBACP,OAAO,EACP,OAAO;AAEP;AACF;AACA;AACA;;AAEE,OAAO,EACP,OAAO,gCACP,QAAQ,EACR,QAAQ,+BACT;AACD;;AAEA,MAAMC,qBAAqB,GAAGR,SAAS,IACrCV,OAAO,CAACU,SAAS,EAAEG,0BAA0B,CAAC,IAC9Cb,OAAO,CAACU,SAAS,EAAEO,qBAAqB,CAAC,IACzCjB,OAAO,CAACU,SAAS,EAAEK,6BAA6B,CAAC,IACjDf,OAAO,CAACU,SAAS,EAAEM,wBAAwB,CAAC;;AAE9C;AACA;AACA;AACA;AACA;AACA,MAAMG,kBAAkB,GAAG,CACzB,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,CACP;AACD;;AAEA,MAAMC,kBAAkB,GAAGV,SAAS,IAAIV,OAAO,CAACU,SAAS,EAAES,kBAAkB,CAAC;;AAE9E;AACA;AACA;AACA;AACA;AACA,MAAME,eAAe,GAAG,CACtB,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,MAAM,EACN,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,OAAO,EACP,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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}